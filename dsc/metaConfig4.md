---
ms.date: 2017-06-12
author: eslesar
ms.topic: conceptual
keywords: "DSC, PowerShell, 構成, セットアップ"
title: "Windows PowerShell 4.0 Desired State Configuration のローカル構成マネージャー (LCM)"
ms.openlocfilehash: 2e6e4731bdf6d7de6d13fc7f9b81698a192247e4
ms.sourcegitcommit: 75f70c7df01eea5e7a2c16f9a3ab1dd437a1f8fd
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/12/2017
---
# <a name="windows-powershell-40-desired-state-configuration-local-configuration-manager-lcm"></a><span data-ttu-id="5100d-103">Windows PowerShell 4.0 Desired State Configuration のローカル構成マネージャー (LCM)</span><span class="sxs-lookup"><span data-stu-id="5100d-103">Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager (LCM)</span></span>

><span data-ttu-id="5100d-104">適用先: Windows PowerShell 4.0、Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="5100d-104">Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0</span></span>

<span data-ttu-id="5100d-105">ローカル構成マネージャーは、Windows PowerShell Desired State Configuration (DSC) エンジンです。</span><span class="sxs-lookup"><span data-stu-id="5100d-105">Local Configuration Manager is the Windows PowerShell Desired State Configuration (DSC) engine.</span></span> <span data-ttu-id="5100d-106">すべてのターゲット ノードで実行され、DSC 構成スクリプトに含まれている構成リソースを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="5100d-106">It runs on all target nodes, and it is responsible for calling the configuration resources that are included in a DSC configuration script.</span></span> <span data-ttu-id="5100d-107">このトピックでは、ローカル構成マネージャーのプロパティを一覧表示し、ターゲット ノードでローカル構成マネージャーの設定を変更する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="5100d-107">This topic lists the properties of Local Configuration Manager and describes how you can modify the Local Configuration Manager settings on a target node.</span></span>

## <a name="local-configuration-manager-properties"></a><span data-ttu-id="5100d-108">ローカル構成マネージャーのプロパティ</span><span class="sxs-lookup"><span data-stu-id="5100d-108">Local Configuration Manager properties</span></span>
<span data-ttu-id="5100d-109">設定または取得できるローカル構成マネージャーのプロパティを次に示します。</span><span class="sxs-lookup"><span data-stu-id="5100d-109">The following lists the Local Configuration Manager properties that you can set or retrieve.</span></span>
 
* <span data-ttu-id="5100d-110">**AllowModuleOverwrite**: 構成サーバーからダウンロードされた新しい構成がターゲット ノードの古い構成を上書きできるかどうかを制御します。</span><span class="sxs-lookup"><span data-stu-id="5100d-110">**AllowModuleOverwrite**: Controls whether new configurations downloaded from the configuration server are allowed to overwrite the old ones on the target node.</span></span> <span data-ttu-id="5100d-111">設定可能な値は True および False です。</span><span class="sxs-lookup"><span data-stu-id="5100d-111">Possible values are True and False.</span></span>
* <span data-ttu-id="5100d-112">**CertificateID**: 構成で渡される資格情報をセキュリティで保護するために使用される証明書の拇印。</span><span class="sxs-lookup"><span data-stu-id="5100d-112">**CertificateID**: The thumbprint of a certificate used to secure credentials passed in a configuration.</span></span> <span data-ttu-id="5100d-113">詳細については、「[Want to secure credentials in Windows PowerShell Desired State Configuration? (Windows PowerShell Desired State Configuration で資格情報をセキュリティ保護する)](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5100d-113">For more information see [Want to secure credentials in Windows PowerShell Desired State Configuration?](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx).</span></span>
* <span data-ttu-id="5100d-114">**ConfigurationID**: "プル" サーバーとしてセットアップされたサーバーから特定の構成ファイルを取得するために使用する GUID を示します。</span><span class="sxs-lookup"><span data-stu-id="5100d-114">**ConfigurationID**: Indicates a GUID which is used to get a particular configuration file from a server set up as a “pull” server.</span></span> <span data-ttu-id="5100d-115">この GUID によって、適切な構成ファイルにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="5100d-115">The GUID ensures that the correct configuration file is accessed.</span></span>
* <span data-ttu-id="5100d-116">**ConfigurationMode**: ローカル構成マネージャーによってターゲット ノードに構成が実際に適用される方法を指定します。</span><span class="sxs-lookup"><span data-stu-id="5100d-116">**ConfigurationMode**: Specifies how the Local Configuration Manager actually applies the configuration to the target nodes.</span></span> <span data-ttu-id="5100d-117">次の値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="5100d-117">It can take the following values:</span></span>
    - <span data-ttu-id="5100d-118">**ApplyOnly**: このオプションを使用すると、DSC によって構成が適用され、その後何も行われません。ただし、ターゲット ノードに直接新しい構成を送信した (プッシュ) 場合や、"プル" サーバーを構成しており、DSC が "プル" サーバーを確認して新しい構成を検出した場合を除きます。</span><span class="sxs-lookup"><span data-stu-id="5100d-118">**ApplyOnly**: With this option, DSC applies the configuration and does nothing further unless a new configuration is detected, either by you sending a new configuration directly to the target node (“push”) or if you have configured a “pull” server and DSC discovers a new configuration when it checks with the “pull” server.</span></span> <span data-ttu-id="5100d-119">ターゲット ノードの構成のずれが発生した場合、アクションは実行されません。</span><span class="sxs-lookup"><span data-stu-id="5100d-119">If the target node’s configuration drifts, no action is taken.</span></span>
    - <span data-ttu-id="5100d-120">**ApplyAndMonitor**: このオプション (既定) を使用すると、新しい構成をターゲット ノードに直接送信した場合でも、"プル" サーバーで検出された場合でも、DSC によって新しい構成が適用されます。</span><span class="sxs-lookup"><span data-stu-id="5100d-120">**ApplyAndMonitor**: With this option (which is the default), DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server.</span></span> <span data-ttu-id="5100d-121">その後、ターゲット ノードの構成が構成ファイルからずれた場合、DSC はログで不一致を報告します。</span><span class="sxs-lookup"><span data-stu-id="5100d-121">Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs.</span></span> <span data-ttu-id="5100d-122">DSC ログの詳細については、「[Using Event Logs to Diagnose Errors in Desired State Configuration (Desired State Configuration でのイベント ログを使用したエラーの診断)](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5100d-122">For more about DSC logging, see [Using Event Logs to Diagnose Errors in Desired State Configuration](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx).</span></span>
    - <span data-ttu-id="5100d-123">**ApplyAndAutoCorrect**: このオプションを使用すると、新しい構成をターゲット ノードに直接送信した場合も、"プル" サーバーで検出された場合も、DSC によって新しい構成が適用されます。</span><span class="sxs-lookup"><span data-stu-id="5100d-123">**ApplyAndAutoCorrect**: With this option, DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server.</span></span> <span data-ttu-id="5100d-124">その後、ターゲット ノードの構成が構成ファイルからずれた場合、DSC はログで不一致を報告し、構成ファイルに準拠するようにターゲット ノードの構成を調整します。</span><span class="sxs-lookup"><span data-stu-id="5100d-124">Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs, and then attempts to adjust the target node configuration to bring in compliance with the configuration file.</span></span>
* <span data-ttu-id="5100d-125">**ConfigurationModeFrequencyMins**: DSC のバックグラウンド アプリケーションがターゲット ノード上の現在の構成の実装を試行する頻度を表します (分単位)。</span><span class="sxs-lookup"><span data-stu-id="5100d-125">**ConfigurationModeFrequencyMins**: Represents the frequency (in minutes) at which the background application of DSC attempts to implement the current configuration on the target node.</span></span> <span data-ttu-id="5100d-126">既定値は 15 です。</span><span class="sxs-lookup"><span data-stu-id="5100d-126">The default value is 15.</span></span> <span data-ttu-id="5100d-127">この値は、RefreshMode と組み合わせて設定することができます。</span><span class="sxs-lookup"><span data-stu-id="5100d-127">This value can be set in conjunction with RefreshMode.</span></span> <span data-ttu-id="5100d-128">RefreshMode を PULL に設定すると、ターゲット ノードは RefreshFrequencyMins の設定間隔で構成サーバーに接続し、現在の構成をダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="5100d-128">When RefreshMode is set to PULL, the target node contacts the configuration server at an interval set by RefreshFrequencyMins and downloads the current configuration.</span></span> <span data-ttu-id="5100d-129">RefreshMode の値に関係なく、ConfigurationModeFrequencyMins の設定間隔で、整合性エンジンは、ターゲット ノードにダウンロードされた最新の構成を適用します。</span><span class="sxs-lookup"><span data-stu-id="5100d-129">Regardless of the RefreshMode value, at the interval set by ConfigurationModeFrequencyMins, the consistency engine applies the latest configuration that was downloaded to the target node.</span></span> <span data-ttu-id="5100d-130">RefreshFrequencyMins は、ConfigurationModeFrequencyMins の倍数である整数に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5100d-130">RefreshFrequencyMins should be set to an integer multiple of ConfigurationModeFrequencyMins.</span></span>
* <span data-ttu-id="5100d-131">**Credential**: 構成サーバーへの接続など、リモート リソースにアクセスするために必要な資格情報を示します (Get-Credential と同様)。</span><span class="sxs-lookup"><span data-stu-id="5100d-131">**Credential**: Indicates credentials (as with Get-Credential) required to access remote resources, such as to contact the configuration server.</span></span>
* <span data-ttu-id="5100d-132">**DownloadManagerCustomData**: ダウンロード マネージャーに固有のカスタム データを格納する配列を表します。</span><span class="sxs-lookup"><span data-stu-id="5100d-132">**DownloadManagerCustomData**: Represents an array that contains custom data specific to the download manager.</span></span>
* <span data-ttu-id="5100d-133">**DownloadManagerName**: 構成とモジュールのダウンロード マネージャーの名前を示します。</span><span class="sxs-lookup"><span data-stu-id="5100d-133">**DownloadManagerName**: Indicates the name of the configuration and module download manager.</span></span>
* <span data-ttu-id="5100d-134">**RebootNodeIfNeeded**: ターゲット ノード上の特定の構成変更では、変更を適用するために再起動する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="5100d-134">**RebootNodeIfNeeded**: Certain configuration changes on a target node might require it to be restarted for the changes to be applied.</span></span> <span data-ttu-id="5100d-135">値 **True** を指定すると、このプロパティは、構成が完全に適用されるとすぐに、追加の警告なく、ノードを再起動します。</span><span class="sxs-lookup"><span data-stu-id="5100d-135">With the value **True**, this property will restart the node as soon as the configuration has been completely applies, without further warning.</span></span> <span data-ttu-id="5100d-136">**False** (既定値) の場合は、構成が完了しても、変更を有効にするために、ノードを手動で再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5100d-136">If **False** (the default value), the configuration will be completed, but the node must be restarted manually for the changes to take effect.</span></span>
* <span data-ttu-id="5100d-137">**RefreshFrequencyMins**: "プル" サーバーをセットアップするときに使用します。</span><span class="sxs-lookup"><span data-stu-id="5100d-137">**RefreshFrequencyMins**: Used when you have set up a “pull” server.</span></span> <span data-ttu-id="5100d-138">ローカル構成マネージャーが "プル" サーバーに接続して現在の構成をダウンロードする頻度 (分) を表します。</span><span class="sxs-lookup"><span data-stu-id="5100d-138">Represents the frequency (in minutes) at which the Local Configuration Manager contacts a “pull” server to download the current configuration.</span></span> <span data-ttu-id="5100d-139">この値は、ConfigurationModeFrequencyMins と組み合わせて設定することができます。</span><span class="sxs-lookup"><span data-stu-id="5100d-139">This value can be set in conjunction with ConfigurationModeFrequencyMins.</span></span> <span data-ttu-id="5100d-140">RefreshMode を PULL に設定すると、ターゲット ノードは RefreshFrequencyMins の設定間隔で "プル" サーバーに接続し、現在の構成をダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="5100d-140">When RefreshMode is set to PULL, the target node contacts the “pull” server at an interval set by RefreshFrequencyMins and downloads the current configuration.</span></span> <span data-ttu-id="5100d-141">その後、ConfigurationModeFrequencyMins の設定間隔で、整合性エンジンがターゲット ノードにダウンロードされた最新の構成を適用します。</span><span class="sxs-lookup"><span data-stu-id="5100d-141">At the interval set by ConfigurationModeFrequencyMins, the consistency engine then applies the latest configuration that was downloaded to the target node.</span></span> <span data-ttu-id="5100d-142">RefreshFrequencyMins が ConfigurationModeFrequencyMins の倍数である整数に設定されていない場合は、システムによって切り上げられます。</span><span class="sxs-lookup"><span data-stu-id="5100d-142">If RefreshFrequencyMins is not set to an integer multiple of ConfigurationModeFrequencyMins, the system will round it up.</span></span> <span data-ttu-id="5100d-143">既定値は 30 です。</span><span class="sxs-lookup"><span data-stu-id="5100d-143">The default value is 30.</span></span>
* <span data-ttu-id="5100d-144">**RefreshMode**: 設定可能な値は **Push** (既定値) と **Pull** です。</span><span class="sxs-lookup"><span data-stu-id="5100d-144">**RefreshMode**: Possible values are **Push** (the default) and **Pull**.</span></span> <span data-ttu-id="5100d-145">"プッシュ" 構成では、任意のクライアント コンピューターを使用して各ターゲット ノードに構成ファイル配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5100d-145">In the “push” configuration, you must place a configuration file on each target node, using any client computer.</span></span> <span data-ttu-id="5100d-146">"プル" モードでは、ローカル構成マネージャーの "プル" サーバーを構成ファイルに接続およびアクセスするようにセットアップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5100d-146">In the “pull” mode, you must set up a “pull” server for Local Configuration Manager to contact and access the configuration files.</span></span>

### <a name="example-of-updating-local-configuration-manager-settings"></a><span data-ttu-id="5100d-147">ローカル構成マネージャー設定の更新の例</span><span class="sxs-lookup"><span data-stu-id="5100d-147">Example of updating Local Configuration Manager settings</span></span>

<span data-ttu-id="5100d-148">次の例に示すように、構成スクリプトのノード ブロックに **LocalConfigurationManager** ブロックを含めることによって、ターゲット ノードのローカル構成マネージャー設定を更新できます。</span><span class="sxs-lookup"><span data-stu-id="5100d-148">You can update the Local Configuration Manager settings of a target node by including a **LocalConfigurationManager** block inside the node block in a configuration script, as shown in the following example.</span></span>

```powershell
Configuration ExampleConfig
{
    Node “Server001”
    {
        LocalConfigurationManager
        {
            ConfigurationID = "646e48cb-3082-4a12-9fd9-f71b9a562d4e"
            ConfigurationModeFrequencyMins = 45
            ConfigurationMode = "ApplyAndAutocorrect"
            RefreshMode = "Pull"
            RefreshFrequencyMins = 90
            DownloadManagerName = "WebDownloadManager"
            DownloadManagerCustomData = (@{ServerUrl="https://$PullServer/psdscpullserver.svc"})
            CertificateID = "71AA68562316FE3F73536F1096B85D66289ED60E"
            Credential = $cred
            RebootNodeIfNeeded = $true
            AllowModuleOverwrite = $false
        }
# One or more resource blocks can be added here
    }
}

# The following line invokes the configuration and creates a file called Server001.meta.mof at the specified path
ExampleConfig -OutputPath "c:\users\public\dsc"  
```

<span data-ttu-id="5100d-149">前の例のスクリプトを実行すると、目的の設定を指定および格納する MOF ファイルが生成されます。</span><span class="sxs-lookup"><span data-stu-id="5100d-149">Running the script in the previous example generates a MOF file that specifies and stores the desired settings.</span></span> <span data-ttu-id="5100d-150">設定を適用するには、次の例に示すように **Set-DscLocalConfigurationManager** コマンドレットを使用します。</span><span class="sxs-lookup"><span data-stu-id="5100d-150">To apply the settings, you can use the **Set-DscLocalConfigurationManager** cmdlet, as shown in the following example.</span></span>

```powershell
Set-DscLocalConfigurationManager -Path "c:\users\public\dsc"
```

> <span data-ttu-id="5100d-151">**注**: **Path** パラメーターには、前の例で構成を呼び出したときに **OutputPath** パラメーターに指定したパスと同じパスを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5100d-151">**Note**: For the **Path** parameter, you must specify the same path that you specified for the **OutputPath** parameter when you invoked the configuration in the previous example.</span></span>

<span data-ttu-id="5100d-152">現在のローカル構成マネージャー設定を表示するには、**Get-DscLocalConfigurationManager** コマンドレットを使用します。</span><span class="sxs-lookup"><span data-stu-id="5100d-152">To see the current Local Configuration Manager settings, you can use the **Get-DscLocalConfigurationManager** cmdlet.</span></span> <span data-ttu-id="5100d-153">パラメーターなしでこのコマンドレットを呼び出す場合、既定では、ローカル構成マネージャーを実行しているノードのローカル構成マネージャー設定が取得されます。</span><span class="sxs-lookup"><span data-stu-id="5100d-153">If you invoke this cmdlet with no parameters, by default it will get the Local Configuration Manager settings for the node on which you run it.</span></span> <span data-ttu-id="5100d-154">別のノードを指定するには、このコマンドレットで **CimSession** パラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="5100d-154">To specify another node, use the **CimSession** parameter with this cmdlet.</span></span>

