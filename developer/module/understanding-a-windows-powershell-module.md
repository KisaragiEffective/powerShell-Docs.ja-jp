---
title: Windows PowerShell モジュールの理解 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d4e38235-9987-4347-afd2-0f7d1dc8f64a
caps.latest.revision: 19
ms.openlocfilehash: 77d328bc1cb8cb42d5a10f107a149c05ab270ce3
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62082109"
---
# <a name="understanding-a-windows-powershell-module"></a><span data-ttu-id="c81b3-102">Windows PowerShell モジュールを理解する</span><span class="sxs-lookup"><span data-stu-id="c81b3-102">Understanding a Windows PowerShell Module</span></span>

<span data-ttu-id="c81b3-103">A*モジュール*(通常、1 つのディレクトリに保存する) の単位としてまとめ、Windows PowerShell の関連機能のセットです。</span><span class="sxs-lookup"><span data-stu-id="c81b3-103">A *module* is a set of related Windows PowerShell functionalities, grouped together as a convenient unit (usually saved in a single directory).</span></span> <span data-ttu-id="c81b3-104">一連の関連するスクリプト ファイル、アセンブリ、および関連リソースを定義すると、モジュールとして、することができますを参照、読み込み、保持、およびそれ以外の場合よりもはるかに簡単にコードを共有します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-104">By defining a set of related script files, assemblies, and related resources as a module, you can reference, load, persist, and share your code much easier than you would otherwise.</span></span>

<span data-ttu-id="c81b3-105">モジュールの主な目的は、Windows PowerShell コードのモジュール化 (つまり、再利用と抽象化) を許可します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-105">The main purpose of a module is to allow the modularization (ie, reuse and abstraction) of Windows PowerShell code.</span></span> <span data-ttu-id="c81b3-106">たとえば、モジュールを作成する最も基本的な方法は、.psm1 ファイルとして Windows PowerShell スクリプトを保存するだけでです。</span><span class="sxs-lookup"><span data-stu-id="c81b3-106">For example, the most basic way of creating a module is to simply save a Windows PowerShell script as a .psm1 file.</span></span> <span data-ttu-id="c81b3-107">実行できるように (つまり、公開またはプライベート) を制御する関数と、スクリプトに含まれる変数。</span><span class="sxs-lookup"><span data-stu-id="c81b3-107">Doing so allows you to control (ie, make public or private) the functions and variables contained in the script.</span></span> <span data-ttu-id="c81b3-108">.Psm1 ファイルとして、スクリプトの保存では特定の変数のスコープを制御することもできます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-108">Saving the script as a .psm1 file also allows you to control the scope of certain variables.</span></span> <span data-ttu-id="c81b3-109">最後に、またコマンドレットを使用できますよう[Install-module](/powershell/module/PowershellGet/Install-Module)を整理、インストール、および大規模なソリューションの構成要素として、スクリプトを使用します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-109">Finally, you can also use cmdlets such as [Install-Module](/powershell/module/PowershellGet/Install-Module) to organize, install, and use your script as building blocks for larger solutions.</span></span>

## <a name="module-components-and-types"></a><span data-ttu-id="c81b3-110">モジュールのコンポーネントと型</span><span class="sxs-lookup"><span data-stu-id="c81b3-110">Module Components and Types</span></span>

<span data-ttu-id="c81b3-111">モジュールは、4 つの基本的なコンポーネントで構成されています。</span><span class="sxs-lookup"><span data-stu-id="c81b3-111">A module is made up of four basic components:</span></span>

1. <span data-ttu-id="c81b3-112">いくつかによって並べ替えるコード ファイルの - 通常は、PowerShell スクリプトまたは管理されたコマンドレットのアセンブリのいずれか。</span><span class="sxs-lookup"><span data-stu-id="c81b3-112">Some sort of code file - usually either a PowerShell script or a managed cmdlet assembly.</span></span>

2. <span data-ttu-id="c81b3-113">上記のコード ファイルがあるあらゆるヘルプが必要ですなどの追加のアセンブリ ファイル、またはスクリプトです。</span><span class="sxs-lookup"><span data-stu-id="c81b3-113">Anything else that the above code file may need, such as additional assemblies, help files, or scripts.</span></span>

3. <span data-ttu-id="c81b3-114">マニフェスト ファイルを作成者やバージョン管理情報などのメタデータを格納するほか、上記のファイルについて説明します.</span><span class="sxs-lookup"><span data-stu-id="c81b3-114">A manifest file that describes the above files, as well as stores metadada such as author and versioning information..</span></span>

4. <span data-ttu-id="c81b3-115">すべての上記のコンテンツを含みが配置されているディレクトリ PowerShell 合理的が検索できる場所です。</span><span class="sxs-lookup"><span data-stu-id="c81b3-115">A directory that contains all of the above content, and is located where PowerShell can reasonably find it.</span></span>

   <span data-ttu-id="c81b3-116">自体には、これらのコンポーネントが実際に必要なことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="c81b3-116">Note that none of these components, by themselves, are actually necessary.</span></span> <span data-ttu-id="c81b3-117">たとえば、モジュールは、.psm1 ファイルに格納されているスクリプトのみを技術的には指定できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-117">For example, a module can technically be only a script stored in a .psm1 file.</span></span> <span data-ttu-id="c81b3-118">モジュールをマニフェスト ファイルは、組織の目的で主に使用されますが、何もすることもできます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-118">You can also have a module that is nothing but a manifest file, which is used mainly for organizational purposes.</span></span> <span data-ttu-id="c81b3-119">モジュールを動的に作成し、そのため実際には必要はありませんすべてのものを格納するディレクトリをスクリプトを記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-119">You can also write a script that dynamically creates a module, and as such doesn't actually need a directory to store anything in.</span></span> <span data-ttu-id="c81b3-120">次のセクションでは、モジュールのさまざまな考えられる部分をまとめて揃えたりして取得できるモジュールの種類について説明します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-120">The following sections describe the types of modules you can get by mixing and matching the different possible parts of a module together.</span></span>

### <a name="script-modules"></a><span data-ttu-id="c81b3-121">スクリプト モジュール</span><span class="sxs-lookup"><span data-stu-id="c81b3-121">Script Modules</span></span>

<span data-ttu-id="c81b3-122">名前が示すとおり、*スクリプト モジュール*は有効な Windows PowerShell コードを含むファイル (.psm1) です。</span><span class="sxs-lookup"><span data-stu-id="c81b3-122">As the name implies, a *script module* is a file (.psm1) that contains any valid Windows PowerShell code.</span></span> <span data-ttu-id="c81b3-123">スクリプトの開発者および管理者は、メンバーを持つ関数や変数などを含むモジュールを作成するのに、この種類のモジュールを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-123">Script developers and administrators can use this type of module to create modules whose members include functions, variables, and more.</span></span> <span data-ttu-id="c81b3-124">スクリプト モジュールとは単に Windows PowerShell スクリプトをさまざまな拡張機能をインポート、エクスポート、および管理関数を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-124">At heart, a script module is simply a Windows PowerShell script with a different extension, which allows administrators to use import, export, and management functions on it.</span></span>

<span data-ttu-id="c81b3-125">さらに、マニフェスト ファイルを使用して、データ ファイル、その他の依存モジュールは、ランタイム スクリプトなど、モジュールにその他のリソースを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-125">In addition, you can use a manifest file to include other resources in your module, such as data files, other dependent modules, or runtime scripts.</span></span> <span data-ttu-id="c81b3-126">マニフェスト ファイルもオーサリングとバージョン管理の情報などのメタデータを追跡するために便利です。</span><span class="sxs-lookup"><span data-stu-id="c81b3-126">Manifest files are also useful for tracking metadata such as authoring and versioning information.</span></span>

<span data-ttu-id="c81b3-127">最後に、動的に作成されていないその他のモジュールと同様に、スクリプト モジュールでは、PowerShell がわかる程度のフォルダーに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c81b3-127">Finally, a script module, like any other module that isn't dynamically created, needs to be saved in a folder that PowerShell can reasonably discover.</span></span> <span data-ttu-id="c81b3-128">通常は PowerShell モジュールのパスで、します。必要に応じて、モジュールがインストールされていることができますに明示的に記述します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-128">Usually, this is on the PowerShell module path; but if necessary you can explicitly describe where your module is installed.</span></span> <span data-ttu-id="c81b3-129">詳細については、次を参照してください。 [PowerShell スクリプト モジュールを記述する方法](./how-to-write-a-powershell-script-module.md)します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-129">For more information, see [How to Write a PowerShell Script Module](./how-to-write-a-powershell-script-module.md).</span></span>

### <a name="binary-modules"></a><span data-ttu-id="c81b3-130">バイナリ モジュール</span><span class="sxs-lookup"><span data-stu-id="c81b3-130">Binary Modules</span></span>

<span data-ttu-id="c81b3-131">A*バイナリ モジュール*などのコンパイル済みのコードを含む .NET Framework アセンブリ (.dll) は、C#します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-131">A *binary module* is a .NET Framework assembly (.dll) that contains compiled code, such as C#.</span></span> <span data-ttu-id="c81b3-132">コマンドレットの開発者は、この種類のモジュールを使用して、コマンドレット、プロバイダー、およびその他の共有します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-132">Cmdlet developers can use this type of module to share cmdlets, providers, and more.</span></span> <span data-ttu-id="c81b3-133">(既存のスナップインこともできますバイナリ モジュールとして。)スクリプト モジュールと比較して、バイナリ モジュールは、高速または機能を使用するコマンドレットを作成するため (など、マルチ スレッド) を Windows PowerShell スクリプトのコードに容易ではありません。</span><span class="sxs-lookup"><span data-stu-id="c81b3-133">(Existing snap-ins can also be used as binary modules.) Compared to a script module, a binary module allows you to create cmdlets that are faster or use features (such as multithreading) that are not as easy to code in Windows PowerShell scripts.</span></span>

<span data-ttu-id="c81b3-134">スクリプトのモジュールとして、モジュールを使用して、その他のリソースを記述して、モジュールに関するメタデータを追跡するために、マニフェスト ファイルを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-134">As with script modules, you can include a manifest file to describe additional resources that your module uses, and to track metadata about your module.</span></span> <span data-ttu-id="c81b3-135">同様に、おそらくにインストールする、バイナリ モジュール PowerShell モジュールのパスに沿ってどこかのフォルダー。</span><span class="sxs-lookup"><span data-stu-id="c81b3-135">Similarly, you probably should install your binary module in a folder somewhere along the PowerShell module path.</span></span> <span data-ttu-id="c81b3-136">詳細については、次を参照してください。 方法[PowerShell バイナリ モジュールを記述する方法](./how-to-write-a-powershell-binary-module.md)します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-136">For more information, see How to [How to Write a PowerShell Binary Module](./how-to-write-a-powershell-binary-module.md).</span></span>

### <a name="manifest-modules"></a><span data-ttu-id="c81b3-137">マニフェスト モジュール</span><span class="sxs-lookup"><span data-stu-id="c81b3-137">Manifest Modules</span></span>

<span data-ttu-id="c81b3-138">A*マニフェスト モジュール*モジュールはすべてのコンポーネントを記述するマニフェスト ファイルを使用していて、あらゆる種類のコア アセンブリまたはスクリプトはありません。</span><span class="sxs-lookup"><span data-stu-id="c81b3-138">A *manifest module* is a module that uses a manifest file to describe all of its components, but doesn't have any sort of core assembly or script.</span></span> <span data-ttu-id="c81b3-139">(正式には、マニフェスト モジュールのまま、`ModuleToProcess`または`RootModule`マニフェストが空の要素)。ただし、モジュールの場合、依存アセンブリを読み込むか、自動的に特定の処理前のスクリプトを実行する機能などの他の機能を引き続き使用できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-139">(Formally, a manifest module leaves the `ModuleToProcess` or `RootModule` element of the manifest empty.) However, you can still use the other features of a module, such as the ability to load up dependent assemblies or automatically run certain pre-processing scripts.</span></span> <span data-ttu-id="c81b3-140">入れ子になったモジュール、アセンブリ、型、または形式など、他のモジュールが使用するリソースをパッケージ化する便利な方法として、マニフェスト モジュールを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-140">You can also use a manifest module as a convenient way to package up resources that other modules will use, such as nested modules, assemblies, types, or formats.</span></span> <span data-ttu-id="c81b3-141">詳細については、次を参照してください。 [PowerShell モジュール マニフェストの記述方法](./how-to-write-a-powershell-module-manifest.md)します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-141">For more information, see [How to Write a PowerShell Module Manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>

### <a name="dynamic-modules"></a><span data-ttu-id="c81b3-142">動的モジュール</span><span class="sxs-lookup"><span data-stu-id="c81b3-142">Dynamic Modules</span></span>

<span data-ttu-id="c81b3-143">A*動的モジュール*がモジュールからアンロードされるか、ファイルに保存します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-143">A *dynamic module* is a module is not loaded from, or saved to, a file.</span></span> <span data-ttu-id="c81b3-144">代わりに、これらが動的に作成、スクリプトを使用して、 [New-module](/powershell/module/Microsoft.PowerShell.Core/New-Module)コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="c81b3-144">Instead, they are created dynamically by a script, using the [New-Module](/powershell/module/Microsoft.PowerShell.Core/New-Module) cmdlet.</span></span> <span data-ttu-id="c81b3-145">モジュールのこの種類は、オンデマンド読み込みまたは永続的ストレージに保存する必要のないモジュールを作成するスクリプトを使用できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-145">This type of module enables a script to create a module on demand that does not need to be loaded or saved to persistent storage.</span></span> <span data-ttu-id="c81b3-146">動的モジュール、その性質上に短期間に設定するためのものし、でアクセスすることはできません、`Get-Module`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="c81b3-146">By its nature, a dynamic module is intended to be short-lived, and therefore cannot be accessed by the `Get-Module` cmdlet.</span></span> <span data-ttu-id="c81b3-147">同様に、通常必要がないモジュールのマニフェスト可能性があります必要も、関連するアセンブリを格納する永続的なフォルダーです。</span><span class="sxs-lookup"><span data-stu-id="c81b3-147">Similarly, they usually do not need module manifests, nor do they likely need permanent folders to store their related assemblies.</span></span>

## <a name="module-manifests"></a><span data-ttu-id="c81b3-148">モジュール マニフェスト</span><span class="sxs-lookup"><span data-stu-id="c81b3-148">Module Manifests</span></span>

<span data-ttu-id="c81b3-149">A*モジュール マニフェスト*はハッシュ テーブルを含む .psd1 ファイルです。</span><span class="sxs-lookup"><span data-stu-id="c81b3-149">A *module manifest* is a .psd1 file that contains a hash table.</span></span> <span data-ttu-id="c81b3-150">キーと値がハッシュ テーブルには、次のことを行います。</span><span class="sxs-lookup"><span data-stu-id="c81b3-150">The keys and values in the hash table do the following things:</span></span>

- <span data-ttu-id="c81b3-151">内容と、モジュールの属性について説明します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-151">Describe the contents and attributes of the module.</span></span>

- <span data-ttu-id="c81b3-152">前提条件を定義します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-152">Define the prerequisites.</span></span>

- <span data-ttu-id="c81b3-153">コンポーネントの処理方法を決定します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-153">Determine how the components are processed.</span></span>

  <span data-ttu-id="c81b3-154">マニフェストは、モジュールに必須ではありません。</span><span class="sxs-lookup"><span data-stu-id="c81b3-154">Manifests are not required for a module.</span></span> <span data-ttu-id="c81b3-155">モジュールは、スクリプト ファイル (.ps1) を参照、スクリプト モジュール ファイル (.psm1)、マニフェスト ファイル (.psd1)、書式設定、およびファイル (.ps1xml)、コマンドレットとプロバイダー アセンブリ (.dll)、リソース ファイル、ヘルプ ファイル、ローカライズされたファイル、または他の種類のファイルまたはリソースを入力します。モジュールの一部としてバンドルされます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-155">Modules can reference script files (.ps1), script module files (.psm1), manifest files (.psd1), formatting and type files (.ps1xml), cmdlet and provider assemblies (.dll), resource files, Help files, localization files, or any other type of file or resource that is bundled as part of the module.</span></span> <span data-ttu-id="c81b3-156">国際化のスクリプトでは、モジュール フォルダーには、一連のメッセージのカタログ ファイルも含まれています。</span><span class="sxs-lookup"><span data-stu-id="c81b3-156">For an internationalized script, the module folder also contains a set of message catalog files.</span></span> <span data-ttu-id="c81b3-157">モジュール フォルダーにマニフェスト ファイルを追加する場合、マニフェストを参照することで 1 つの単位として複数のファイルを参照できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-157">If you add a manifest file to the module folder, you can reference the multiple files as a single unit by referencing the manifest.</span></span>

  <span data-ttu-id="c81b3-158">マニフェスト自体では、次のカテゴリの情報について説明します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-158">The manifest itself describes the following categories of information:</span></span>

- <span data-ttu-id="c81b3-159">モジュールのバージョン番号、作成者、説明など、モジュールに関するメタデータ。</span><span class="sxs-lookup"><span data-stu-id="c81b3-159">Metadata about the module, such as the module version number, the author, and the description.</span></span>

- <span data-ttu-id="c81b3-160">Windows PowerShell のバージョン、共通言語ランタイム (CLR) バージョン、および必要なモジュールなど、モジュールをインポートするために必要な前提条件です。</span><span class="sxs-lookup"><span data-stu-id="c81b3-160">Prerequisites needed to import the module, such as the Windows PowerShell version, the common language runtime (CLR) version, and the required modules.</span></span>

- <span data-ttu-id="c81b3-161">処理ディレクティブ、スクリプト、形式、種類などを処理します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-161">Processing directives, such as the scripts, formats, and types to process.</span></span>

- <span data-ttu-id="c81b3-162">エイリアス、関数、変数、およびエクスポートするコマンドレットなど、エクスポートするモジュールのメンバーに制限します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-162">Restrictions on the members of the module to export, such as the aliases, functions, variables, and cmdlets to export.</span></span>

  <span data-ttu-id="c81b3-163">詳細については、次を参照してください。 [PowerShell モジュール マニフェストの記述方法](./how-to-write-a-powershell-module-manifest.md)します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-163">For more information, see [How to Write a PowerShell Module Manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>

## <a name="storing-and-installing-a-module"></a><span data-ttu-id="c81b3-164">格納して、モジュールのインストール</span><span class="sxs-lookup"><span data-stu-id="c81b3-164">Storing and Installing a Module</span></span>

<span data-ttu-id="c81b3-165">スクリプト、バイナリ、またはマニフェスト モジュールを作成した後は、ある他のユーザー、アクセスすることがあります、場所、作業を保存できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-165">Once you have created a script, binary, or manifest module, you can save your work in a location that others may access it.</span></span> <span data-ttu-id="c81b3-166">たとえば、システム フォルダー、Windows PowerShell がインストールされている場合、またはユーザーのフォルダーに格納されていることができますが、モジュールを格納できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-166">For example, your module can be stored in the system folder where Windows PowerShell is installed, or it can be stored in a user folder.</span></span>

<span data-ttu-id="c81b3-167">格納されているパスの 1 つを使用して、モジュールをインストールする必要がありますを決定する一般に、`$ENV:PSModulePath`変数。</span><span class="sxs-lookup"><span data-stu-id="c81b3-167">Generally speaking, you can determine where you should install your module by using one of the paths stored in the `$ENV:PSModulePath` variable.</span></span> <span data-ttu-id="c81b3-168">これらのパスのいずれかを使用するには、PowerShell の検索し、ユーザーからはコード内でそれへの呼び出しを実行したときに、モジュールを読み込むことが自動的にことを意味します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-168">Using one of these paths means that PowerShell can automatically find and load your module when a user makes a call to it in their code.</span></span> <span data-ttu-id="c81b3-169">モジュールの別の場所に保存する場合は、PowerShell を呼び出すときに、モジュールの場所をパラメーターとして渡すことで知るを明示的にさせることができます`Install-Module`します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-169">If you store your module somewhere else, you can explicitly let PowerShell know by passing in the location of your module as a parameter when you call `Install-Module`.</span></span>

<span data-ttu-id="c81b3-170">関係なく、フォルダーのパスと呼びます、*基本*(ModuleBase) モジュールとスクリプトの名前、バイナリ、またはマニフェスト モジュールのファイルは、次の例外で、モジュールのフォルダー名と同じことがあります。</span><span class="sxs-lookup"><span data-stu-id="c81b3-170">Regardless, the path of the folder is referred to as the *base* of the module (ModuleBase), and the name of the script, binary, or manifest module file should be the same as the module folder name, with the following exceptions:</span></span>

- <span data-ttu-id="c81b3-171">によって作成される動的モジュール、`New-Module`コマンドレットの名前を使用して、`Name`コマンドレットのパラメーター。</span><span class="sxs-lookup"><span data-stu-id="c81b3-171">Dynamic modules that are created by the `New-Module` cmdlet can be named using the `Name` parameter of the cmdlet.</span></span>

- <span data-ttu-id="c81b3-172">ごとのオブジェクトのアセンブリからインポートしたモジュール、  **`Import-Module` -アセンブリ**コマンドは、次の構文に従って命名されます:`"dynamic_code_module_" + assembly.GetName()`します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-172">Modules imported from assembly objects by the **`Import-Module` -Assembly** command are named according to the following syntax: `"dynamic_code_module_" + assembly.GetName()`.</span></span>

  <span data-ttu-id="c81b3-173">詳細については、次を参照してください。 [PowerShell モジュールのインストール](./installing-a-powershell-module.md)と[PSModulePath インストール パスを変更する](./modifying-the-psmodulepath-installation-path.md)します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-173">For more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md) and [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span>

## <a name="module-cmdlets-and-variables"></a><span data-ttu-id="c81b3-174">モジュールのコマンドレットと変数</span><span class="sxs-lookup"><span data-stu-id="c81b3-174">Module Cmdlets and Variables</span></span>

<span data-ttu-id="c81b3-175">作成および管理モジュールのため、次のコマンドレットと変数は、Windows PowerShell によって提供されます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-175">The following cmdlets and variables are provided by Windows PowerShell for the creation and management of modules.</span></span>

<span data-ttu-id="c81b3-176">[新しいモジュール](/powershell/module/Microsoft.PowerShell.Core/New-Module)コマンドレットこのコマンドレットで、メモリ内にのみ存在する新しい動的モジュールが作成します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-176">[New-Module](/powershell/module/Microsoft.PowerShell.Core/New-Module) cmdlet This cmdlet creates a new dynamic module that exists only in memory.</span></span> <span data-ttu-id="c81b3-177">モジュールは、スクリプト ブロックから作成され、その関数や変数など、そのエクスポートされたメンバーは、セッションですぐに使用し、セッションが閉じられるまで使用できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-177">The module is created from a script block, and its exported members, such as its functions and variables, are immediately available in the session and remain available until the session is closed.</span></span>

<span data-ttu-id="c81b3-178">[新しい ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest)コマンドレットこのコマンドレットは、新しいモジュール マニフェスト (.psd1) ファイルを作成、その値を入力し、指定したパスにマニフェスト ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-178">[New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet This cmdlet creates a new module manifest (.psd1) file, populates its values, and saves the manifest file to the specified path.</span></span> <span data-ttu-id="c81b3-179">このコマンドレットで手動で入力できるモジュールのマニフェスト テンプレートの作成にも使用できます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-179">This cmdlet can also be used to create a module manifest template that can be filled in manually.</span></span>

<span data-ttu-id="c81b3-180">[Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレットこのコマンドレットは、現在のセッションに 1 つまたは複数のモジュールを追加します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-180">[Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet This cmdlet adds one or more modules to the current session.</span></span>

<span data-ttu-id="c81b3-181">[Get-module](/powershell/module/Microsoft.PowerShell.Core/Get-Module)このコマンドレットのコマンドレットはされているか、現在のセッションにインポート可能なモジュールに関する情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-181">[Get-Module](/powershell/module/Microsoft.PowerShell.Core/Get-Module) cmdlet This cmdlet retrieves information about the modules that have been or that can be imported into the current session.</span></span>

<span data-ttu-id="c81b3-182">[Export-modulemember](/powershell/module/Microsoft.PowerShell.Core/Export-ModuleMember)このコマンドレットのコマンドレットは、スクリプト モジュール (.psm1) ファイルからまたはを使用して作成された動的モジュールからエクスポートされるモジュール メンバー (コマンドレット、関数、変数、エイリアスなど) を指定します、`New-Module`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="c81b3-182">[Export-ModuleMember](/powershell/module/Microsoft.PowerShell.Core/Export-ModuleMember) cmdlet This cmdlet specifies the module members (such as cmdlets, functions, variables, and aliases) that are exported from a script module (.psm1) file or from a dynamic module created by using the `New-Module` cmdlet.</span></span>

<span data-ttu-id="c81b3-183">[Remove-module](/powershell/module/Microsoft.PowerShell.Core/Remove-Module)コマンドレットこのコマンドレットは、現在のセッションからモジュールを削除します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-183">[Remove-Module](/powershell/module/Microsoft.PowerShell.Core/Remove-Module) cmdlet This cmdlet removes modules from the current session.</span></span>

<span data-ttu-id="c81b3-184">[Test-modulemanifest](/powershell/module/Microsoft.PowerShell.Core/Test-ModuleManifest)コマンドレットをこのコマンドレットは、モジュール マニフェストが、モジュール マニフェスト ファイル (.psd1) に記載されているファイルが実際に指定されたパスに存在するかを確認して、モジュールのコンポーネントを正確に記述することを確認します。</span><span class="sxs-lookup"><span data-stu-id="c81b3-184">[Test-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/Test-ModuleManifest) cmdlet This cmdlet verifies that a module manifest accurately describes the components of a module by verifying that the files that are listed in the module manifest file (.psd1) actually exist in the specified paths.</span></span>

<span data-ttu-id="c81b3-185">$PSScriptRoot にはこの変数には、スクリプト モジュールが実行されている元のディレクトリが含まれています。</span><span class="sxs-lookup"><span data-stu-id="c81b3-185">$PSScriptRoot This variable contains the directory from which the script module is being executed.</span></span> <span data-ttu-id="c81b3-186">スクリプトのモジュールのパスを使用して、その他のリソースにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-186">It enables scripts to use the module path to access other resources.</span></span>

<span data-ttu-id="c81b3-187">$env:path: この環境変数には psmodulepath 環境変数にはどの Windows PowerShell モジュールが格納されているディレクトリの一覧が含まれます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-187">$env:PSModulePath This environment variable contains a list of the directories in which Windows PowerShell modules are stored.</span></span> <span data-ttu-id="c81b3-188">Windows PowerShell には、自動的にモジュールをインポートおよびモジュールのヘルプ トピックを更新するときに、この変数の値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="c81b3-188">Windows PowerShell uses the value of this variable when importing modules automatically and updating Help topics for modules.</span></span>

## <a name="see-also"></a><span data-ttu-id="c81b3-189">参照</span><span class="sxs-lookup"><span data-stu-id="c81b3-189">See Also</span></span>

[<span data-ttu-id="c81b3-190">Windows PowerShell モジュールの記述</span><span class="sxs-lookup"><span data-stu-id="c81b3-190">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
