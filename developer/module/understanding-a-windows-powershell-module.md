---
title: Windows PowerShell モジュールの理解 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d4e38235-9987-4347-afd2-0f7d1dc8f64a
caps.latest.revision: 19
ms.openlocfilehash: 77d328bc1cb8cb42d5a10f107a149c05ab270ce3
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62082109"
---
# <a name="understanding-a-windows-powershell-module"></a>Windows PowerShell モジュールを理解する

A*モジュール*(通常、1 つのディレクトリに保存する) の単位としてまとめ、Windows PowerShell の関連機能のセットです。 一連の関連するスクリプト ファイル、アセンブリ、および関連リソースを定義すると、モジュールとして、することができますを参照、読み込み、保持、およびそれ以外の場合よりもはるかに簡単にコードを共有します。

モジュールの主な目的は、Windows PowerShell コードのモジュール化 (つまり、再利用と抽象化) を許可します。 たとえば、モジュールを作成する最も基本的な方法は、.psm1 ファイルとして Windows PowerShell スクリプトを保存するだけでです。 実行できるように (つまり、公開またはプライベート) を制御する関数と、スクリプトに含まれる変数。 .Psm1 ファイルとして、スクリプトの保存では特定の変数のスコープを制御することもできます。 最後に、またコマンドレットを使用できますよう[Install-module](/powershell/module/PowershellGet/Install-Module)を整理、インストール、および大規模なソリューションの構成要素として、スクリプトを使用します。

## <a name="module-components-and-types"></a>モジュールのコンポーネントと型

モジュールは、4 つの基本的なコンポーネントで構成されています。

1. いくつかによって並べ替えるコード ファイルの - 通常は、PowerShell スクリプトまたは管理されたコマンドレットのアセンブリのいずれか。

2. 上記のコード ファイルがあるあらゆるヘルプが必要ですなどの追加のアセンブリ ファイル、またはスクリプトです。

3. マニフェスト ファイルを作成者やバージョン管理情報などのメタデータを格納するほか、上記のファイルについて説明します.

4. すべての上記のコンテンツを含みが配置されているディレクトリ PowerShell 合理的が検索できる場所です。

   自体には、これらのコンポーネントが実際に必要なことに注意してください。 たとえば、モジュールは、.psm1 ファイルに格納されているスクリプトのみを技術的には指定できます。 モジュールをマニフェスト ファイルは、組織の目的で主に使用されますが、何もすることもできます。 モジュールを動的に作成し、そのため実際には必要はありませんすべてのものを格納するディレクトリをスクリプトを記述することもできます。 次のセクションでは、モジュールのさまざまな考えられる部分をまとめて揃えたりして取得できるモジュールの種類について説明します。

### <a name="script-modules"></a>スクリプト モジュール

名前が示すとおり、*スクリプト モジュール*は有効な Windows PowerShell コードを含むファイル (.psm1) です。 スクリプトの開発者および管理者は、メンバーを持つ関数や変数などを含むモジュールを作成するのに、この種類のモジュールを使用することができます。 スクリプト モジュールとは単に Windows PowerShell スクリプトをさまざまな拡張機能をインポート、エクスポート、および管理関数を使用することもできます。

さらに、マニフェスト ファイルを使用して、データ ファイル、その他の依存モジュールは、ランタイム スクリプトなど、モジュールにその他のリソースを含めることができます。 マニフェスト ファイルもオーサリングとバージョン管理の情報などのメタデータを追跡するために便利です。

最後に、動的に作成されていないその他のモジュールと同様に、スクリプト モジュールでは、PowerShell がわかる程度のフォルダーに保存する必要があります。 通常は PowerShell モジュールのパスで、します。必要に応じて、モジュールがインストールされていることができますに明示的に記述します。 詳細については、次を参照してください。 [PowerShell スクリプト モジュールを記述する方法](./how-to-write-a-powershell-script-module.md)します。

### <a name="binary-modules"></a>バイナリ モジュール

A*バイナリ モジュール*などのコンパイル済みのコードを含む .NET Framework アセンブリ (.dll) は、C#します。 コマンドレットの開発者は、この種類のモジュールを使用して、コマンドレット、プロバイダー、およびその他の共有します。 (既存のスナップインこともできますバイナリ モジュールとして。)スクリプト モジュールと比較して、バイナリ モジュールは、高速または機能を使用するコマンドレットを作成するため (など、マルチ スレッド) を Windows PowerShell スクリプトのコードに容易ではありません。

スクリプトのモジュールとして、モジュールを使用して、その他のリソースを記述して、モジュールに関するメタデータを追跡するために、マニフェスト ファイルを含めることができます。 同様に、おそらくにインストールする、バイナリ モジュール PowerShell モジュールのパスに沿ってどこかのフォルダー。 詳細については、次を参照してください。 方法[PowerShell バイナリ モジュールを記述する方法](./how-to-write-a-powershell-binary-module.md)します。

### <a name="manifest-modules"></a>マニフェスト モジュール

A*マニフェスト モジュール*モジュールはすべてのコンポーネントを記述するマニフェスト ファイルを使用していて、あらゆる種類のコア アセンブリまたはスクリプトはありません。 (正式には、マニフェスト モジュールのまま、`ModuleToProcess`または`RootModule`マニフェストが空の要素)。ただし、モジュールの場合、依存アセンブリを読み込むか、自動的に特定の処理前のスクリプトを実行する機能などの他の機能を引き続き使用できます。 入れ子になったモジュール、アセンブリ、型、または形式など、他のモジュールが使用するリソースをパッケージ化する便利な方法として、マニフェスト モジュールを使用することもできます。 詳細については、次を参照してください。 [PowerShell モジュール マニフェストの記述方法](./how-to-write-a-powershell-module-manifest.md)します。

### <a name="dynamic-modules"></a>動的モジュール

A*動的モジュール*がモジュールからアンロードされるか、ファイルに保存します。 代わりに、これらが動的に作成、スクリプトを使用して、 [New-module](/powershell/module/Microsoft.PowerShell.Core/New-Module)コマンドレット。 モジュールのこの種類は、オンデマンド読み込みまたは永続的ストレージに保存する必要のないモジュールを作成するスクリプトを使用できます。 動的モジュール、その性質上に短期間に設定するためのものし、でアクセスすることはできません、`Get-Module`コマンドレット。 同様に、通常必要がないモジュールのマニフェスト可能性があります必要も、関連するアセンブリを格納する永続的なフォルダーです。

## <a name="module-manifests"></a>モジュール マニフェスト

A*モジュール マニフェスト*はハッシュ テーブルを含む .psd1 ファイルです。 キーと値がハッシュ テーブルには、次のことを行います。

- 内容と、モジュールの属性について説明します。

- 前提条件を定義します。

- コンポーネントの処理方法を決定します。

  マニフェストは、モジュールに必須ではありません。 モジュールは、スクリプト ファイル (.ps1) を参照、スクリプト モジュール ファイル (.psm1)、マニフェスト ファイル (.psd1)、書式設定、およびファイル (.ps1xml)、コマンドレットとプロバイダー アセンブリ (.dll)、リソース ファイル、ヘルプ ファイル、ローカライズされたファイル、または他の種類のファイルまたはリソースを入力します。モジュールの一部としてバンドルされます。 国際化のスクリプトでは、モジュール フォルダーには、一連のメッセージのカタログ ファイルも含まれています。 モジュール フォルダーにマニフェスト ファイルを追加する場合、マニフェストを参照することで 1 つの単位として複数のファイルを参照できます。

  マニフェスト自体では、次のカテゴリの情報について説明します。

- モジュールのバージョン番号、作成者、説明など、モジュールに関するメタデータ。

- Windows PowerShell のバージョン、共通言語ランタイム (CLR) バージョン、および必要なモジュールなど、モジュールをインポートするために必要な前提条件です。

- 処理ディレクティブ、スクリプト、形式、種類などを処理します。

- エイリアス、関数、変数、およびエクスポートするコマンドレットなど、エクスポートするモジュールのメンバーに制限します。

  詳細については、次を参照してください。 [PowerShell モジュール マニフェストの記述方法](./how-to-write-a-powershell-module-manifest.md)します。

## <a name="storing-and-installing-a-module"></a>格納して、モジュールのインストール

スクリプト、バイナリ、またはマニフェスト モジュールを作成した後は、ある他のユーザー、アクセスすることがあります、場所、作業を保存できます。 たとえば、システム フォルダー、Windows PowerShell がインストールされている場合、またはユーザーのフォルダーに格納されていることができますが、モジュールを格納できます。

格納されているパスの 1 つを使用して、モジュールをインストールする必要がありますを決定する一般に、`$ENV:PSModulePath`変数。 これらのパスのいずれかを使用するには、PowerShell の検索し、ユーザーからはコード内でそれへの呼び出しを実行したときに、モジュールを読み込むことが自動的にことを意味します。 モジュールの別の場所に保存する場合は、PowerShell を呼び出すときに、モジュールの場所をパラメーターとして渡すことで知るを明示的にさせることができます`Install-Module`します。

関係なく、フォルダーのパスと呼びます、*基本*(ModuleBase) モジュールとスクリプトの名前、バイナリ、またはマニフェスト モジュールのファイルは、次の例外で、モジュールのフォルダー名と同じことがあります。

- によって作成される動的モジュール、`New-Module`コマンドレットの名前を使用して、`Name`コマンドレットのパラメーター。

- ごとのオブジェクトのアセンブリからインポートしたモジュール、  **`Import-Module` -アセンブリ**コマンドは、次の構文に従って命名されます:`"dynamic_code_module_" + assembly.GetName()`します。

  詳細については、次を参照してください。 [PowerShell モジュールのインストール](./installing-a-powershell-module.md)と[PSModulePath インストール パスを変更する](./modifying-the-psmodulepath-installation-path.md)します。

## <a name="module-cmdlets-and-variables"></a>モジュールのコマンドレットと変数

作成および管理モジュールのため、次のコマンドレットと変数は、Windows PowerShell によって提供されます。

[新しいモジュール](/powershell/module/Microsoft.PowerShell.Core/New-Module)コマンドレットこのコマンドレットで、メモリ内にのみ存在する新しい動的モジュールが作成します。 モジュールは、スクリプト ブロックから作成され、その関数や変数など、そのエクスポートされたメンバーは、セッションですぐに使用し、セッションが閉じられるまで使用できます。

[新しい ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest)コマンドレットこのコマンドレットは、新しいモジュール マニフェスト (.psd1) ファイルを作成、その値を入力し、指定したパスにマニフェスト ファイルを保存します。 このコマンドレットで手動で入力できるモジュールのマニフェスト テンプレートの作成にも使用できます。

[Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレットこのコマンドレットは、現在のセッションに 1 つまたは複数のモジュールを追加します。

[Get-module](/powershell/module/Microsoft.PowerShell.Core/Get-Module)このコマンドレットのコマンドレットはされているか、現在のセッションにインポート可能なモジュールに関する情報を取得します。

[Export-modulemember](/powershell/module/Microsoft.PowerShell.Core/Export-ModuleMember)このコマンドレットのコマンドレットは、スクリプト モジュール (.psm1) ファイルからまたはを使用して作成された動的モジュールからエクスポートされるモジュール メンバー (コマンドレット、関数、変数、エイリアスなど) を指定します、`New-Module`コマンドレット。

[Remove-module](/powershell/module/Microsoft.PowerShell.Core/Remove-Module)コマンドレットこのコマンドレットは、現在のセッションからモジュールを削除します。

[Test-modulemanifest](/powershell/module/Microsoft.PowerShell.Core/Test-ModuleManifest)コマンドレットをこのコマンドレットは、モジュール マニフェストが、モジュール マニフェスト ファイル (.psd1) に記載されているファイルが実際に指定されたパスに存在するかを確認して、モジュールのコンポーネントを正確に記述することを確認します。

$PSScriptRoot にはこの変数には、スクリプト モジュールが実行されている元のディレクトリが含まれています。 スクリプトのモジュールのパスを使用して、その他のリソースにアクセスできます。

$env:path: この環境変数には psmodulepath 環境変数にはどの Windows PowerShell モジュールが格納されているディレクトリの一覧が含まれます。 Windows PowerShell には、自動的にモジュールをインポートおよびモジュールのヘルプ トピックを更新するときに、この変数の値が使用されます。

## <a name="see-also"></a>参照

[Windows PowerShell モジュールの記述](./writing-a-windows-powershell-module.md)
