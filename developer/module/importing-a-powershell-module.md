---
title: PowerShell モジュールをインポートする |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/03/2019
ms.locfileid: "56854058"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="4f554-102">PowerShell モジュールをインポートする</span><span class="sxs-lookup"><span data-stu-id="4f554-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="4f554-103">1 回、モジュールがインストールされているシステムでは、するモジュールをインポートするする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4f554-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="4f554-104">インポートでは、ユーザーは、PowerShell セッションでそのモジュールにアクセスできるように、モジュールをアクティブ メモリに読み込まれるプロセスです。</span><span class="sxs-lookup"><span data-stu-id="4f554-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="4f554-105">PowerShell 2.0 への呼び出しでは、新しくインストールした PowerShell モジュールをインポートすることができます[Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="4f554-106">PowerShell 3.0 では、PowerShell は暗黙的に関数またはモジュールのコマンドレットのいずれかがユーザーによって呼び出されると、モジュールをインポートすることです。</span><span class="sxs-lookup"><span data-stu-id="4f554-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="4f554-107">両方のバージョンが PowerShell がそれを検索することがある場所で、モジュールをインストールすることを想定して ことに注意してください。詳細については、次を参照してください。 [PowerShell モジュールのインストール](./installing-a-powershell-module.md)します。</span><span class="sxs-lookup"><span data-stu-id="4f554-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="4f554-108">モジュール マニフェストを使用するには、モジュールのどの部分をエクスポートすると、制限してのパラメーターを使用して、`Import-Module`呼び出し箇所は、インポートを制限します。</span><span class="sxs-lookup"><span data-stu-id="4f554-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="4f554-109">スナップイン (PowerShell 1.0) をインポートします。</span><span class="sxs-lookup"><span data-stu-id="4f554-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="4f554-110">モジュールが PowerShell 1.0 ではありませんでした。 代わりに、登録、スナップインを使用する必要がありました。ただし、これは使用しないでこの時点では、このテクノロジを使用するモジュールは、通常のインストールおよびインポートする方が簡単に。</span><span class="sxs-lookup"><span data-stu-id="4f554-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="4f554-111">詳細については、次を参照してください。 [、Windows PowerShell スナップインを作成する方法](../cmdlet/how-to-create-a-windows-powershell-snap-in.md)します。</span><span class="sxs-lookup"><span data-stu-id="4f554-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="4f554-112">モジュールのインポート (PowerShell 2.0) を持つモジュールをインポートします。</span><span class="sxs-lookup"><span data-stu-id="4f554-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="4f554-113">PowerShell 2.0 では、適切に名前付き[Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレット モジュールをインポートします。</span><span class="sxs-lookup"><span data-stu-id="4f554-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="4f554-114">このコマンドレットを実行しているときに Windows PowerShell がで指定したディレクトリ内の指定したモジュールの検索、`PSModulePath`変数。</span><span class="sxs-lookup"><span data-stu-id="4f554-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="4f554-115">Windows PowerShell が次の順序でファイルを検索し、指定されたディレクトリが見つかった場合: モジュールのマニフェスト ファイル (.psd1)、スクリプト モジュール ファイル (.psm1)、バイナリ モジュール ファイル (.dll)。</span><span class="sxs-lookup"><span data-stu-id="4f554-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="4f554-116">検索するディレクトリを追加する方法の詳細については、次を参照してください。 [PSModulePath インストール パスを変更する](./modifying-the-psmodulepath-installation-path.md)します。</span><span class="sxs-lookup"><span data-stu-id="4f554-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="4f554-117">次のコードでは、モジュールをインポートする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="4f554-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="4f554-118">MyModule に存在していたことと仮定すると、 `PSModulePath`PowerShell を使用して、myModule をアクティブなメモリに読み込むとします。</span><span class="sxs-lookup"><span data-stu-id="4f554-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="4f554-119">MyModule が上に存在しない場合、`PSModulePath`パスも明示的に指示するには PowerShell がどこに。</span><span class="sxs-lookup"><span data-stu-id="4f554-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="4f554-120">使用することも、モジュールからエクスポートされる内容と、アクティブなメモリにインポートされる内容を識別するためには、verbose パラメーター。</span><span class="sxs-lookup"><span data-stu-id="4f554-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="4f554-121">エクスポートとインポートの両方を制限するユーザーに公開される情報: 違いは、可視性を制御します。</span><span class="sxs-lookup"><span data-stu-id="4f554-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="4f554-122">基本的には、エクスポートは、モジュール内のコードによって制御されます。</span><span class="sxs-lookup"><span data-stu-id="4f554-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="4f554-123">これに対し、インポートは、によって制御されます、`Import-Module`呼び出します。</span><span class="sxs-lookup"><span data-stu-id="4f554-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="4f554-124">詳細については、次を参照してください。**を制限するメンバーがインポートされたこと**、後述します。</span><span class="sxs-lookup"><span data-stu-id="4f554-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="4f554-125">モジュール (PowerShell 3.0) を暗黙的にインポートします。</span><span class="sxs-lookup"><span data-stu-id="4f554-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="4f554-126">Windows PowerShell 3.0 以降では、モジュールは自動的にインポート コマンドレットまたは関数、モジュールでは、コマンドで使用される場合。</span><span class="sxs-lookup"><span data-stu-id="4f554-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="4f554-127">この機能は、値に含まれるディレクトリのモジュールに対して、 **PSModulePath**環境変数。</span><span class="sxs-lookup"><span data-stu-id="4f554-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="4f554-128">保存しないモジュールの有効なパスでただし場合、読み込むことができます、明示的なを使用して[Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)上記で説明したオプション。</span><span class="sxs-lookup"><span data-stu-id="4f554-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="4f554-129">次のアクションのトリガーとも呼ばれます「モジュールの自動読み込みします」、モジュールの自動インポート</span><span class="sxs-lookup"><span data-stu-id="4f554-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="4f554-130">コマンドでは、コマンドレットを使用します。</span><span class="sxs-lookup"><span data-stu-id="4f554-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="4f554-131">たとえば、入力`Get-ExecutionPolicy`を含む Microsoft.PowerShell.Security モジュールをインポート、`Get-ExecutionPolicy`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="4f554-132">使用して、 [Get-command](/powershell/module/Microsoft.PowerShell.Core/Get-Command)コマンドを取得するコマンドレットです。</span><span class="sxs-lookup"><span data-stu-id="4f554-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="4f554-133">たとえば、入力`Get-Command Get-JobTrigger`インポート、 **PSScheduledJob**モジュールを含む、`Get-JobTrigger`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="4f554-134">A`Get-Command`ワイルドカード文字を含むコマンドの検出と見なされます、モジュールのインポートはトリガーされません。</span><span class="sxs-lookup"><span data-stu-id="4f554-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="4f554-135">使用して、 [Get-help](/powershell/module/Microsoft.PowerShell.Core/Get-Help)コマンドレットのヘルプを取得するコマンドレットです。</span><span class="sxs-lookup"><span data-stu-id="4f554-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="4f554-136">たとえば、入力`Get-Help Get-WinEvent`を含む Microsoft.PowerShell.Diagnostics モジュールをインポート、`Get-WinEvent`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="4f554-137">モジュールの自動インポートをサポートするために、`Get-Command`モジュールは、セッションにインポートされていない場合でもすべてのコマンドレットと、インストールされているすべてのモジュールで関数をコマンドレットが取得されます。</span><span class="sxs-lookup"><span data-stu-id="4f554-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="4f554-138">詳細については、のヘルプ トピックを参照してください、 [Get-command](/powershell/module/Microsoft.PowerShell.Core/Get-Command)コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="4f554-139">インポート プロセス</span><span class="sxs-lookup"><span data-stu-id="4f554-139">The Importing Process</span></span>

<span data-ttu-id="4f554-140">モジュールの新しいセッション状態が作成されたモジュールがインポートされるときに、 [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo)メモリ内オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="4f554-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="4f554-141">セッション状態がインポートされている各モジュールの作成 (ルート モジュールと入れ子になったモジュールを含む)。</span><span class="sxs-lookup"><span data-stu-id="4f554-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="4f554-142">任意の入れ子になったモジュールによって、ルート モジュールにエクスポートされたすべてのメンバーを含む、ルート モジュールからエクスポートされるメンバーは、呼び出し元のセッション状態にインポートされます。</span><span class="sxs-lookup"><span data-stu-id="4f554-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="4f554-143">モジュールからエクスポートされたメンバーのメタデータでは、ModuleName プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="4f554-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="4f554-144">このプロパティには、それらをエクスポートするモジュールの名が設定されます。</span><span class="sxs-lookup"><span data-stu-id="4f554-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="4f554-145">場合は、エクスポートされたメンバーの名前は、承認されていない動詞を使用して、または警告が表示されているメンバーの名前は文字の制限を使用する場合と、 [Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレットを実行します。</span><span class="sxs-lookup"><span data-stu-id="4f554-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="4f554-146">既定で、 [Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレットは、パイプラインにオブジェクトを返しません。</span><span class="sxs-lookup"><span data-stu-id="4f554-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="4f554-147">ただし、このコマンドレットをサポートしています、`PassThru`を返すために使用するパラメーター、 [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo)にインポートされている各モジュールのオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="4f554-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="4f554-148">ホストに出力を送信するユーザーを実行する必要があります、 [Write-host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host)コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="4f554-149">インポートされたメンバーを制限します。</span><span class="sxs-lookup"><span data-stu-id="4f554-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="4f554-150">使用してモジュールをインポートするときに、 [Import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module)コマンドレット、既定メンバーが、セッションにインポートされたすべてのエクスポート時のモジュールで任意のコマンドを含むエクスポート、入れ子になったモジュールがモジュールにします。</span><span class="sxs-lookup"><span data-stu-id="4f554-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="4f554-151">既定では、変数およびエイリアスはエクスポートされません。</span><span class="sxs-lookup"><span data-stu-id="4f554-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="4f554-152">エクスポートされるメンバーを制限するには、[モジュール マニフェスト](./how-to-write-a-powershell-module-manifest.md)します。</span><span class="sxs-lookup"><span data-stu-id="4f554-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="4f554-153">インポートされているメンバーを制限するには、次のパラメーターを使用して、`Import-Module`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="4f554-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="4f554-154">`Function`:このパラメーターは、エクスポートされる関数を制限します。</span><span class="sxs-lookup"><span data-stu-id="4f554-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="4f554-155">(モジュール マニフェストを使用している場合は、参照 FunctionsToExport キー)。</span><span class="sxs-lookup"><span data-stu-id="4f554-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="4f554-156">`Cmdlet`:このパラメーターに制限されます (使用する場合、モジュール マニフェストを参照してください、CmdletsToExport キー。) にエクスポートされるコマンドレット</span><span class="sxs-lookup"><span data-stu-id="4f554-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="4f554-157">`Variable`:このパラメーターに制限されます (使用する場合、モジュール マニフェストを参照してください、VariablesToExport キー。) にエクスポートされる変数</span><span class="sxs-lookup"><span data-stu-id="4f554-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="4f554-158">`Alias`:このパラメーター (使用する場合、モジュール マニフェストを参照してください、AliasesToExport キー。) にエクスポートされるエイリアスを制限します。</span><span class="sxs-lookup"><span data-stu-id="4f554-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="4f554-159">参照</span><span class="sxs-lookup"><span data-stu-id="4f554-159">See Also</span></span>

[<span data-ttu-id="4f554-160">Windows PowerShell モジュールの記述</span><span class="sxs-lookup"><span data-stu-id="4f554-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
