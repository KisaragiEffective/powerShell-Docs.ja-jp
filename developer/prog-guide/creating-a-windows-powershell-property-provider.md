---
title: Windows PowerShell プロパティ プロバイダーを作成する |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.assetid: a6adca44-b94b-4103-9970-a9b414355e60
caps.latest.revision: 5
ms.openlocfilehash: ade8fbd38e4f4a675e825b0d8850af0379c9d211
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/03/2019
ms.locfileid: "56858898"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="e4578-102">Windows PowerShell プロパティ プロバイダーを作成する</span><span class="sxs-lookup"><span data-stu-id="e4578-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="e4578-103">このトピックでは、データ ストア内のアイテムのプロパティを操作するユーザーを有効にするプロバイダーを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="e4578-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="e4578-104">その結果、この種類のプロバイダーは、Windows PowerShell プロパティ プロバイダーとしてに呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="e4578-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="e4578-105">たとえば、レジストリ プロバイダー レジストリ キーの項目のプロパティとして Windows PowerShell ハンドル レジストリ キーの値によって提供されます。</span><span class="sxs-lookup"><span data-stu-id="e4578-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="e4578-106">この種類のプロバイダーを追加する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) .NET クラスの実装へのインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="e4578-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="e4578-107">Windows PowerShell では、Windows PowerShell プロバイダーの開発に使用できるテンプレート ファイルを提供します。</span><span class="sxs-lookup"><span data-stu-id="e4578-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="e4578-108">TemplateProvider.cs ファイルでは、Microsoft Windows ソフトウェア開発キットの Windows Vista と .NET Framework 3.0 ランタイム コンポーネントで使用できます。</span><span class="sxs-lookup"><span data-stu-id="e4578-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="e4578-109">ダウンロードの手順については、次を参照してください。 [Windows PowerShell のインストールと、Windows PowerShell SDK をダウンロードする方法](/powershell/developer/installing-the-windows-powershell-sdk)します。</span><span class="sxs-lookup"><span data-stu-id="e4578-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="e4578-110">Windows PowerShell では、Windows PowerShell プロバイダーの開発に使用できるテンプレート ファイルを提供します。</span><span class="sxs-lookup"><span data-stu-id="e4578-110">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="e4578-111">TemplateProvider.cs ファイルでは、Microsoft Windows ソフトウェア開発キットの Windows Vista と .NET Framework 3.0 ランタイム コンポーネントで使用できます。</span><span class="sxs-lookup"><span data-stu-id="e4578-111">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="e4578-112">ダウンロードの手順については、次を参照してください。 [Windows PowerShell のインストールと、Windows PowerShell SDK をダウンロードする方法](/powershell/developer/installing-the-windows-powershell-sdk)します。</span><span class="sxs-lookup"><span data-stu-id="e4578-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="e4578-113">ダウンロードしたテンプレートが表示されます、  **\<PowerShell のサンプル >** ディレクトリ。</span><span class="sxs-lookup"><span data-stu-id="e4578-113">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="e4578-114">このファイルのコピーを作成して、必要のないすべての機能を削除する、新しい Windows PowerShell プロバイダーを作成するため、コピーを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4578-114">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span>
>
> <span data-ttu-id="e4578-115">その他の Windows PowerShell プロバイダーの実装の詳細については、次を参照してください。 [Your Windows PowerShell プロバイダーの設計](./designing-your-windows-powershell-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="e4578-115">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="e4578-116">プロパティ プロバイダーのメソッドを使用して任意のオブジェクトを書き込む必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject)メソッド。</span><span class="sxs-lookup"><span data-stu-id="e4578-116">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

<span data-ttu-id="e4578-117">次の一覧には、このトピックのセクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="e4578-117">The following list contains the sections in this topic.</span></span> <span data-ttu-id="e4578-118">Windows PowerShell プロパティ プロバイダーの記述に慣れていない場合は、出現する順序では、この情報を読み込みます。</span><span class="sxs-lookup"><span data-stu-id="e4578-118">If you are unfamiliar with writing a Windows PowerShell property provider, read this information in the order that it appears.</span></span> <span data-ttu-id="e4578-119">ただし、Windows PowerShell プロパティ プロバイダーの作成に習熟する場合は、直接」に進んでください必要な情報。</span><span class="sxs-lookup"><span data-stu-id="e4578-119">However, if you are familiar with writing a Windows PowerShell property provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="e4578-120">Windows PowerShell プロバイダーを定義します。</span><span class="sxs-lookup"><span data-stu-id="e4578-120">Defining the Windows PowerShell Provider</span></span>](#Defining-the-Windows-PowerShell-provider)

- [<span data-ttu-id="e4578-121">基本機能を定義します。</span><span class="sxs-lookup"><span data-stu-id="e4578-121">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="e4578-122">プロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="e4578-122">Retrieving Properties</span></span>](#Retrieving-Properties)

- [<span data-ttu-id="e4578-123">動的パラメーターをアタッチ、`Get-ItemProperty`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="e4578-123">Attaching Dynamic Parameters to the `Get-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ItemProperty-Cmdlet)

- [<span data-ttu-id="e4578-124">プロパティの設定</span><span class="sxs-lookup"><span data-stu-id="e4578-124">Setting Properties</span></span>](#Setting-Properties)

- [<span data-ttu-id="e4578-125">動的パラメーターをアタッチ、`Set-ItemProperty`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="e4578-125">Attaching Dynamic Parameters to the `Set-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-for-the-Set-ItemProperty-Cmdlet)

- [<span data-ttu-id="e4578-126">プロパティをクリアします。</span><span class="sxs-lookup"><span data-stu-id="e4578-126">Clearing a Property</span></span>](#Clearing-Properties)

- [<span data-ttu-id="e4578-127">動的パラメーターをアタッチ、`Clear-ItemProperty`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="e4578-127">Attaching Dynamic Parameters to the `Clear-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Clear-ItemProperty-Cmdlet)

- [<span data-ttu-id="e4578-128">Windows PowerShell プロバイダーのビルド</span><span class="sxs-lookup"><span data-stu-id="e4578-128">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="e4578-129">Windows PowerShell プロバイダーを定義します。</span><span class="sxs-lookup"><span data-stu-id="e4578-129">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="e4578-130">プロパティ プロバイダーがサポートする .NET クラスを作成する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="e4578-130">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="e4578-131">Windows PowerShell によって提供される TemplateProvider.cs ファイルから既定のクラス宣言を次に示します。</span><span class="sxs-lookup"><span data-stu-id="e4578-131">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="e4578-132">基本機能を定義します。</span><span class="sxs-lookup"><span data-stu-id="e4578-132">Defining Base Functionality</span></span>

<span data-ttu-id="e4578-133">[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)インターフェイスは、例外としてプロバイダーの基本クラスのいずれかに接続する、 [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)クラス。</span><span class="sxs-lookup"><span data-stu-id="e4578-133">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="e4578-134">使用する基本クラスで必要な基本機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="e4578-134">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="e4578-135">基底クラスの詳細については、次を参照してください。 [Your Windows PowerShell プロバイダーの設計](./designing-your-windows-powershell-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="e4578-135">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="e4578-136">プロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="e4578-136">Retrieving Properties</span></span>

<span data-ttu-id="e4578-137">プロパティを取得するには、プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)メソッドからの呼び出しをサポートするために、`Get-ItemProperty`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="e4578-137">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="e4578-138">このメソッドは、(完全修飾)、指定したプロバイダーの内部パスにある項目のプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="e4578-138">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="e4578-139">`providerSpecificPickList`パラメーターを取得するプロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="e4578-139">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="e4578-140">このパラメーターが場合`null`または空の場合、メソッドはすべてのプロパティを取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4578-140">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="e4578-141">さらに、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)のインスタンスを書き込み、 [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject)を表すオブジェクトを取得したプロパティのプロパティ バッグ。</span><span class="sxs-lookup"><span data-stu-id="e4578-141">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="e4578-142">メソッドは、何も返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4578-142">The method should return nothing.</span></span>

<span data-ttu-id="e4578-143">お勧めの実装[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)選択リスト内の各要素のプロパティ名のワイルドカードの展開をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="e4578-143">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="e4578-144">これを行うには、使用、 [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern)ワイルドカードによるパターン照合を実行するクラス。</span><span class="sxs-lookup"><span data-stu-id="e4578-144">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="e4578-145">既定の実装を次に示します[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) TemplateProvider.cs ファイルを Windows PowerShell によって提供されるからです。</span><span class="sxs-lookup"><span data-stu-id="e4578-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="e4578-146">GetProperty の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="e4578-146">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="e4578-147">実装に、次の条件が適用[System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span><span class="sxs-lookup"><span data-stu-id="e4578-147">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="e4578-148">Windows PowerShell プロパティ プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="e4578-148">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="e4578-149">これらのケースの実装で、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="e4578-149">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="e4578-150">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="e4578-150">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="e4578-151">既定では、このメソッドのオーバーライドを取得しないようにしない限り、ユーザーが非表示オブジェクト用のリーダー、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティに設定されて`true`します。</span><span class="sxs-lookup"><span data-stu-id="e4578-151">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="e4578-152">パスが、ユーザーが非表示の項目を表すかどうかエラーを記述する必要がありますと[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)に設定されている`false`します。</span><span class="sxs-lookup"><span data-stu-id="e4578-152">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="e4578-153">Get-itemproperty コマンドレットへの動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="e4578-153">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="e4578-154">`Get-ItemProperty`コマンドレットは、実行時に動的に指定されている追加のパラメーターを必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4578-154">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="e4578-155">これらの動的パラメーターを提供する Windows PowerShell プロパティ プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="e4578-155">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="e4578-156">`path`パラメーターは、完全修飾プロバイダー-内部のパスを示します。 中に、`providerSpecificPickList`パラメーターをコマンドラインで入力したプロバイダー固有のプロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="e4578-156">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="e4578-157">このパラメーターがあります`null`または空の場合は、プロパティをコマンドレットにパイプします。</span><span class="sxs-lookup"><span data-stu-id="e4578-157">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="e4578-158">この場合、このメソッドは、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="e4578-158">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="e4578-159">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターをコマンドレットに追加します。</span><span class="sxs-lookup"><span data-stu-id="e4578-159">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="e4578-160">既定の実装を次に示します[System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) TemplateProvider.cs ファイルを Windows PowerShell によって提供されるからです。</span><span class="sxs-lookup"><span data-stu-id="e4578-160">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="e4578-161">設定のプロパティ</span><span class="sxs-lookup"><span data-stu-id="e4578-161">Setting Properties</span></span>

<span data-ttu-id="e4578-162">プロパティを設定する、Windows PowerShell プロパティ プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)メソッドからの呼び出しをサポートするために、`Set-ItemProperty`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="e4578-162">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="e4578-163">このメソッドは、指定したパスにある項目の 1 つまたは複数のプロパティを設定し、必要に応じて指定されたプロパティを上書きします。</span><span class="sxs-lookup"><span data-stu-id="e4578-163">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span> <span data-ttu-id="e4578-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)も書き込みますのインスタンスを[System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) 、更新のプロパティ バッグを表すオブジェクトを。プロパティ。</span><span class="sxs-lookup"><span data-stu-id="e4578-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="e4578-165">既定の実装を次に示します[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) TemplateProvider.cs ファイルを Windows PowerShell によって提供されるからです。</span><span class="sxs-lookup"><span data-stu-id="e4578-165">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="e4578-166">Set-itemproperty の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="e4578-166">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="e4578-167">実装を次の条件が適用[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span><span class="sxs-lookup"><span data-stu-id="e4578-167">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="e4578-168">Windows PowerShell プロパティ プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="e4578-168">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="e4578-169">これらのケースの実装で、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)メソッドがメソッドに渡されたパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="e4578-169">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="e4578-170">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="e4578-170">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="e4578-171">既定では、このメソッドのオーバーライドを取得しないようにしない限り、ユーザーが非表示オブジェクト用のリーダー、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティに設定されて`true`します。</span><span class="sxs-lookup"><span data-stu-id="e4578-171">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="e4578-172">パスが、ユーザーが非表示の項目を表すかどうかエラーを記述する必要がありますと[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)に設定されている`false`します。</span><span class="sxs-lookup"><span data-stu-id="e4578-172">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="e4578-173">実装、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)メソッドを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)をデータ ストアに変更を加える前に、その戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="e4578-173">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="e4578-174">このメソッドは、変更が行われるとシステムの状態にたとえば、ファイルの名前を変更する操作の実行の確認に使用されます。</span><span class="sxs-lookup"><span data-stu-id="e4578-174">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="e4578-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) Windows PowerShell ランタイムと任意のコマンドライン設定やユーザー設定変数での処理で、ユーザーに変更するリソースの名前を送信します。何を表示するかを決定します。</span><span class="sxs-lookup"><span data-stu-id="e4578-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="e4578-176">呼び出し後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)返します`true`危険性のあるシステムの変更ができる場合、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty)メソッドを呼び出す必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)メソッド。</span><span class="sxs-lookup"><span data-stu-id="e4578-176">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="e4578-177">このメソッドは、操作を続行することを示す追加のフィードバックを許可するユーザーに確認メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="e4578-177">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="e4578-178">Set-itemproperty コマンドレットの動的パラメーターをアタッチします。</span><span class="sxs-lookup"><span data-stu-id="e4578-178">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="e4578-179">`Set-ItemProperty`コマンドレットは、実行時に動的に指定されている追加のパラメーターを必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4578-179">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="e4578-180">これらの動的パラメーターを提供する Windows PowerShell プロパティ プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="e4578-180">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="e4578-181">このメソッドは、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="e4578-181">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="e4578-182">`null`を追加する動的パラメーターがない場合、値が返されることができます。</span><span class="sxs-lookup"><span data-stu-id="e4578-182">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="e4578-183">既定の実装を次に示します[System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) TemplateProvider.cs ファイルを Windows PowerShell によって提供されるからです。</span><span class="sxs-lookup"><span data-stu-id="e4578-183">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="e4578-184">プロパティをクリアします。</span><span class="sxs-lookup"><span data-stu-id="e4578-184">Clearing Properties</span></span>

<span data-ttu-id="e4578-185">プロパティをクリアする Windows PowerShell プロパティ プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)メソッドからの呼び出しをサポートするために、`Clear-ItemProperty`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="e4578-185">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="e4578-186">このメソッドは、指定されたパスにある項目の 1 つまたは複数のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="e4578-186">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="e4578-187">既定の実装を次に示します[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) TemplateProvider.cs ファイルを Windows PowerShell によって提供されるからです。</span><span class="sxs-lookup"><span data-stu-id="e4578-187">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="e4578-188">ClearProperty の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="e4578-188">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="e4578-189">実装に、次の条件が適用[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span><span class="sxs-lookup"><span data-stu-id="e4578-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="e4578-190">Windows PowerShell プロパティ プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="e4578-190">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="e4578-191">これらのケースの実装で、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="e4578-191">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="e4578-192">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="e4578-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="e4578-193">既定では、このメソッドのオーバーライドを取得しないようにしない限り、ユーザーが非表示オブジェクト用のリーダー、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティに設定されて`true`します。</span><span class="sxs-lookup"><span data-stu-id="e4578-193">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="e4578-194">パスが、ユーザーが非表示の項目を表すかどうかエラーを記述する必要がありますと[System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)に設定されている`false`します。</span><span class="sxs-lookup"><span data-stu-id="e4578-194">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="e4578-195">実装、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)メソッドを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)をデータ ストアに変更を加える前に、その戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="e4578-195">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="e4578-196">このメソッドは、コンテンツをクリアするなどのシステム状態の変更前に、操作の実行の確認に使用されます。</span><span class="sxs-lookup"><span data-stu-id="e4578-196">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span> <span data-ttu-id="e4578-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)コマンドライン設定や ユーザー設定変数を考慮して、Windows PowerShell ランタイムで、ユーザーに変更するリソースの名前を送信します。何を表示するかを決定します。</span><span class="sxs-lookup"><span data-stu-id="e4578-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="e4578-198">呼び出し後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)返します`true`危険性のあるシステムの変更ができる場合、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty)メソッドを呼び出す必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)メソッド。</span><span class="sxs-lookup"><span data-stu-id="e4578-198">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="e4578-199">このメソッドは、危険性のある操作を続行することを示す追加のフィードバックを許可するユーザーに確認メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="e4578-199">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="e4578-200">Clear-itemproperty コマンドレットへの動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="e4578-200">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="e4578-201">`Clear-ItemProperty`コマンドレットは、実行時に動的に指定されている追加のパラメーターを必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4578-201">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="e4578-202">これらの動的パラメーターを提供する Windows PowerShell プロパティ プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="e4578-202">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="e4578-203">このメソッドは、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="e4578-203">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="e4578-204">`null`を追加する動的パラメーターがない場合、値が返されることができます。</span><span class="sxs-lookup"><span data-stu-id="e4578-204">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="e4578-205">既定の実装を次に示します[System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) TemplateProvider.cs ファイルを Windows PowerShell によって提供されるからです。</span><span class="sxs-lookup"><span data-stu-id="e4578-205">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="e4578-206">Windows PowerShell プロバイダーの構築</span><span class="sxs-lookup"><span data-stu-id="e4578-206">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="e4578-207">参照してください[登録コマンドレット、プロバイダー、およびアプリケーションをホストする方法](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)します。</span><span class="sxs-lookup"><span data-stu-id="e4578-207">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="e4578-208">参照してください[登録コマンドレット、プロバイダー、およびアプリケーションをホストする方法](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)します。</span><span class="sxs-lookup"><span data-stu-id="e4578-208">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="e4578-209">参照</span><span class="sxs-lookup"><span data-stu-id="e4578-209">See Also</span></span>

[<span data-ttu-id="e4578-210">Windows PowerShell プロバイダー</span><span class="sxs-lookup"><span data-stu-id="e4578-210">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="e4578-211">デザイン、Windows PowerShell プロバイダー</span><span class="sxs-lookup"><span data-stu-id="e4578-211">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="e4578-212">オブジェクトの種類を拡張して、書式設定</span><span class="sxs-lookup"><span data-stu-id="e4578-212">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="e4578-213">オブジェクトの種類を拡張して、書式設定</span><span class="sxs-lookup"><span data-stu-id="e4578-213">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="e4578-214">登録のコマンドレット、プロバイダー、およびアプリケーションをホストする方法</span><span class="sxs-lookup"><span data-stu-id="e4578-214">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="e4578-215">登録のコマンドレット、プロバイダー、およびアプリケーションをホストする方法</span><span class="sxs-lookup"><span data-stu-id="e4578-215">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)