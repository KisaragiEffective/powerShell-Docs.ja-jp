---
title: Windows PowerShell コンテナー プロバイダーを作成する |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: e0d83a742eae2bcde2e691860a5f2b3e5862d2de
ms.sourcegitcommit: 69abc5ad16e5dd29ddfb1853e266a4bfd1d59d59
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/05/2019
ms.locfileid: "57430039"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="aadc8-102">Windows PowerShell コンテナー プロバイダーを作成する</span><span class="sxs-lookup"><span data-stu-id="aadc8-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="aadc8-103">このトピックでは、複数レイヤーのデータ ストアで動作する Windows PowerShell プロバイダーを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="aadc8-104">この種類のデータ ストアでのストアの最上位レベルには、ルート項目が含まれています。 と後続の各レベルは子項目のノードと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="aadc8-105">これらの子ノードで作業するユーザーを許可すると、ユーザーから操作できる階層的に、データ ストア。</span><span class="sxs-lookup"><span data-stu-id="aadc8-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="aadc8-106">複数レベルのデータ ストアで動作するプロバイダーは、Windows PowerShell コンテナー プロバイダーと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="aadc8-107">ただし、内の項目を含む 1 つのコンテナー (入れ子になったコンテナーがありません) がある場合にのみ、Windows PowerShell コンテナー プロバイダーを使用できることもあります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="aadc8-108">入れ子になったコンテナーがある場合は、Windows PowerShell ナビゲーション プロバイダーを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="aadc8-109">Windows PowerShell ナビゲーション プロバイダーの実装の詳細については、次を参照してください。 [Windows PowerShell ナビゲーション プロバイダーを作成する](./creating-a-windows-powershell-navigation-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="aadc8-110">ダウンロードすることができます、 C# Microsoft Windows ソフトウェア開発キットの Windows Vista と .NET Framework 3.0 ランタイム コンポーネントを使用して、このプロバイダーのソース ファイル (AccessDBSampleProvider04.cs)。</span><span class="sxs-lookup"><span data-stu-id="aadc8-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="aadc8-111">ダウンロードの手順については、次を参照してください。 [Windows PowerShell のインストールと、Windows PowerShell SDK をダウンロードする方法](/powershell/developer/installing-the-windows-powershell-sdk)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="aadc8-112">ダウンロードしたソース ファイルは、  **\<PowerShell のサンプル >** ディレクトリ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="aadc8-113">その他の Windows PowerShell プロバイダーの実装の詳細については、次を参照してください。 [Your Windows PowerShell プロバイダーの設計](./designing-your-windows-powershell-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="aadc8-114">ここで説明する Windows PowerShell コンテナー プロバイダーでは、テーブルと、コンテナーの項目として定義されているデータベースの行の 1 つのコンテナーとして、データベースを定義します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="aadc8-115">注意この設計が、名前の ID を持つフィールドを持つデータベースを想定していると、フィールドの型がなければなりません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="aadc8-116">このトピックのセクションの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-116">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="aadc8-117">Windows PowerShell コンテナー プロバイダーの記述に慣れていない場合は、出現する順序では、この情報をお読みください。</span><span class="sxs-lookup"><span data-stu-id="aadc8-117">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="aadc8-118">ただし、Windows PowerShell コンテナー プロバイダーの作成に習熟する場合は、直接」に進んでください必要な情報。</span><span class="sxs-lookup"><span data-stu-id="aadc8-118">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="aadc8-119">Windows PowerShell コンテナー プロバイダー クラスを定義します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-119">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="aadc8-120">基本機能を定義します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-120">Defining Base Functionality</span></span>]()

- [<span data-ttu-id="aadc8-121">子項目を取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-121">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="aadc8-122">動的パラメーターをアタッチ、`Get-ChildItem`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="aadc8-122">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="aadc8-123">子項目の名前を取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-123">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="aadc8-124">[動的パラメーターをアタッチ、`Get-ChildItem`コマンドレット (名)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="aadc8-124">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="aadc8-125">項目の名前を変更します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-125">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="aadc8-126">動的パラメーターをアタッチ、`Rename-Item`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="aadc8-126">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="aadc8-127">新しい項目の作成</span><span class="sxs-lookup"><span data-stu-id="aadc8-127">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="aadc8-128">動的パラメーターをアタッチ、`New-Item`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="aadc8-128">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="aadc8-129">項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-129">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="aadc8-130">動的パラメーターをアタッチ、`Remove-Item`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="aadc8-130">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="aadc8-131">子項目のクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-131">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="aadc8-132">コピー項目</span><span class="sxs-lookup"><span data-stu-id="aadc8-132">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="aadc8-133">動的パラメーターをアタッチ、`Copy-Item`コマンドレット</span><span class="sxs-lookup"><span data-stu-id="aadc8-133">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="aadc8-134">コード サンプル</span><span class="sxs-lookup"><span data-stu-id="aadc8-134">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="aadc8-135">オブジェクトの種類を定義して、書式設定</span><span class="sxs-lookup"><span data-stu-id="aadc8-135">Defining Object Types and Formatting</span></span>]()

- [<span data-ttu-id="aadc8-136">Windows PowerShell プロバイダーのビルド</span><span class="sxs-lookup"><span data-stu-id="aadc8-136">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="aadc8-137">Windows PowerShell プロバイダーのテスト</span><span class="sxs-lookup"><span data-stu-id="aadc8-137">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="aadc8-138">Windows PowerShell コンテナー プロバイダー クラスを定義します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-138">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="aadc8-139">Windows PowerShell コンテナー プロバイダーがから派生する .NET クラスを定義する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)基本クラス。</span><span class="sxs-lookup"><span data-stu-id="aadc8-139">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="aadc8-140">このセクションで説明されている Windows PowerShell コンテナー プロバイダーのクラス定義を次に示します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-140">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="aadc8-141">このクラスの定義に注意してください、 [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute)属性には、2 つのパラメーターが含まれています。</span><span class="sxs-lookup"><span data-stu-id="aadc8-141">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="aadc8-142">最初のパラメーターには、Windows PowerShell で使用されるプロバイダーのわかりやすい名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-142">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="aadc8-143">2 番目のパラメーターには、プロバイダーがコマンドの処理中に、Windows PowerShell ランタイムに公開する Windows PowerShell の特定機能を指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-143">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="aadc8-144">このプロバイダーに追加される Windows PowerShell の特定の機能はありません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-144">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="aadc8-145">基本機能を定義します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-145">Defining Base Functionality</span></span>

<span data-ttu-id="aadc8-146">」の説明に従って[Your Windows PowerShell プロバイダーの設計](./designing-your-windows-powershell-provider.md)、 [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)クラスが提供されるその他のいくつかのクラスから派生別のプロバイダー機能。</span><span class="sxs-lookup"><span data-stu-id="aadc8-146">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="aadc8-147">そのため、Windows PowerShell コンテナー プロバイダーは、これらのクラスによって提供される機能のすべてを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-147">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="aadc8-148">セッション固有の初期化情報を追加して、プロバイダーによって使用されているリソースを解放するための機能を実装するを参照してください。[基本的な Windows PowerShell プロバイダーを作成する](./creating-a-basic-windows-powershell-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-148">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="aadc8-149">ただし、ほとんどのプロバイダー (ここで説明されているプロバイダーを含む) は、この Windows PowerShell によって提供される機能の既定の実装を使用できます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-149">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="aadc8-150">データ ストアへのアクセスを取得するには、プロバイダーがのメソッドを実装する必要があります、 [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)基本クラス。</span><span class="sxs-lookup"><span data-stu-id="aadc8-150">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="aadc8-151">これらのメソッドの実装の詳細については、次を参照してください。 [Windows PowerShell ドライブ プロバイダーの作成](./creating-a-windows-powershell-drive-provider.md)です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-151">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="aadc8-152">プロバイダーの取得、設定、および消去の項目などのデータ ストアの項目を操作するによって提供されるメソッドを実装する必要があります、 [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)基本クラス。</span><span class="sxs-lookup"><span data-stu-id="aadc8-152">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="aadc8-153">これらのメソッドの実装の詳細については、次を参照してください。 [Windows PowerShell 項目プロバイダーを作成する](./creating-a-windows-powershell-item-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-153">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="aadc8-154">子項目を取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-154">Retrieving Child Items</span></span>

<span data-ttu-id="aadc8-155">子項目を取得する、Windows PowerShell コンテナー プロバイダーがオーバーライドする必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドからの呼び出しをサポートするために、`Get-ChildItem`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-155">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="aadc8-156">このメソッドは、子項目をデータ ストアから取得し、それらをパイプラインにオブジェクトとして書き込みます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-156">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="aadc8-157">場合、`recurse`コマンドレットのパラメーターを指定すると、メソッドにはどのようなレベルに関係なくすべての子を取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-157">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="aadc8-158">場合、`recurse`パラメーターが指定されていない、メソッドは、子の 1 つのレベルのみを取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-158">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="aadc8-159">実装をここでは、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)このプロバイダーのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-159">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="aadc8-160">パスが、Access データベースに示しパスには、データ テーブルが示されている場合、そのテーブルの行から子項目を取得ときに、このメソッドがすべてのデータベース テーブル内の子項目を取得することを確認します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-160">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="aadc8-161">GetChildItems の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-161">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="aadc8-162">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="aadc8-162">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="aadc8-163">Windows PowerShell コンテナー プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="aadc8-163">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="aadc8-164">これらのケースの実装で、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="aadc8-164">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="aadc8-165">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-165">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="aadc8-166">このメソッドの実装する必要があります考慮に入れて任意の形式のアクセスをユーザーに表示される項目を使用する項目にします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-166">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="aadc8-167">たとえば、ユーザーが (Windows PowerShell によって提供される)、FileSystem プロバイダーが読み取りアクセスは含まれません経由でファイルを書き込みアクセス権を持っている場合、ファイルが存在し、 [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists)返します`true`します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-167">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="aadc8-168">実装では、子を列挙できるかどうかに表示する親項目のチェックを必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-168">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="aadc8-169">複数の項目を作成するとき、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドは時間がかかることができます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-169">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="aadc8-170">使用して項目を作成するには、プロバイダーを設計することができます、 [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)一度に 1 つのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-170">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="aadc8-171">この手法を使用すると、ストリーム内のユーザーに項目が表示されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-171">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="aadc8-172">実装[System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)循環リンクは、およびなどがある場合は、無限再帰を回避するため責任を負います。</span><span class="sxs-lookup"><span data-stu-id="aadc8-172">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="aadc8-173">そうした状態を反映するように適切な終了例外をスローする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-173">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="aadc8-174">Get-childitem コマンドレットに動的パラメーターを追加</span><span class="sxs-lookup"><span data-stu-id="aadc8-174">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="aadc8-175">場合によって、`Get-ChildItem`コマンドレットを呼び出す[System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)実行時に動的に指定されている追加のパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-175">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="aadc8-176">これらの動的パラメーターを提供する、Windows PowerShell コンテナー プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-176">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="aadc8-177">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="aadc8-177">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="aadc8-178">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターを追加、`Get-ChildItem`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-178">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="aadc8-179">この Windows PowerShell コンテナー プロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-179">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="aadc8-180">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-180">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="aadc8-181">子項目の名前を取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-181">Retrieving Child Item Names</span></span>

<span data-ttu-id="aadc8-182">子項目の名前を取得する、Windows PowerShell コンテナー プロバイダーがオーバーライドする必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) からの呼び出しをサポートするためにメソッド`Get-ChildItem`コマンドレットとその`Name`パラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-182">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="aadc8-183">場合、このメソッドは指定されたパスまたは子項目の名前をすべてのコンテナーの子項目の名前を取得、`returnAllContainers`コマンドレットのパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-183">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="aadc8-184">子の名前は、パスのリーフ部分です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-184">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="aadc8-185">たとえば、パス c:\windows\system32\abc.dll の子の名前は「月」は。</span><span class="sxs-lookup"><span data-stu-id="aadc8-185">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="aadc8-186">ディレクトリ c:\windows\system32 の子の名前は、"system32"です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-186">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="aadc8-187">実装をここでは、 [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames)このプロバイダーのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-187">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="aadc8-188">パスが、テーブルを示している場合を示します、Access データベース (ドライブ) と行番号の指定したパスの場合、メソッドはテーブル名を取得します。 注意してください。</span><span class="sxs-lookup"><span data-stu-id="aadc8-188">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="aadc8-189">GetChildNames の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-189">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="aadc8-190">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="aadc8-190">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="aadc8-191">Windows PowerShell コンテナー プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="aadc8-191">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="aadc8-192">これらのケースの実装で、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="aadc8-192">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="aadc8-193">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-193">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="aadc8-194">このルールの例外が発生したときに、`returnAllContainers`コマンドレットのパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-194">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="aadc8-195">ここでは、メソッドする必要がありますを取得、コンテナーの子の名前は任意の値に一致しない場合でも、 [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter)、 [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)、または[System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-195">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="aadc8-196">既定では、このメソッドのオーバーライドを取得しないが一般的に、ユーザーから非表示しない限り、オブジェクトの名前、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-196">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="aadc8-197">指定されたパスには、コンテナーが示されている場合、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-197">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="aadc8-198">実装[System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames)循環リンクは、およびなどがある場合は、無限再帰を回避するため責任を負います。</span><span class="sxs-lookup"><span data-stu-id="aadc8-198">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="aadc8-199">そうした状態を反映するように適切な終了例外をスローする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-199">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="aadc8-200">Get-childitem コマンドレット (名) に動的パラメーターを追加</span><span class="sxs-lookup"><span data-stu-id="aadc8-200">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="aadc8-201">場合によって、`Get-ChildItem`コマンドレット (で、`Name`パラメーター) 実行時に動的に指定されている追加のパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-201">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="aadc8-202">これらの動的パラメーターを提供する、Windows PowerShell コンテナー プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-202">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="aadc8-203">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="aadc8-203">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="aadc8-204">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターを追加、`Get-ChildItem`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-204">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="aadc8-205">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-205">This provider does not implement this method.</span></span> <span data-ttu-id="aadc8-206">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-206">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="aadc8-207">項目の名前を変更します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-207">Renaming Items</span></span>

<span data-ttu-id="aadc8-208">項目の名前を変更する Windows PowerShell コンテナー プロバイダーがオーバーライドする必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem)メソッドからの呼び出しをサポートするために、`Rename-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-208">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="aadc8-209">このメソッドは、指定された新しい名前を指定したパスにある項目の名前を変更します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-209">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="aadc8-210">親項目 (コンテナー) に対して相対的に新しい名前が常にあります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-210">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="aadc8-211">このプロバイダーをオーバーライドしない、 [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-211">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="aadc8-212">ただし、既定の実装は、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-212">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="aadc8-213">RenameItem の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-213">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="aadc8-214">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="aadc8-214">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="aadc8-215">Windows PowerShell コンテナー プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="aadc8-215">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="aadc8-216">これらのケースの実装で、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="aadc8-216">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="aadc8-217">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-217">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="aadc8-218">[System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem)だけ、項目の名前を変更して、移動操作ではなく、メソッドが対象としています。</span><span class="sxs-lookup"><span data-stu-id="aadc8-218">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="aadc8-219">場合、メソッドの実装でエラーを書き込む必要があります、`newName`パラメーターは、パスの区切り記号が含まれていますか、それ以外の場合、親の位置を変更する項目が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-219">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="aadc8-220">既定では、このメソッドのオーバーライドする必要がありますいないオブジェクト名を変更しない限り、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-220">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="aadc8-221">指定されたパスには、コンテナーが示されている場合、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-221">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="aadc8-222">実装、 [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem)メソッドを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)データ ストアに変更を加える前に、戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-222">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="aadc8-223">このメソッドは、変更が行われるとシステムの状態にたとえば、ファイルの名前を変更する操作の実行の確認に使用されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-223">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="aadc8-224">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)コマンドライン設定や ユーザー設定変数を考慮して、Windows PowerShell ランタイムで、ユーザーに変更するリソースの名前を送信します。何を表示するかを決定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-224">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="aadc8-225">呼び出し後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)返します`true`、 [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem)メソッドを呼び出す必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-225">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="aadc8-226">このメソッドは、かどうかは、操作を続行したいその他のフィードバックを許可するユーザーに確認メッセージのメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-226">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="aadc8-227">プロバイダーを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)危険性のあるシステムの変更、追加のチェックとして。</span><span class="sxs-lookup"><span data-stu-id="aadc8-227">A provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="aadc8-228">Rename-item コマンドレットへの動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="aadc8-228">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="aadc8-229">場合によって、`Rename-Item`コマンドレットが実行時に動的に指定されている追加のパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-229">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="aadc8-230">これらの動的パラメーターを提供する Windows PowerShell コンテナー プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-230">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="aadc8-231">このメソッドは、指定されたパスにある項目のパラメーターを取得し、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="aadc8-231">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="aadc8-232">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターを追加、`Rename-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-232">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="aadc8-233">このコンテナーのプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-233">This container provider does not implement this method.</span></span> <span data-ttu-id="aadc8-234">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-234">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="aadc8-235">新しい項目の作成</span><span class="sxs-lookup"><span data-stu-id="aadc8-235">Creating New Items</span></span>

<span data-ttu-id="aadc8-236">新しい項目を作成するコンテナー プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)メソッドからの呼び出しをサポートするために、`New-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-236">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="aadc8-237">このメソッドは、指定されたパスにあるデータ項目を作成します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-237">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="aadc8-238">`type`コマンドレットのパラメーターに新しい項目のプロバイダーによって定義された型が含まれています。</span><span class="sxs-lookup"><span data-stu-id="aadc8-238">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="aadc8-239">たとえば、FileSystem プロバイダーを使用して、`type`パラメーター値は"file"または"directory"です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-239">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="aadc8-240">`newItemValue`コマンドレットのパラメーターを新しい項目のプロバイダー固有の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-240">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="aadc8-241">実装をここでは、 [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)このプロバイダーのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-241">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="aadc8-242">NewItem の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-242">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="aadc8-243">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="aadc8-243">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="aadc8-244">[System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)メソッドに渡された文字列の大文字と小文字を実行する必要があります、`type`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="aadc8-244">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="aadc8-245">あいまいな少なく一致ことも可能です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-245">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="aadc8-246">たとえば、種類"file"と"directory"は、あいまいさを解消する最初の文字だけが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-246">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="aadc8-247">場合、`type`パラメーターは、プロバイダーを作成できない型を示します、 [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)メソッドは、ArgumentException メッセージを書き込む必要があります型を示す、プロバイダーを作成できます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-247">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="aadc8-248">`newItemValue`パラメーターの実装、 [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)最低限の文字列をそのまま使用する方法はお勧めします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-248">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="aadc8-249">によって取得されるオブジェクトの型を受け入れる必要がありますもこと、 [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem)メソッドと同じパスにします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-249">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="aadc8-250">[System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)メソッドが使用できる、 [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo)型に変換するメソッド目的の型。</span><span class="sxs-lookup"><span data-stu-id="aadc8-250">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="aadc8-251">実装、 [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)メソッドを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)データ ストアに変更を加える前に、戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-251">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="aadc8-252">呼び出し後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)は true を返し、 [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem)メソッドを呼び出す必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)危険性のあるシステムの変更の追加の確認としてのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-252">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="aadc8-253">New-item コマンドレットへの動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="aadc8-253">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="aadc8-254">場合によって、`New-Item`コマンドレットが実行時に動的に指定されている追加のパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-254">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="aadc8-255">これらの動的パラメーターを提供するコンテナーのプロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-255">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="aadc8-256">このメソッドは、指定されたパスにある項目のパラメーターを取得し、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="aadc8-256">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="aadc8-257">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターを追加、`New-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-257">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="aadc8-258">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-258">This provider does not implement this method.</span></span> <span data-ttu-id="aadc8-259">ただし、次のコードは、このメソッドの既定の実装です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-259">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="aadc8-260">項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-260">Removing Items</span></span>

<span data-ttu-id="aadc8-261">項目を削除するには、Windows PowerShell プロバイダーをオーバーライドする必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem)メソッドからの呼び出しをサポートするために、`Remove-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-261">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="aadc8-262">このメソッドは、指定されたパスにデータ ストアから項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-262">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="aadc8-263">場合、`recurse`のパラメーター、`Remove-Item`コマンドレットに設定されている`true`メソッドは、そのレベルに関係なくすべての子項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-263">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="aadc8-264">パラメーターに設定されている場合`false`メソッドは、指定されたパスに 1 つの項目のみを削除します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-264">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="aadc8-265">このプロバイダーは、項目の削除をサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-265">This provider does not support item removal.</span></span> <span data-ttu-id="aadc8-266">ただし、次のコードは、既定の実装の[System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-266">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="aadc8-267">RemoveItem の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-267">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="aadc8-268">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="aadc8-268">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="aadc8-269">Windows PowerShell コンテナー プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="aadc8-269">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="aadc8-270">これらのケースの実装で、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="aadc8-270">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="aadc8-271">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-271">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="aadc8-272">既定では、このメソッドのオーバーライドする必要がありますオブジェクトは削除しない限り、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティが true にします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-272">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="aadc8-273">指定されたパスには、コンテナーが示されている場合、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-273">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="aadc8-274">実装[System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem)循環リンクは、およびなどがある場合は、無限再帰を回避するため責任を負います。</span><span class="sxs-lookup"><span data-stu-id="aadc8-274">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="aadc8-275">そうした状態を反映するように適切な終了例外をスローする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-275">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="aadc8-276">実装、 [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem)メソッドを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)データ ストアに変更を加える前に、戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-276">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="aadc8-277">呼び出し後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)返します`true`、 [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem)メソッドを呼び出す必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)危険性のあるシステムの変更の追加の確認としてのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-277">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="aadc8-278">Remove-item コマンドレットに動的パラメーターを追加</span><span class="sxs-lookup"><span data-stu-id="aadc8-278">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="aadc8-279">場合によって、`Remove-Item`コマンドレットが実行時に動的に指定されている追加のパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-279">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="aadc8-280">これらの動的パラメーターを提供するコンテナーのプロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters)これらのパラメーターを処理するメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-280">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="aadc8-281">このメソッドは、指定されたパスにある項目の動的パラメーターを取得し、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="aadc8-281">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="aadc8-282">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターを追加、`Remove-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-282">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="aadc8-283">このコンテナーのプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-283">This container provider does not implement this method.</span></span> <span data-ttu-id="aadc8-284">ただし、次のコードは、既定の実装の[System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-284">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="aadc8-285">子項目のクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-285">Querying for Child Items</span></span>

<span data-ttu-id="aadc8-286">子項目が、指定されたパスに存在するかを確認するを確認する、Windows PowerShell コンテナー プロバイダーがオーバーライドする必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-286">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="aadc8-287">このメソッドが戻る`true`アイテムに子、および`false`それ以外の場合。</span><span class="sxs-lookup"><span data-stu-id="aadc8-287">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="aadc8-288">Null または空のパスのメソッドが子にするデータ ストア内のすべての項目を考慮し、返します`true`します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-288">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="aadc8-289">ここでは、オーバーライド、 [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems)メソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-289">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="aadc8-290">メソッドを返すかどうか ChunkPath のヘルパー メソッドによって作成された複数の 2 つのパス部分がある、`false`データベース コンテナーのみとテーブル コンテナーが定義されているため、します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-290">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="aadc8-291">このヘルパー メソッドの詳細については、ChunkPath メソッドについては説明を参照してください[Windows PowerShell 項目プロバイダーを作成する](./creating-a-windows-powershell-item-provider.md)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-291">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="aadc8-292">HasChildItems の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-292">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="aadc8-293">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="aadc8-293">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="aadc8-294">コンテナー プロバイダーが興味深いマウント ポイントの実装を含むルートを公開している場合、 [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) が返されます`true`を null または空の文字列が渡された場合に、パスにします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-294">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="aadc8-295">項目のコピー</span><span class="sxs-lookup"><span data-stu-id="aadc8-295">Copying Items</span></span>

<span data-ttu-id="aadc8-296">項目をコピーするコンテナー プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)メソッドからの呼び出しをサポートするために、`Copy-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-296">To copy items, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="aadc8-297">このメソッドによって示される位置からのデータ項目のコピー、`path`で示された場所にコマンドレットのパラメーター、`copyPath`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="aadc8-297">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="aadc8-298">場合、`recurse`パラメーターを指定すると、メソッドは、すべてのサブコンテナーをコピーします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-298">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="aadc8-299">パラメーターが指定されていない場合、メソッドは項目の 1 つのレベルのみをコピーします。</span><span class="sxs-lookup"><span data-stu-id="aadc8-299">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="aadc8-300">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-300">This provider does not implement this method.</span></span> <span data-ttu-id="aadc8-301">ただし、次のコードは、既定の実装の[System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-301">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="aadc8-302">CopyItem の実装に関する注意点</span><span class="sxs-lookup"><span data-stu-id="aadc8-302">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="aadc8-303">実装に、次の条件が適用[System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="aadc8-303">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="aadc8-304">Windows PowerShell コンテナー プロバイダーがから ExpandWildcards、フィルター、インクルード、または除外するには、プロバイダーの機能を宣言可能性があります、プロバイダー クラスを定義するときに、 [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)列挙体。</span><span class="sxs-lookup"><span data-stu-id="aadc8-304">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="aadc8-305">これらのケースの実装で、 [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems)メソッドは、メソッドに渡されるパスが指定した要件を満たしていることを確認する必要があります機能。</span><span class="sxs-lookup"><span data-stu-id="aadc8-305">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="aadc8-306">これを行うには、メソッドがプロパティにアクセス適切なたとえば、 [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude)と[System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="aadc8-306">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="aadc8-307">既定では、このメソッドのオーバーライドはないオブジェクトにコピーの既存のオブジェクトしない限り、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティに設定されて`true`します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-307">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="aadc8-308">たとえば、FileSystem プロバイダーはコピーしません c:\temp\abc.txt c:\abc.txt の既存のファイルにしない限り、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティに設定されて`true`します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-308">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="aadc8-309">パスが指定されている場合、`copyPath`パラメーターが存在し、コンテナーを示します、 [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force)プロパティは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-309">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="aadc8-310">この場合、 [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)によって示される項目をコピーする必要があります、`path`でコンテナーにパラメーターが示される、`copyPath`子としてパラメーター。</span><span class="sxs-lookup"><span data-stu-id="aadc8-310">In this case, [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="aadc8-311">実装[System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)循環リンクは、およびなどがある場合は、無限再帰を回避するため責任を負います。</span><span class="sxs-lookup"><span data-stu-id="aadc8-311">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="aadc8-312">そうした状態を反映するように適切な終了例外をスローする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-312">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="aadc8-313">実装、 [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)メソッドを呼び出す必要があります[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)データ ストアに変更を加える前に、戻り値を確認します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-313">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="aadc8-314">呼び出し後[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)は true を返し、 [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem)メソッドを呼び出す必要があります、 [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue)危険性のあるシステムの変更の追加の確認としてのメソッド。</span><span class="sxs-lookup"><span data-stu-id="aadc8-314">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="aadc8-315">これらのメソッドを呼び出す方法の詳細については、次を参照してください。[項目の名前を変更](#Renaming-Items)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-315">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="aadc8-316">Copy-item コマンドレットへの動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="aadc8-316">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="aadc8-317">場合によって、`Copy-Item`コマンドレットが実行時に動的に指定されている追加のパラメーターが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadc8-317">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="aadc8-318">これらの動的パラメーターを提供する、Windows PowerShell コンテナー プロバイダーを実装する必要があります、 [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters)これらを処理するメソッドパラメーター。</span><span class="sxs-lookup"><span data-stu-id="aadc8-318">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="aadc8-319">このメソッドは、指定されたパスにある項目のパラメーターを取得し、プロパティと、コマンドレット クラスのように属性を解析してフィールドを持つオブジェクトを返しますまたは[System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="aadc8-319">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="aadc8-320">Windows PowerShell ランタイムでは、返されたオブジェクトを使用して、パラメーターを追加、`Copy-Item`コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="aadc8-320">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="aadc8-321">このプロバイダーは、このメソッドを実装していません。</span><span class="sxs-lookup"><span data-stu-id="aadc8-321">This provider does not implement this method.</span></span> <span data-ttu-id="aadc8-322">ただし、次のコードは、既定の実装の[System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-322">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="aadc8-323">コード サンプル</span><span class="sxs-lookup"><span data-stu-id="aadc8-323">Code Sample</span></span>

<span data-ttu-id="aadc8-324">完全なサンプル コードでは、次を参照してください。 [AccessDbProviderSample04 コード サンプル](./accessdbprovidersample04-code-sample.md)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-324">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="aadc8-325">Windows PowerShell プロバイダーのビルド</span><span class="sxs-lookup"><span data-stu-id="aadc8-325">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="aadc8-326">参照してください[登録コマンドレット、プロバイダー、およびアプリケーションをホストする方法](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-326">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="aadc8-327">Windows PowerShell プロバイダーのテスト</span><span class="sxs-lookup"><span data-stu-id="aadc8-327">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="aadc8-328">Windows PowerShell を使用した、Windows PowerShell プロバイダーを登録しているときに、コマンドラインでサポートされているコマンドレットを実行してテストできます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-328">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="aadc8-329">次の出力例は架空の Access データベースに注意します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-329">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="aadc8-330">実行、`Get-ChildItem`コマンドレットは、Access データベースの Customers テーブルから子項目の一覧を取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-330">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="aadc8-331">次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-331">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="aadc8-332">実行、`Get-ChildItem`コマンドレットを再度テーブルのデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-332">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="aadc8-333">次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-333">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="aadc8-334">使用して、`Get-Item`データ テーブルの行 0 にある項目を取得するコマンドレットです。</span><span class="sxs-lookup"><span data-stu-id="aadc8-334">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="aadc8-335">次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-335">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="aadc8-336">再利用`Get-Item`行 0 内の項目のデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-336">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="aadc8-337">次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-337">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="aadc8-338">使用して、`New-Item`コマンドレットを既存のテーブルに行を追加します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-338">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="aadc8-339">`Path`パラメーターは、行への完全パスを指定し、行番号を指定する必要がありますが、テーブルの行の既存の番号より大きくなります。</span><span class="sxs-lookup"><span data-stu-id="aadc8-339">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="aadc8-340">`Type`パラメーターを追加する項目の種類を指定するには、「行」を示します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-340">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="aadc8-341">最後に、`Value`パラメーターの行の列の値のコンマ区切りの一覧を指定します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-341">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAdress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="aadc8-342">次のように、新しい項目の操作の正確性を確認します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-342">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="aadc8-343">次の出力が表示されます。</span><span class="sxs-lookup"><span data-stu-id="aadc8-343">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="aadc8-344">参照</span><span class="sxs-lookup"><span data-stu-id="aadc8-344">See Also</span></span>

[<span data-ttu-id="aadc8-345">Windows PowerShell プロバイダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-345">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="aadc8-346">Windows PowerShell プロバイダーのデザイン</span><span class="sxs-lookup"><span data-stu-id="aadc8-346">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="aadc8-347">項目の Windows PowerShell プロバイダーを実装します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-347">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="aadc8-348">ナビゲーションの Windows PowerShell プロバイダーを実装します。</span><span class="sxs-lookup"><span data-stu-id="aadc8-348">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="aadc8-349">登録のコマンドレット、プロバイダー、およびアプリケーションをホストする方法</span><span class="sxs-lookup"><span data-stu-id="aadc8-349">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="aadc8-350">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="aadc8-350">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="aadc8-351">Windows PowerShell プログラマー ガイド</span><span class="sxs-lookup"><span data-stu-id="aadc8-351">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)