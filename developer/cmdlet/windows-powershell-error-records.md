---
title: Windows PowerShell のエラーを記録 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- error category [PowerShell SDK]
- error identifier [PowerShell SDK]
- error records [PowerShell SDK]
- error category string [PowerShell SDK]
ms.assetid: bdd66fea-eb63-4bb6-9cbe-9a799e5e0db5
caps.latest.revision: 9
ms.openlocfilehash: 5412d88b690a1f5f1ef387416e3bf9da3a32c95d
ms.sourcegitcommit: 46bebe692689ebedfe65ff2c828fe666b443198d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/10/2019
ms.locfileid: "67735065"
---
# <a name="windows-powershell-error-records"></a><span data-ttu-id="41bb1-102">Windows PowerShell エラー レコード</span><span class="sxs-lookup"><span data-stu-id="41bb1-102">Windows PowerShell Error Records</span></span>

<span data-ttu-id="41bb1-103">コマンドレットに渡す必要があります、 [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)を終了し、未終了エラーをエラー状態を識別するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="41bb1-103">Cmdlets must pass an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that identifies the error condition for terminating and non-terminating errors.</span></span>

<span data-ttu-id="41bb1-104">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクトには、次の情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="41bb1-104">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object contains the following information:</span></span>

- <span data-ttu-id="41bb1-105">エラーを説明する例外。</span><span class="sxs-lookup"><span data-stu-id="41bb1-105">The exception that describes the error.</span></span> <span data-ttu-id="41bb1-106">多くの場合、これは、コマンドレットがキャッチされ、エラー レコードに変換する例外です。</span><span class="sxs-lookup"><span data-stu-id="41bb1-106">Often, this is an exception that the cmdlet caught and converted into an error record.</span></span> <span data-ttu-id="41bb1-107">すべてのエラー レコードには、例外を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="41bb1-107">Every error record must contain an exception.</span></span>

<span data-ttu-id="41bb1-108">コマンドレットでは、例外をキャッチしなかった場合は新しい例外を作成する必要があり、エラー条件に最も近い例外クラスを選択します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-108">If the cmdlet did not catch an exception, it must create a new exception and choose the exception class that best describes the error condition.</span></span> <span data-ttu-id="41bb1-109">ただしを使用してアクセスできるため、例外がスローする必要はありません、 [System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)のプロパティ、 [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="41bb1-109">However, you do not need to throw the exception because it can be accessed through the [System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

- <span data-ttu-id="41bb1-110">特定のエラー ハンドラーを使用して特定のエラー条件を処理する Windows PowerShell スクリプト、診断のために使用できる対象となる指定子を提供するエラーの識別子です。</span><span class="sxs-lookup"><span data-stu-id="41bb1-110">An error identifier that provides a targeted designator that can be used for diagnostic purposes and by Windows PowerShell scripts to handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="41bb1-111">すべてのエラー レコードは、エラーの識別子を含める必要があります (エラーの識別子を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="41bb1-111">Every error record must contain an error identifier (see Error Identifier).</span></span>

- <span data-ttu-id="41bb1-112">診断のために使用できる一般的な指定子を提供するエラー カテゴリ。</span><span class="sxs-lookup"><span data-stu-id="41bb1-112">An error category that provides a general designator that can be used for diagnostic purposes.</span></span> <span data-ttu-id="41bb1-113">すべてのエラー レコードは、エラー カテゴリを指定する必要があります (エラーのカテゴリを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="41bb1-113">Every error record must specify an error category (see Error Category).</span></span>

- <span data-ttu-id="41bb1-114">省略可能な交換のエラー メッセージと推奨される操作 (交換のエラー メッセージを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="41bb1-114">An optional replacement error message and a recommended action (see Replacement Error Message).</span></span>

- <span data-ttu-id="41bb1-115">省略可能な呼び出しをエラーをスローしたコマンドレットについて説明します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-115">Optional invocation information about the cmdlet that threw the error.</span></span> <span data-ttu-id="41bb1-116">Windows PowerShell でこの情報が指定された (呼び出しメッセージを参照してください)。</span><span class="sxs-lookup"><span data-stu-id="41bb1-116">This information is specified by Windows PowerShell (see Invocation Message).</span></span>

- <span data-ttu-id="41bb1-117">エラーが発生したときに処理されていたターゲット オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="41bb1-117">The target object that was being processed when the error occurred.</span></span> <span data-ttu-id="41bb1-118">入力のオブジェクトがあります。 または別のオブジェクト、コマンドレットを処理している場合があります。</span><span class="sxs-lookup"><span data-stu-id="41bb1-118">This might be the input object, or it might be another object that your cmdlet was processing.</span></span> <span data-ttu-id="41bb1-119">たとえば、コマンドは、`remove-item -recurse c:\somedirectory`エラー"c:\somedirectory\lockedfile"の FileInfo オブジェクトのインスタンスである可能性があります。</span><span class="sxs-lookup"><span data-stu-id="41bb1-119">For example, for the command `remove-item -recurse c:\somedirectory`, the error might be an instance of a FileInfo object for "c:\somedirectory\lockedfile".</span></span> <span data-ttu-id="41bb1-120">ターゲット オブジェクトの情報は省略可能です。</span><span class="sxs-lookup"><span data-stu-id="41bb1-120">The target object information is optional.</span></span>

## <a name="error-identifier"></a><span data-ttu-id="41bb1-121">エラー識別子</span><span class="sxs-lookup"><span data-stu-id="41bb1-121">Error Identifier</span></span>

<span data-ttu-id="41bb1-122">エラー レコードを作成するときに、コマンドレット内のエラー条件を指定する識別子を指定します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-122">When you create an error record, specify an identifier that designates the error condition within your cmdlet.</span></span> <span data-ttu-id="41bb1-123">Windows PowerShell は、エラーの完全修飾識別子を作成するコマンドレットの名前と、対象となる識別子を結合します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-123">Windows PowerShell combines the targeted identifier with the name of your cmdlet to create a fully qualified error identifier.</span></span> <span data-ttu-id="41bb1-124">エラーの完全修飾識別子をを介してアクセスできる、 [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId)のプロパティ、 [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="41bb1-124">The fully qualified error identifier can be accessed through the [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="41bb1-125">単独では、エラーの識別子を使用できません。</span><span class="sxs-lookup"><span data-stu-id="41bb1-125">The error identifier is not available by itself.</span></span> <span data-ttu-id="41bb1-126">入手可能になったエラーの完全修飾識別子の一部としてのみです。</span><span class="sxs-lookup"><span data-stu-id="41bb1-126">It is available only as part of the fully qualified error identifier.</span></span>

<span data-ttu-id="41bb1-127">エラー レコードを作成するときに、エラーの識別子を生成するのにには、次のガイドラインを使用します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-127">Use the following guidelines to generate error identifiers when you create error records:</span></span>

- <span data-ttu-id="41bb1-128">エラー条件に固有のエラー識別子を作成します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-128">Make error identifiers specific to an error condition.</span></span> <span data-ttu-id="41bb1-129">診断のために、特定のエラー ハンドラーを使用して特定のエラー条件を処理するスクリプトのエラー識別子を対象します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-129">Target the error identifiers for diagnostic purposes and for scripts that handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="41bb1-130">ユーザーは、エラーの識別子を使用して、エラーとそのソースを識別するためにできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="41bb1-130">A user should be able to use the error identifier to identify the error and its source.</span></span> <span data-ttu-id="41bb1-131">エラー識別子では、新しい例外のサブクラスが必要でないように、既存の例外からの特定のエラー条件のレポートも有効にします。</span><span class="sxs-lookup"><span data-stu-id="41bb1-131">Error identifiers also enable reporting for specific error conditions from existing exceptions so that new exception subclasses are not required.</span></span>

- <span data-ttu-id="41bb1-132">一般に、異なるコード パスを別のエラーの識別子を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="41bb1-132">In general, assign different error identifiers to different code paths.</span></span> <span data-ttu-id="41bb1-133">エンドユーザーは、特定の識別子からメリットがあります。</span><span class="sxs-lookup"><span data-stu-id="41bb1-133">The end-user benefits from specific identifiers.</span></span> <span data-ttu-id="41bb1-134">多くの場合、各コードのパスを呼び出す[System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)または[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)が独自の識別子。</span><span class="sxs-lookup"><span data-stu-id="41bb1-134">Often, each code path that calls [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) has its own identifier.</span></span> <span data-ttu-id="41bb1-135">原則として、エラー メッセージ、およびその逆の新しいテンプレート文字列を定義するときに、新しい識別子を定義します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-135">As a rule, define a new identifier when you define a new template string for the error message, and vice-versa.</span></span> <span data-ttu-id="41bb1-136">識別子としてエラー メッセージを使わないでください。</span><span class="sxs-lookup"><span data-stu-id="41bb1-136">Do not use the error message as an identifier.</span></span>

- <span data-ttu-id="41bb1-137">特定のエラー識別子を使用してコードを発行するときに、完全な製品の識別子を持つエラーのセマンティクスのサポート ライフ サイクルを確立します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-137">When you publish code using a particular error identifier, you establish the semantics of errors with that identifier for your complete product support lifecycle.</span></span> <span data-ttu-id="41bb1-138">再利用しないことは、元のコンテキストから意味の異なるコンテキストでします。</span><span class="sxs-lookup"><span data-stu-id="41bb1-138">Do not reuse it in a context that is semantically different from the original context.</span></span> <span data-ttu-id="41bb1-139">このエラーのセマンティクスを変更する場合は、作成し、新しい識別子を使用します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-139">If the semantics of this error change, create and then use a new identifier.</span></span>

- <span data-ttu-id="41bb1-140">特定の CLR 型の例外に対してのみ、特定のエラー識別子を使用する必要があります一般にします。</span><span class="sxs-lookup"><span data-stu-id="41bb1-140">You should generally use a particular error identifier only for exceptions of a particular CLR type.</span></span> <span data-ttu-id="41bb1-141">例外の種類またはターゲット オブジェクトの型が変更された場合は、作成し、新しい識別子を使用します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-141">If the type of the exception or the type of the target object changes, create and then use a new identifier.</span></span>

- <span data-ttu-id="41bb1-142">簡潔に報告するエラーに対応するユーザーのエラー識別子のテキストを選択します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-142">Choose text for your error identifier that concisely corresponds to the error that you are reporting.</span></span> <span data-ttu-id="41bb1-143">標準の .NET Framework の名前付けおよび大文字と小文字の規則を使用します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-143">Use standard .NET Framework naming and capitalization conventions.</span></span> <span data-ttu-id="41bb1-144">空白や句読点を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="41bb1-144">Do not use white space or punctuation.</span></span> <span data-ttu-id="41bb1-145">エラー識別子はローカライズしないでください。</span><span class="sxs-lookup"><span data-stu-id="41bb1-145">Do not localize error identifiers.</span></span>

- <span data-ttu-id="41bb1-146">動的に生成しませんエラー識別子再現できない方法で。</span><span class="sxs-lookup"><span data-stu-id="41bb1-146">Do not dynamically generate error identifiers in a non-reproducible way.</span></span> <span data-ttu-id="41bb1-147">たとえば、プロセス ID などのエラー情報を組み込んでいません。</span><span class="sxs-lookup"><span data-stu-id="41bb1-147">For example, do not incorporate error information such as a process ID.</span></span> <span data-ttu-id="41bb1-148">エラー識別子は、同じエラー条件が発生している他のユーザーに表示されるエラーの識別子に対応する場合にのみ役立ちます。</span><span class="sxs-lookup"><span data-stu-id="41bb1-148">Error identifiers are useful only if they correspond to the error identifiers seen by other users who are experiencing the same error condition.</span></span>

## <a name="error-category"></a><span data-ttu-id="41bb1-149">エラー カテゴリ</span><span class="sxs-lookup"><span data-stu-id="41bb1-149">Error Category</span></span>

<span data-ttu-id="41bb1-150">エラー レコードを作成する場合は、によって定義された定数のいずれかを使用してエラーのカテゴリを指定、 [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)列挙体。</span><span class="sxs-lookup"><span data-stu-id="41bb1-150">When you create an error record, specify the category of the error using one of the constants defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) enumeration.</span></span> <span data-ttu-id="41bb1-151">Windows PowerShell ユーザー設定するときに、エラー情報を表示するエラー カテゴリを使用して、`$ErrorView`変数を`"CategoryView"`します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-151">Windows PowerShell uses the error category to display error information when users set the `$ErrorView` variable to `"CategoryView"`.</span></span>

<span data-ttu-id="41bb1-152">使用しないでください、 [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified**定数。</span><span class="sxs-lookup"><span data-stu-id="41bb1-152">Avoid using the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified** constant.</span></span> <span data-ttu-id="41bb1-153">エラーの原因となった操作、またはエラーに関する情報があれば、カテゴリが完全に一致する場合でも、エラーまたは操作に最も近いカテゴリを選択します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-153">If you have any information about the error or about the operation that caused the error, choose the category that best describes the error or the operation, even if the category is not a perfect match.</span></span>

<span data-ttu-id="41bb1-154">Windows PowerShell によって表示される情報はカテゴリの表示文字列として参照されておりのプロパティから構築された、 [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)クラス。</span><span class="sxs-lookup"><span data-stu-id="41bb1-154">The information displayed by Windows PowerShell is referred to as the category-view string and is built from the properties of the [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo) class.</span></span> <span data-ttu-id="41bb1-155">(このクラスは、エラー [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)プロパティです)。</span><span class="sxs-lookup"><span data-stu-id="41bb1-155">(This class is accessed through the error [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property.)</span></span>

```
{Category}: ({TargetName}:{TargetType}):[{Activity}], {Reason}
```

<span data-ttu-id="41bb1-156">次の一覧には、表示される情報について説明します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-156">The following list describes the information displayed:</span></span>

- <span data-ttu-id="41bb1-157">[カテゴリ]:Windows PowerShell による[System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)定数。</span><span class="sxs-lookup"><span data-stu-id="41bb1-157">Category: A Windows PowerShell-defined [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) constant.</span></span>

- <span data-ttu-id="41bb1-158">TargetName:既定では、オブジェクトの名前、コマンドレットが処理エラーが発生したときにします。</span><span class="sxs-lookup"><span data-stu-id="41bb1-158">TargetName: By default, the name of the object the cmdlet was processing when the error occurred.</span></span> <span data-ttu-id="41bb1-159">または、別のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="41bb1-159">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="41bb1-160">TargetType:既定では、ターゲット オブジェクトの種類。</span><span class="sxs-lookup"><span data-stu-id="41bb1-160">TargetType: By default, the type of the target object.</span></span> <span data-ttu-id="41bb1-161">または、別のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="41bb1-161">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="41bb1-162">アクティビティ:既定ではエラー レコードを作成したコマンドレットの名前。</span><span class="sxs-lookup"><span data-stu-id="41bb1-162">Activity: By default, the name of the cmdlet that created the error record.</span></span> <span data-ttu-id="41bb1-163">または、他のコマンドレットで定義されている文字列。</span><span class="sxs-lookup"><span data-stu-id="41bb1-163">Or, some other cmdlet-defined string.</span></span>

- <span data-ttu-id="41bb1-164">理由:既定では、例外の種類。</span><span class="sxs-lookup"><span data-stu-id="41bb1-164">Reason: By default, the exception type.</span></span> <span data-ttu-id="41bb1-165">または、別のコマンドレットで定義された文字列。</span><span class="sxs-lookup"><span data-stu-id="41bb1-165">Or, another cmdlet-defined string.</span></span>

## <a name="replacement-error-message"></a><span data-ttu-id="41bb1-166">エラー メッセージの交換</span><span class="sxs-lookup"><span data-stu-id="41bb1-166">Replacement Error Message</span></span>

<span data-ttu-id="41bb1-167">エラーの既定のエラー メッセージに由来の既定のメッセージ テキスト、コマンドレットのエラー レコードを開発する際に、 [System.Exception.Message](/dotnet/api/System.Exception.Message)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="41bb1-167">When you develop an error record for a cmdlet, the default error message for the error comes from the default message text in the [System.Exception.Message](/dotnet/api/System.Exception.Message) property.</span></span> <span data-ttu-id="41bb1-168">これは、プロパティは読み取り専用プロパティ (.NET Framework ガイドライン) によるデバッグのためだけのメッセージ テキストが対象としています。</span><span class="sxs-lookup"><span data-stu-id="41bb1-168">This is a read-only property whose message text is intended only for debugging purposes (according to the .NET Framework guidelines).</span></span> <span data-ttu-id="41bb1-169">置き換えるか、既定のメッセージ テキストを補強するエラー メッセージを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="41bb1-169">We recommend that you create an error message that replaces or augments the default message text.</span></span> <span data-ttu-id="41bb1-170">メッセージをユーザーにわかりやすいより限定コマンドレットに加えます。</span><span class="sxs-lookup"><span data-stu-id="41bb1-170">Make the message more user-friendly and more specific to the cmdlet.</span></span>

<span data-ttu-id="41bb1-171">交換のメッセージがによって提供される、 [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="41bb1-171">The replacement message is provided by an [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object.</span></span> <span data-ttu-id="41bb1-172">Windows PowerShell で使用できる追加のローカリゼーション情報を提供するために、このオブジェクトの次のコンス トラクターのいずれかを使用します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-172">Use one of the following constructors of this object because they provide additional localization information that can be used by Windows PowerShell.</span></span>

- <span data-ttu-id="41bb1-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___):このコンス トラクターを使用して、テンプレート文字列が、コマンドレットが実装される、同じアセンブリ内のリソース文字列の場合、またはの上書きすることによって、テンプレート文字列をロードする場合、 [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)メソッド。</span><span class="sxs-lookup"><span data-stu-id="41bb1-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___): Use this constructor if your template string is a resource string in the same assembly in which the cmdlet is implemented or if you want to load the template string through an override of the  [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString) method.</span></span>

- <span data-ttu-id="41bb1-174">[ErrorDetails(Assembly, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___):このコンス トラクターを使用して、テンプレート文字列が別のアセンブリでのオーバーライドによって読み込みは[System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-174">[ErrorDetails(Assembly, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___): Use this constructor if the template string is in another assembly and you do not load it through an override of [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString).</span></span>

<span data-ttu-id="41bb1-175">交換のメッセージは、わずかな違いで例外メッセージを書き込むための .NET Framework デザイン ガイドラインに従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="41bb1-175">The replacement message should conform to the .NET Framework design guidelines for writing exception messages with a small difference.</span></span> <span data-ttu-id="41bb1-176">開発者の例外メッセージを書き込む必要があるガイドラインの状態。</span><span class="sxs-lookup"><span data-stu-id="41bb1-176">The guidelines state that exception messages should be written for developers.</span></span> <span data-ttu-id="41bb1-177">コマンドレットのユーザーに対して、これらの交換のメッセージが書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="41bb1-177">These replacement messages should be written for the cmdlet user.</span></span>

<span data-ttu-id="41bb1-178">前に、交換のエラー メッセージを追加する必要があります、 [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)または[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="41bb1-178">The replacement error message must be added before the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) methods are called.</span></span> <span data-ttu-id="41bb1-179">交換のメッセージを追加するには、設定、 [System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)エラー レコードのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="41bb1-179">To add a replacement message, set the [System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) property of the error record.</span></span> <span data-ttu-id="41bb1-180">このプロパティを設定すると、Windows PowerShell が表示されます、 [System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message)既定のメッセージ テキストではなくプロパティ。</span><span class="sxs-lookup"><span data-stu-id="41bb1-180">When this property is set, Windows PowerShell displays the [System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message) property instead of the default message text.</span></span>

## <a name="recommended-action-information"></a><span data-ttu-id="41bb1-181">アクションの情報をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="41bb1-181">Recommended Action Information</span></span>

<span data-ttu-id="41bb1-182">[System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)オブジェクトは、どのようなアクションは、エラーが発生した場合に推奨されるに関する情報を提供もできます。</span><span class="sxs-lookup"><span data-stu-id="41bb1-182">The [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object can also provide information about what actions are recommended when the error occurs.</span></span>

## <a name="invocation-information"></a><span data-ttu-id="41bb1-183">呼び出し情報</span><span class="sxs-lookup"><span data-stu-id="41bb1-183">Invocation information</span></span>

<span data-ttu-id="41bb1-184">コマンドレットを使用する場合[System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)または[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)エラー レコード、Windows PowerShell を報告するにはエラーが発生したときに呼び出されたコマンドを説明する情報を自動的に追加します。</span><span class="sxs-lookup"><span data-stu-id="41bb1-184">When a cmdlet uses [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) to report an error record, Windows PowerShell automatically adds information that describes the command that was invoked when the error occurred.</span></span> <span data-ttu-id="41bb1-185">この情報によって提供されます、 [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo)コマンド、コマンド自体には、によって呼び出されたコマンドレットの名前を格納しているオブジェクトと、パイプラインまたはスクリプトに関する情報。</span><span class="sxs-lookup"><span data-stu-id="41bb1-185">This information is provided by a [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo) object that contains the name of the cmdlet that was invoked by the command, the command itself, and information about the pipeline or script.</span></span> <span data-ttu-id="41bb1-186">このプロパティは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="41bb1-186">This property is read-only.</span></span>

## <a name="see-also"></a><span data-ttu-id="41bb1-187">参照</span><span class="sxs-lookup"><span data-stu-id="41bb1-187">See Also</span></span>

[<span data-ttu-id="41bb1-188">System.Management.Automation.Cmdlet.WriteError</span><span class="sxs-lookup"><span data-stu-id="41bb1-188">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="41bb1-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span><span class="sxs-lookup"><span data-stu-id="41bb1-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="41bb1-190">System.Management.Automation.ErrorCategory</span><span class="sxs-lookup"><span data-stu-id="41bb1-190">System.Management.Automation.ErrorCategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)

[<span data-ttu-id="41bb1-191">System.Management.Automation.Errorcategoryinfo</span><span class="sxs-lookup"><span data-stu-id="41bb1-191">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="41bb1-192">System.Management.Automation.ErrorRecord</span><span class="sxs-lookup"><span data-stu-id="41bb1-192">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="41bb1-193">System.Management.Automation.ErrorDetails</span><span class="sxs-lookup"><span data-stu-id="41bb1-193">System.Management.Automation.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorDetails)

[<span data-ttu-id="41bb1-194">System.Management.Automation.Invocationinfo</span><span class="sxs-lookup"><span data-stu-id="41bb1-194">System.Management.Automation.Invocationinfo</span></span>](/dotnet/api/System.Management.Automation.InvocationInfo)

[<span data-ttu-id="41bb1-195">Windows PowerShell のエラー報告</span><span class="sxs-lookup"><span data-stu-id="41bb1-195">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="41bb1-196">Windows PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="41bb1-196">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
