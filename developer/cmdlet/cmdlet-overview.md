---
title: コマンドレットの概要 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- cmdlets [PowerShell SDK]
- cmdlets [PowerShell SDK], described
ms.assetid: 0aa32589-4447-4ead-a5dd-a3be99113140
caps.latest.revision: 21
ms.openlocfilehash: 14200aed2fb94c37c8b8af29650f602945e7ac1c
ms.sourcegitcommit: 58fb23c854f5a8b40ad1f952d3323aeeccac7a24
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65229368"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="b8983-102">コマンドレットの概要</span><span class="sxs-lookup"><span data-stu-id="b8983-102">Cmdlet Overview</span></span>

<span data-ttu-id="b8983-103">コマンドレットは、Windows PowerShell 環境で使用される軽量コマンドです。</span><span class="sxs-lookup"><span data-stu-id="b8983-103">A cmdlet is a lightweight command that is used in the Windows PowerShell environment.</span></span> <span data-ttu-id="b8983-104">Windows PowerShell ランタイムでは、コマンドラインで提供されている自動化スクリプトのコンテキスト内でこれらのコマンドレットを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b8983-104">The Windows PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="b8983-105">Windows PowerShell ランタイムも呼び出されたプログラムで Windows PowerShell Api を使用します。</span><span class="sxs-lookup"><span data-stu-id="b8983-105">The Windows PowerShell runtime also invokes them programmatically through Windows PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="b8983-106">コマンドレット</span><span class="sxs-lookup"><span data-stu-id="b8983-106">Cmdlets</span></span>

<span data-ttu-id="b8983-107">コマンドレットは、アクションの実行し、通常、パイプラインでは、次のコマンドに、Microsoft .NET Framework オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="b8983-107">Cmdlets perform an action and typically return a Microsoft .NET Framework object to the next command in the pipeline.</span></span> <span data-ttu-id="b8983-108">コマンドレットを作成するには、2 つの特殊なコマンドレットの基底クラスのいずれかから派生したコマンドレット クラスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-108">To write a cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="b8983-109">派生クラスである必要があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-109">The derived class must:</span></span>

- <span data-ttu-id="b8983-110">コマンドレットと派生クラスを識別する属性を宣言します。</span><span class="sxs-lookup"><span data-stu-id="b8983-110">Declare an attribute that identifies the derived class as a cmdlet.</span></span>

- <span data-ttu-id="b8983-111">コマンドレットのパラメーターとしてパブリック プロパティを識別する属性で装飾するパブリック プロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="b8983-111">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>

- <span data-ttu-id="b8983-112">1 つ以上の入力処理レコードを処理メソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b8983-112">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="b8983-113">使用して直接クラスを含むアセンブリを読み込むことができます、 [Import-module](/powershell/module/microsoft.powershell.core/import-module)コマンドレット、またはを使用して、アセンブリを読み込むホスト アプリケーションを作成できます、 [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API。</span><span class="sxs-lookup"><span data-stu-id="b8983-113">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="b8983-114">どちらの方法では、コマンドレットの機能にプログラムおよびコマンド ライン アクセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="b8983-114">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="b8983-115">コマンドレットの使用条件</span><span class="sxs-lookup"><span data-stu-id="b8983-115">Cmdlet Terms</span></span>

<span data-ttu-id="b8983-116">次の用語は、Windows PowerShell コマンドレットのドキュメントでよく使用されます。</span><span class="sxs-lookup"><span data-stu-id="b8983-116">The following terms are used frequently in the Windows PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="b8983-117">コマンドレット属性</span><span class="sxs-lookup"><span data-stu-id="b8983-117">Cmdlet attribute</span></span>

<span data-ttu-id="b8983-118">コマンドレットとコマンドレットのクラスを宣言するために使用する .NET Framework 属性。</span><span class="sxs-lookup"><span data-stu-id="b8983-118">A .NET Framework attribute that is used to declare a cmdlet class as a cmdlet.</span></span>
<span data-ttu-id="b8983-119">PowerShell は、省略可能なその他のいくつかの属性を使用して、コマンドレットの属性が必要です。</span><span class="sxs-lookup"><span data-stu-id="b8983-119">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span>
<span data-ttu-id="b8983-120">この属性の詳細については、次を参照してください。[コマンドレット属性宣言](cmdlet-attribute-declaration.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-120">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="b8983-121">コマンドレットのパラメーター</span><span class="sxs-lookup"><span data-stu-id="b8983-121">Cmdlet parameter</span></span>

<span data-ttu-id="b8983-122">コマンドレットを実行しているアプリケーションにユーザーに使用可能なパラメーターを定義するパブリック プロパティ。</span><span class="sxs-lookup"><span data-stu-id="b8983-122">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span>
<span data-ttu-id="b8983-123">名前付きの位置を指定すると、コマンドレットできる必要があると*切り替える*パラメーター。</span><span class="sxs-lookup"><span data-stu-id="b8983-123">Cmdlets can have required, named, positional, and *switch* parameters.</span></span>
<span data-ttu-id="b8983-124">スイッチ パラメーターを使用すると、パラメーターが呼び出しで指定された場合にのみ評価されるパラメーターを定義できます。</span><span class="sxs-lookup"><span data-stu-id="b8983-124">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span>
<span data-ttu-id="b8983-125">パラメーターのさまざまな種類の詳細については、次を参照してください。[コマンドレット パラメーター](cmdlet-parameters.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-125">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="b8983-126">パラメーター セット</span><span class="sxs-lookup"><span data-stu-id="b8983-126">Parameter set</span></span>

<span data-ttu-id="b8983-127">特定のアクションを実行するために同じコマンドで使用できるパラメーターのグループ。</span><span class="sxs-lookup"><span data-stu-id="b8983-127">A group of parameters that can be used in the same command to perform a specific action.</span></span>
<span data-ttu-id="b8983-128">コマンドレットは、複数のパラメーター セットを持つことができますが、各パラメーター セットが一意である少なくとも 1 つのパラメーターをいる必要があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-128">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span>
<span data-ttu-id="b8983-129">適切なコマンドレットのデザインでは、一意のパラメーターも必須パラメーターであることを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b8983-129">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="b8983-130">パラメーター セットの詳細については、次を参照してください。[コマンドレット パラメーター設定](cmdlet-parameter-sets.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-130">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="b8983-131">動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="b8983-131">Dynamic parameter</span></span>

<span data-ttu-id="b8983-132">実行時に、コマンドレットに追加されるパラメーター。</span><span class="sxs-lookup"><span data-stu-id="b8983-132">A parameter that is added to the cmdlet at runtime.</span></span>
<span data-ttu-id="b8983-133">通常、動的パラメーターは、別のパラメーターが特定の値に設定されている場合、コマンドレットに追加されます。</span><span class="sxs-lookup"><span data-stu-id="b8983-133">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span>
<span data-ttu-id="b8983-134">動的パラメーターの詳細については、次を参照してください。[コマンドレットの動的パラメーター](cmdlet-dynamic-parameters.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-134">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-method"></a><span data-ttu-id="b8983-135">入力処理メソッド</span><span class="sxs-lookup"><span data-stu-id="b8983-135">Input processing method</span></span>

<span data-ttu-id="b8983-136">コマンドが入力として受信するレコードを処理するのに使用できるメソッド。</span><span class="sxs-lookup"><span data-stu-id="b8983-136">A method that a cmdlet can use to process the records it receives as input.</span></span>
<span data-ttu-id="b8983-137">入力の処理方法があります、 [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)メソッド、 [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)メソッド、 [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)メソッド、および[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing)メソッド。</span><span class="sxs-lookup"><span data-stu-id="b8983-137">The input processing methods include the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method, and the [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) method.</span></span> <span data-ttu-id="b8983-138">コマンドレットを実装するときの少なくとも 1 つをオーバーライドする必要があります、 [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)、 [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)、および[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)メソッド。</span><span class="sxs-lookup"><span data-stu-id="b8983-138">When you implement a cmdlet, you must override at least one of the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord), and [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) methods.</span></span>
<span data-ttu-id="b8983-139">通常、 [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)メソッドは、コマンドレットが処理されるレコードごとに呼び出されるためにオーバーライドするメソッドです。</span><span class="sxs-lookup"><span data-stu-id="b8983-139">Typically, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method is the method that you override because it is called for every record that the cmdlet processes.</span></span>
<span data-ttu-id="b8983-140">これに対し、 [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)メソッドと[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)を実行するメソッドに 1 回は呼び出されます処理前または処理後のレコード。</span><span class="sxs-lookup"><span data-stu-id="b8983-140">In contrast, the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method and the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method are called one time to perform pre-processing or post-processing of the records.</span></span>
<span data-ttu-id="b8983-141">これらのメソッドの詳細については、次を参照してください。[入力処理メソッド](cmdlet-input-processing-methods.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-141">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="b8983-142">ShouldProcess 機能</span><span class="sxs-lookup"><span data-stu-id="b8983-142">ShouldProcess feature</span></span>

<span data-ttu-id="b8983-143">PowerShell は、コマンドレットでは、システムに変更を加える前に、ユーザーにフィードバックを求めるコマンドレットを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="b8983-143">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span>
<span data-ttu-id="b8983-144">コマンドレットは、この機能を使用するコマンドレットの属性を宣言すると、コマンドレットを呼び出す必要があります、ShouldProcess 機能をサポートしているを宣言する必要があります、 [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)と[System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)入力処理メソッド内のメソッド。</span><span class="sxs-lookup"><span data-stu-id="b8983-144">To use this feature, the cmdlet must declare that it supports the ShouldProcess feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span>
<span data-ttu-id="b8983-145">ShouldProcess 機能をサポートする方法の詳細については、次を参照してください。[確認を要求する](requesting-confirmation-from-cmdlets.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-145">For more information about how to support the ShouldProcess functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="b8983-146">トランザクション</span><span class="sxs-lookup"><span data-stu-id="b8983-146">Transaction</span></span>

<span data-ttu-id="b8983-147">1 つのタスクとして扱われるコマンドの論理グループです。</span><span class="sxs-lookup"><span data-stu-id="b8983-147">A logical group of commands that are treated as a single task.</span></span>
<span data-ttu-id="b8983-148">タスクは、グループ内の任意のコマンドに失敗し、ユーザーが受け入れるか、トランザクション内で実行されるアクションを拒否するかを選択する場合に自動的に失敗します。</span><span class="sxs-lookup"><span data-stu-id="b8983-148">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span>
<span data-ttu-id="b8983-149">トランザクションに参加するにコマンドレットの属性が宣言されている場合は、トランザクションをサポートしているコマンドレットを宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-149">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span>
<span data-ttu-id="b8983-150">トランザクションのサポートは、Windows PowerShell 2.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="b8983-150">Support for transactions was introduced in Windows PowerShell 2.0.</span></span>
<span data-ttu-id="b8983-151">トランザクションの詳細については、次を参照してください。[トランザクションをサポートする方法](how-to-support-transactions.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-151">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="b8983-152">コマンドのコマンドレットの違い</span><span class="sxs-lookup"><span data-stu-id="b8983-152">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="b8983-153">コマンドレットは、次の方法で他のコマンド シェル環境でコマンドとは異なります。</span><span class="sxs-lookup"><span data-stu-id="b8983-153">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="b8983-154">コマンドレットは、.NET Framework クラスのインスタンススタンドアロン実行可能ファイルではありません。</span><span class="sxs-lookup"><span data-stu-id="b8983-154">Cmdlets are instances of .NET Framework classes; they are not stand-alone executables.</span></span>

- <span data-ttu-id="b8983-155">コマンドレットは、わずか数十個の行のコードから作成できます。</span><span class="sxs-lookup"><span data-stu-id="b8983-155">Cmdlets can be created from as few as a dozen lines of code.</span></span>

- <span data-ttu-id="b8983-156">コマンドレットは、一般的に実行しない独自の解析、エラーのプレゼンテーション、または出力の書式設定します。</span><span class="sxs-lookup"><span data-stu-id="b8983-156">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="b8983-157">解析、エラーのプレゼンテーションと出力の書式設定は、Windows PowerShell ランタイムによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="b8983-157">Parsing, error presentation, and output formatting are handled by the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="b8983-158">入力テキストのストリームではなく、パイプラインからオブジェクトをコマンドレットの処理と、コマンドレットは通常、パイプラインに出力としてオブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="b8983-158">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>

- <span data-ttu-id="b8983-159">コマンドレットは、一度に 1 つのオブジェクトを処理するためのレコード指向です。</span><span class="sxs-lookup"><span data-stu-id="b8983-159">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="b8983-160">コマンドレットの基底クラス</span><span class="sxs-lookup"><span data-stu-id="b8983-160">Cmdlet Base Classes</span></span>

<span data-ttu-id="b8983-161">Windows PowerShell には、次の 2 つの基本クラスから派生したコマンドレットがサポートしています。</span><span class="sxs-lookup"><span data-stu-id="b8983-161">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="b8983-162">ほとんどのコマンドレットがから派生する .NET Framework クラスに基づく、 [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)基本クラス。</span><span class="sxs-lookup"><span data-stu-id="b8983-162">Most cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span> <span data-ttu-id="b8983-163">Windows PowerShell ランタイムに依存関係の最小セットを使用するコマンドレットは、このクラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="b8983-163">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="b8983-164">これは、2 つの利点があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-164">This has two benefits.</span></span> <span data-ttu-id="b8983-165">最初の利点は、コマンドレット オブジェクトは小さく、Windows PowerShell ランタイムへの変更の影響を受ける可能性が少なくです。</span><span class="sxs-lookup"><span data-stu-id="b8983-165">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the Windows PowerShell runtime.</span></span> <span data-ttu-id="b8983-166">2 つ目の利点は、場合にある場合は、コマンドレットのオブジェクトのインスタンスを直接作成して、Windows PowerShell ランタイムを呼び出すのではなく、直接呼び出すことです。</span><span class="sxs-lookup"><span data-stu-id="b8983-166">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="b8983-167">複雑なコマンドレットはから派生する .NET Framework クラスに基づいて、 [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基本クラス。</span><span class="sxs-lookup"><span data-stu-id="b8983-167">The more-complex cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="b8983-168">このクラスから派生するはるかにアクセス、Windows PowerShell ランタイム。</span><span class="sxs-lookup"><span data-stu-id="b8983-168">Deriving from this class gives you much more access to the Windows PowerShell runtime.</span></span> <span data-ttu-id="b8983-169">このアクセスは、コマンドレットを呼び出して、プロバイダーにアクセスして、現在のセッション状態にアクセスするスクリプトをできます。</span><span class="sxs-lookup"><span data-stu-id="b8983-169">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span> <span data-ttu-id="b8983-170">(現在のセッション状態にアクセスするを取得および設定のセッション変数と基本設定。)ただし、コマンドレット オブジェクトのサイズが増加するこのクラスから派生し、コマンドレットが、Windows PowerShell ランタイムの現在のバージョンより緊密に結合することを意味します。</span><span class="sxs-lookup"><span data-stu-id="b8983-170">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the Windows PowerShell runtime.</span></span>

<span data-ttu-id="b8983-171">一般に、Windows PowerShell ランタイムへの拡張が必要でない限り必要がありますから派生した、 [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)クラス。</span><span class="sxs-lookup"><span data-stu-id="b8983-171">In general, unless you need the extended access to the Windows PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="b8983-172">ただし、Windows PowerShell ランタイムには、コマンドレットを実行するための広範なログ記録機能があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-172">However, the Windows PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="b8983-173">派生することによって、別のコマンドレット内から、コマンドレットの実行を防ぐことができます、監査のモデルは、このログに依存する場合、 [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)クラス。</span><span class="sxs-lookup"><span data-stu-id="b8983-173">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="input-processing-methods"></a><span data-ttu-id="b8983-174">入力処理メソッド</span><span class="sxs-lookup"><span data-stu-id="b8983-174">Input Processing Methods</span></span>

<span data-ttu-id="b8983-175">[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)クラスは、レコードを処理するために使用する次の仮想メソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="b8983-175">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="b8983-176">すべての派生コマンドレット クラスには、1 つ以上の最初の 3 つのメソッドをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-176">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="b8983-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing):コマンドレットの 1 回限り、処理前の省略可能な機能を提供するために使用します。</span><span class="sxs-lookup"><span data-stu-id="b8983-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="b8983-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord):コマンドレットに対してレコードずつ処理機能を提供するために使用します。</span><span class="sxs-lookup"><span data-stu-id="b8983-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="b8983-179">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)メソッドは、任意の数だけ、またはまったくないコマンドレットの入力に応じて呼び出す可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b8983-179">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>

- <span data-ttu-id="b8983-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing):コマンドレットの 1 回限り、処理後の省略可能な機能を提供するために使用します。</span><span class="sxs-lookup"><span data-stu-id="b8983-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="b8983-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing):ユーザーが停止するコマンドレットは、非同期的に (たとえば、ctrl キーを押しながら C キーを押して) によって処理が停止するために使用します。</span><span class="sxs-lookup"><span data-stu-id="b8983-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example,  by pressing CTRL+C).</span></span>

<span data-ttu-id="b8983-182">これらのメソッドの詳細については、次を参照してください。[コマンドレットの入力処理メソッド](./cmdlet-input-processing-methods.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-182">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="b8983-183">コマンドレットの属性</span><span class="sxs-lookup"><span data-stu-id="b8983-183">Cmdlet Attributes</span></span>

<span data-ttu-id="b8983-184">Windows PowerShell コマンドレットを管理し、一般的な機能は Windows PowerShell によって提供されると、コマンドレットでする必要がありますを指定に使用されるいくつかの .NET Framework 属性を定義します。</span><span class="sxs-lookup"><span data-stu-id="b8983-184">Windows PowerShell defines several .NET Framework attributes that are used to manage cmdlets and to specify common functionality that is provided by Windows PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="b8983-185">たとえば、コマンドレット、コマンドレットのパラメーターを指定して、コマンドレットの開発者は、コマンドレットのコードでその機能を実装する必要があるないように、入力の検証を要求としてクラスを指定する属性が使用されます。</span><span class="sxs-lookup"><span data-stu-id="b8983-185">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="b8983-186">属性の詳細については、次を参照してください。 [Windows PowerShell 属性](./cmdlet-attributes.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-186">For more information about attributes, see [Windows PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="b8983-187">コマンドレット名</span><span class="sxs-lookup"><span data-stu-id="b8983-187">Cmdlet Names</span></span>

<span data-ttu-id="b8983-188">Windows PowerShell コマンドレットの名前を動詞と名詞を組み合わせた名前のペアを使用します。</span><span class="sxs-lookup"><span data-stu-id="b8983-188">Windows PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="b8983-189">たとえば、 `Get-Command` Windows PowerShell に含まれるコマンドレットを使用して、コマンド シェルに登録されているすべてのコマンドレットを取得します。</span><span class="sxs-lookup"><span data-stu-id="b8983-189">For example, the `Get-Command` cmdlet included in Windows PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="b8983-190">動詞は、コマンドレットを実行するアクションを識別し、名詞は、リソース、コマンドレットがそのアクションを実行しますを識別します。</span><span class="sxs-lookup"><span data-stu-id="b8983-190">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="b8983-191">.NET Framework のクラスがコマンドレットとして宣言されている場合、これらの名前が指定されます。</span><span class="sxs-lookup"><span data-stu-id="b8983-191">These names are specified when the .NET Framework class is declared as a cmdlet.</span></span> <span data-ttu-id="b8983-192">.NET Framework クラスをコマンドレットとして宣言する方法の詳細については、次を参照してください。[コマンドレット属性宣言](./cmdlet-class-declaration.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-192">For more information about how to declare a .NET Framework class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="b8983-193">コマンドレット コードの記述</span><span class="sxs-lookup"><span data-stu-id="b8983-193">Writing Cmdlet Code</span></span>

<span data-ttu-id="b8983-194">このドキュメントでは、コマンドレット コードの記述方法を検出する 2 つの方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="b8983-194">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="b8983-195">大した説明もなしのコードを表示する場合を参照してください。[コマンドレット コードの例の](./examples-of-cmdlet-code.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-195">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="b8983-196">詳細な説明、コードの場合を参照してください、 [GetProc チュートリアル](./getproc-tutorial.md)、 [StopProc チュートリアル](./stopproc-tutorial.md)、または[SelectStr チュートリアル](./selectstr-tutorial.md)トピック。</span><span class="sxs-lookup"><span data-stu-id="b8983-196">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md),  [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="b8983-197">コマンドレットの記述に関するガイドラインの詳細については、次を参照してください。[コマンドレット開発ガイドライン](./cmdlet-development-guidelines.md)します。</span><span class="sxs-lookup"><span data-stu-id="b8983-197">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="b8983-198">参照</span><span class="sxs-lookup"><span data-stu-id="b8983-198">See Also</span></span>

[<span data-ttu-id="b8983-199">Windows PowerShell コマンドレットの概念</span><span class="sxs-lookup"><span data-stu-id="b8983-199">Windows PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="b8983-200">Windows PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="b8983-200">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="b8983-201">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="b8983-201">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
