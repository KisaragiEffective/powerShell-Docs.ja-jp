---
title: 開発のガイドラインを強く推奨 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 4d68a8f3-fba0-44c5-97b9-9fc191d269a5
caps.latest.revision: 13
ms.openlocfilehash: 0906d0d37c66b8c1538a0b2e9e0f1ff2fba12ac0
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/16/2019
ms.locfileid: "58057724"
---
# <a name="strongly-encouraged-development-guidelines"></a><span data-ttu-id="dccb1-102">強くお勧めする開発ガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-102">Strongly Encouraged Development Guidelines</span></span>

<span data-ttu-id="dccb1-103">このセクションには、コマンドレットを記述するときに従う必要のあるガイドラインについて説明します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-103">This section describes guidelines that you should follow when you write your cmdlets.</span></span> <span data-ttu-id="dccb1-104">コマンドレットとコマンドレット コードの記述に関するガイドラインを設計するためのガイドラインに区切られます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="dccb1-105">次のガイドラインは、すべてのシナリオは適用されないことがあります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-105">You might find that these guidelines are not applicable for every scenario.</span></span> <span data-ttu-id="dccb1-106">ただしは適用し、次のガイドラインに従わない場合、コマンドレットを使用するときに、ユーザーはパフォーマンスを低下させるがあります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-106">However, if they do apply and you do not follow these guidelines, your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="dccb1-107">デザイン ガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-107">Design Guidelines</span></span>

- [<span data-ttu-id="dccb1-108">特定の名詞を使用して、コマンドレット名 (SD01)</span><span class="sxs-lookup"><span data-stu-id="dccb1-108">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>](./strongly-encouraged-development-guidelines.md#use-a-specific-noun-for-a-cmdlet-name-sd01)

- [<span data-ttu-id="dccb1-109">パスカル ケースを使用して、コマンドレット名 (SD02)</span><span class="sxs-lookup"><span data-stu-id="dccb1-109">Use Pascal Case for Cmdlet Names (SD02)</span></span>](./strongly-encouraged-development-guidelines.md#use-pascal-case-for-cmdlet-names-sd02)

- [<span data-ttu-id="dccb1-110">パラメーターのデザインのガイドライン (SD03)</span><span class="sxs-lookup"><span data-stu-id="dccb1-110">Parameter Design Guidelines (SD03)</span></span>](./strongly-encouraged-development-guidelines.md#parameter-design-guidelines-sd03)

- [<span data-ttu-id="dccb1-111">(SD04) のユーザーにフィードバックを提供します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-111">Provide Feedback to the User (SD04)</span></span>](./strongly-encouraged-development-guidelines.md#provide-feedback-to-the-user-sd04)

- [<span data-ttu-id="dccb1-112">コマンドレットのヘルプ ファイル (SD05) の作成します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-112">Create a Cmdlet Help File (SD05)</span></span>](./strongly-encouraged-development-guidelines.md#create-a-cmdlet-help-file-sd05)

## <a name="code-guidelines"></a><span data-ttu-id="dccb1-113">コードのガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-113">Code Guidelines</span></span>

- [<span data-ttu-id="dccb1-114">パラメーター (SC01)</span><span class="sxs-lookup"><span data-stu-id="dccb1-114">Coding Parameters (SC01)</span></span>](./strongly-encouraged-development-guidelines.md#coding-parameters-sc01)

- [<span data-ttu-id="dccb1-115">適切に定義されたパイプラインの入力 (SC02) のサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-115">Support Well Defined Pipeline Input (SC02)</span></span>](./strongly-encouraged-development-guidelines.md#support-well-defined-pipeline-input-sc02)

- [<span data-ttu-id="dccb1-116">パイプライン (SC03) に 1 つのレコードを書き込む</span><span class="sxs-lookup"><span data-stu-id="dccb1-116">Write Single Records to the Pipeline (SC03)</span></span>](./strongly-encouraged-development-guidelines.md#write-single-records-to-the-pipeline-sc03)

- [<span data-ttu-id="dccb1-117">コマンドレットを大文字と小文字が区別 (SC04)</span><span class="sxs-lookup"><span data-stu-id="dccb1-117">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>](./strongly-encouraged-development-guidelines.md#make-cmdlets-case-insensitive-and-case-preserving-sc04)

## <a name="design-guidelines"></a><span data-ttu-id="dccb1-118">デザイン ガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-118">Design Guidelines</span></span>

<span data-ttu-id="dccb1-119">間、コマンドレットとその他のコマンドレットを使用して一貫性のあるユーザー エクスペリエンスを実現するためのコマンドレットを設計するときに、次のガイドラインに従ってください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-119">The following guidelines should be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="dccb1-120">自分の状況に適用されるデザインのガイドラインを検索するときに必ずのようなガイドラインについては、コードのガイドラインを確認してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-120">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-a-specific-noun-for-a-cmdlet-name-sd01"></a><span data-ttu-id="dccb1-121">特定の名詞を使用して、コマンドレット名 (SD01)</span><span class="sxs-lookup"><span data-stu-id="dccb1-121">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>

<span data-ttu-id="dccb1-122">名詞コマンドレットの名前付けで使用される、ユーザーは、コマンドレットを検出できるように、非常に限定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-122">Nouns used in cmdlet naming need to be very specific so that the user can discover your cmdlets.</span></span> <span data-ttu-id="dccb1-123">製品名の短縮バージョンでは、"server"などの一般的な名詞をプレフィックスします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-123">Prefix generic nouns such as "server" with a shortened version of the product name.</span></span> <span data-ttu-id="dccb1-124">たとえば、名詞は、Microsoft SQL Server のインスタンスを実行しているサーバーが参照されている場合は、"SQLServer"などの名詞を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-124">For example, if a noun refers to a server that is running an instance of Microsoft SQL Server, use a noun such as "SQLServer".</span></span> <span data-ttu-id="dccb1-125">承認された動詞の簡単なリストと特定の名詞の組み合わせをすばやく検出し、コマンドレット名の間で重複を回避しながら機能が予想されるユーザーを有効にします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-125">The combination of specific nouns and the short list of approved verbs enable the user to quickly discover and anticipate functionality while avoiding duplication among cmdlet names.</span></span>

<span data-ttu-id="dccb1-126">ユーザー エクスペリエンスを強化するために、コマンドレット名の選択した名詞は単数形にあります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-126">To enhance the user experience, the noun that you choose for a cmdlet name should be singular.</span></span> <span data-ttu-id="dccb1-127">たとえば、名前を使用して`Get-Process`の代わりに**Get プロセス**します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-127">For example, use the name `Get-Process` instead of **Get-Processes**.</span></span> <span data-ttu-id="dccb1-128">コマンドレットは、1 つ以上の項目に対して操作を実行する可能性が高い場合でも、すべてのコマンドレット名にはこの規則に従うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-128">It is best to follow this rule for all cmdlet names, even when a cmdlet is likely to act upon more than one item.</span></span>

### <a name="use-pascal-case-for-cmdlet-names-sd02"></a><span data-ttu-id="dccb1-129">パスカル ケースを使用して、コマンドレット名 (SD02)</span><span class="sxs-lookup"><span data-stu-id="dccb1-129">Use Pascal Case for Cmdlet Names (SD02)</span></span>

<span data-ttu-id="dccb1-130">パラメーター名をパスカル ケースを使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-130">Use Pascal case for parameter names.</span></span> <span data-ttu-id="dccb1-131">つまり、動詞と名詞で使用されるすべての用語の最初の文字を大文字にします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-131">In other words, capitalize the first letter of verb and all terms used in the noun.</span></span> <span data-ttu-id="dccb1-132">たとえば、"`Clear-ItemProperty`"。</span><span class="sxs-lookup"><span data-stu-id="dccb1-132">For example, "`Clear-ItemProperty`".</span></span>

### <a name="parameter-design-guidelines-sd03"></a><span data-ttu-id="dccb1-133">パラメーターのデザインのガイドライン (SD03)</span><span class="sxs-lookup"><span data-stu-id="dccb1-133">Parameter Design Guidelines (SD03)</span></span>

<span data-ttu-id="dccb1-134">コマンドレットがパラメーターで、操作する必要があります、データを受信する必要があるし、操作の特性を決定するために使用される情報を示すパラメーターです。</span><span class="sxs-lookup"><span data-stu-id="dccb1-134">A cmdlet needs parameters that receive the data on which it must operate, and parameters that indicate information that is used to determine the characteristics of the operation.</span></span> <span data-ttu-id="dccb1-135">たとえば、コマンドレットがあります、 `Name` 、パイプラインと、コマンドレットからデータを受信するパラメーターがあります、`Force`その操作を実行するコマンドレットを強制できることを指定するパラメーター。</span><span class="sxs-lookup"><span data-stu-id="dccb1-135">For example, a cmdlet might have a `Name` parameter that receives data from the pipeline, and the cmdlet might have a `Force` parameter to indicate that the cmdlet can be forced to perform its operation.</span></span> <span data-ttu-id="dccb1-136">コマンドレットを定義するパラメーターの数に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-136">There is no limit to the number of parameters that a cmdlet can define.</span></span>

#### <a name="use-standard-parameter-names"></a><span data-ttu-id="dccb1-137">標準的なパラメーター名を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-137">Use Standard Parameter Names</span></span>

<span data-ttu-id="dccb1-138">コマンドレットは、標準的なパラメーター名を使用して、ユーザーは、特定のパラメーターの意味簡単に確認できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-138">Your cmdlet should use standard parameter names so that the user can quickly determine what a particular parameter means.</span></span> <span data-ttu-id="dccb1-139">特定の名前が必要な場合、標準的なパラメーター名を使用およびをエイリアスとしてより特定の名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-139">If a more specific name is required, use a standard parameter name, and then specify a more specific name as an alias.</span></span> <span data-ttu-id="dccb1-140">たとえば、`Get-Service`コマンドレットは汎用的な名前のパラメーター (`Name`) と具体的なエイリアス (`ServiceName`)。</span><span class="sxs-lookup"><span data-stu-id="dccb1-140">For example, the `Get-Service` cmdlet has a  parameter that has a generic name (`Name`) and a more specific alias (`ServiceName`).</span></span> <span data-ttu-id="dccb1-141">パラメーターを指定する両方の用語を使用できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-141">Both terms can be used to specify the parameter.</span></span>

<span data-ttu-id="dccb1-142">パラメーター名とそのデータ型の詳細については、[コマンドレットのパラメーター名と機能のガイドライン](./standard-cmdlet-parameter-names-and-types.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-142">For more information about parameter names and their data types, see [Cmdlet Parameter Name and Functionality Guidelines](./standard-cmdlet-parameter-names-and-types.md).</span></span>

#### <a name="use-singular-parameter-names"></a><span data-ttu-id="dccb1-143">単一のパラメーター名を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-143">Use Singular Parameter Names</span></span>

<span data-ttu-id="dccb1-144">パラメーターの値は、1 つの要素の複数形の名前を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-144">Avoid using plural names for parameters whose value is a single element.</span></span> <span data-ttu-id="dccb1-145">これを配列を受け取るパラメーターが含まれていますか、一覧、ユーザーを提供する配列またはリスト要素が 1 つだけなので。</span><span class="sxs-lookup"><span data-stu-id="dccb1-145">This includes parameters that take arrays or lists because the user might supply an array or list with only one element.</span></span>

<span data-ttu-id="dccb1-146">複数形のパラメーター名は、パラメーターの値が、複数要素の値では常に場合にのみ使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-146">Plural parameter names should be used only in those cases where the value of the parameter is always a multiple-element value.</span></span> <span data-ttu-id="dccb1-147">このような場合、コマンドレットは複数の要素を指定すると、そのコマンドレットは、複数の要素が指定されていない場合に、ユーザーの警告を表示する必要がありますを確認してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-147">In these cases, the cmdlet should verify that multiple elements are supplied, and the cmdlet should display a warning to the user if multiple elements are not supplied.</span></span>

#### <a name="use-pascal-case-for-parameter-names"></a><span data-ttu-id="dccb1-148">パスカル ケースを使用して、パラメーター名</span><span class="sxs-lookup"><span data-stu-id="dccb1-148">Use Pascal Case for Parameter Names</span></span>

<span data-ttu-id="dccb1-149">パラメーター名をパスカル ケースを使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-149">Use Pascal case for parameter names.</span></span> <span data-ttu-id="dccb1-150">つまり、名前の最初の文字を含む、パラメーター名の各単語の最初の文字を大文字にします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-150">In other words, capitalize the first letter of each word in the parameter name, including the first letter of the name.</span></span> <span data-ttu-id="dccb1-151">たとえば、パラメーター名`ErrorAction`正しい大文字と小文字を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-151">For example, the parameter name `ErrorAction` uses the correct capitalization.</span></span> <span data-ttu-id="dccb1-152">次のパラメーター名は、大文字と小文字を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-152">The following parameter names use incorrect capitalization:</span></span>

- `errorAction`

- `erroraction`

#### <a name="parameters-that-take-a-list-of-options"></a><span data-ttu-id="dccb1-153">オプションの一覧を取得するパラメーター</span><span class="sxs-lookup"><span data-stu-id="dccb1-153">Parameters That Take a List of Options</span></span>

<span data-ttu-id="dccb1-154">一連のオプションから選択できる値を持つパラメーターを作成する 2 つの方法はあります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-154">There are two ways to create a parameter whose value can be selected from a set of options.</span></span>

- <span data-ttu-id="dccb1-155">列挙型を定義する (または既存の列挙型を使用して) 有効な値を指定します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-155">Define an enumeration type (or use an existing enumeration type) that specifies the valid values.</span></span> <span data-ttu-id="dccb1-156">次に、列挙型を使用して、その型のパラメーターを作成します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-156">Then, use the enumeration type to create a parameter of that type.</span></span>

- <span data-ttu-id="dccb1-157">追加、 **ValidateSet**パラメーター宣言に属性します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-157">Add the **ValidateSet** attribute to the parameter declaration.</span></span> <span data-ttu-id="dccb1-158">この属性の詳細については、[ValidateSet 属性宣言](./validateset-attribute-declaration.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-158">For more information about this attribute, see [ValidateSet Attribute Declaration](./validateset-attribute-declaration.md).</span></span>

#### <a name="use-standard-types-for-parameters"></a><span data-ttu-id="dccb1-159">標準の型パラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-159">Use Standard Types for Parameters</span></span>

<span data-ttu-id="dccb1-160">他のコマンドレットで一貫性を確保するには、するがずっと可能なパラメーターの基本データ型を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-160">To ensure consistency with other cmdlets, use standard types for parameters where ever possible.</span></span> <span data-ttu-id="dccb1-161">別のパラメーターを使用する種類の詳細については、[標準コマンドレットのパラメーター名と型](./standard-cmdlet-parameter-names-and-types.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-161">For more information about the types that should be used for different parameter, see [Standard Cmdlet Parameter Names and Types](./standard-cmdlet-parameter-names-and-types.md).</span></span> <span data-ttu-id="dccb1-162">このトピックでは、名前と、「アクティビティのパラメーター」などの標準パラメーターのグループの .NET Framework 型を記述するいくつかのトピックへのリンクを提供します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-162">This topic provides links to several topics that describe the names and .NET Framework types for groups of standard parameters, such as the "activity parameters".</span></span>

#### <a name="use-strongly-typed-net-framework-types"></a><span data-ttu-id="dccb1-163">厳密に型指定された .NET Framework 型を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-163">Use Strongly-Typed .NET Framework Types</span></span>

<span data-ttu-id="dccb1-164">パラメーターより優れたパラメーターの検証を提供する .NET Framework の型として定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-164">Parameters should be defined as .NET Framework types to provide better parameter validation.</span></span> <span data-ttu-id="dccb1-165">たとえば、値のセットから 1 つの値に制限されているパラメーターは、列挙型として定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-165">For example, parameters that are restricted to one value from a set of values should be defined as an enumeration type.</span></span> <span data-ttu-id="dccb1-166">Uniform Resource Identifier (URI) の値をサポートするために、パラメーターとしての定義、 [System.Uri](/dotnet/api/System.Uri)型。</span><span class="sxs-lookup"><span data-stu-id="dccb1-166">To support a Uniform Resource Identifier (URI) value, define the parameter as a [System.Uri](/dotnet/api/System.Uri) type.</span></span> <span data-ttu-id="dccb1-167">以外のすべての自由形式テキストのプロパティの基本的な文字列パラメーターを回避します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-167">Avoid basic string parameters for all but free-form text properties.</span></span>

#### <a name="use-consistent-parameter-types"></a><span data-ttu-id="dccb1-168">一貫性のあるパラメーターの型を使用して、</span><span class="sxs-lookup"><span data-stu-id="dccb1-168">Use Consistent Parameter Types</span></span>

<span data-ttu-id="dccb1-169">複数のコマンドレットによって、同じパラメーターを使用する場合は、常に同じパラメーターの型を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-169">When the same parameter is used by multiple cmdlets, always use the same parameter type.</span></span>  <span data-ttu-id="dccb1-170">たとえば場合、`Process`パラメーターは、 [System.Int16](/dotnet/api/System.Int16)コマンドレットの 1 つの入力を加えないでください、`Process`別のコマンドレットのパラメーターを[System.Uint16](/dotnet/api/System.UInt16)型。</span><span class="sxs-lookup"><span data-stu-id="dccb1-170">For example, if the `Process` parameter is an [System.Int16](/dotnet/api/System.Int16) type for one cmdlet, do not make the `Process` parameter for another cmdlet a [System.Uint16](/dotnet/api/System.UInt16) type.</span></span>

#### <a name="parameters-that-take-true-and-false"></a><span data-ttu-id="dccb1-171">パラメーターを受け取る True と False</span><span class="sxs-lookup"><span data-stu-id="dccb1-171">Parameters That Take True and False</span></span>

<span data-ttu-id="dccb1-172">場合のみ、パラメーターを受け取り`true`と`false`、パラメーターを型として定義[System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter)します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-172">If your parameter takes only `true` and `false`, define the parameter as type [System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span></span> <span data-ttu-id="dccb1-173">スイッチ パラメーターとして扱われます`true`コマンドで指定されている場合。</span><span class="sxs-lookup"><span data-stu-id="dccb1-173">A switch parameter is treated as `true` when it is specified in a command.</span></span> <span data-ttu-id="dccb1-174">Windows PowerShell がするパラメーターの値を考慮する場合は、コマンドでは、パラメーターが含まれていない、`false`します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-174">If the parameter is not included in a command, Windows PowerShell considers the value of the parameter to be `false`.</span></span> <span data-ttu-id="dccb1-175">ブール型のパラメーターを定義してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-175">Do not define Boolean parameters.</span></span>

<span data-ttu-id="dccb1-176">パラメーターは、3 つの値を区別する必要がある場合: $true、$false、および「未指定」は、null 許容型のパラメーターを定義し、\<bool >。</span><span class="sxs-lookup"><span data-stu-id="dccb1-176">If your parameter needs to differentiate between 3 values: $true, $false and "unspecified", then define a parameter of type Nullable\<bool>.</span></span>  <span data-ttu-id="dccb1-177">サードの必要性、「未指定」値には通常、コマンドレットがオブジェクトのブール型プロパティを変更とが発生します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-177">The need for a 3rd, "unspecified" value typically occurs when the cmdlet can modify a Boolean property of an object.</span></span> <span data-ttu-id="dccb1-178">ここでは「未指定」ことを意味しないプロパティの現在の値を変更します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-178">In this case "unspecified" means to not change the current value of the property.</span></span>

#### <a name="support-arrays-for-parameters"></a><span data-ttu-id="dccb1-179">パラメーターの配列をサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-179">Support Arrays for Parameters</span></span>

<span data-ttu-id="dccb1-180">多くの場合、ユーザーは、複数の引数に対して同じ操作を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-180">Frequently, users must perform the same operation against multiple arguments.</span></span> <span data-ttu-id="dccb1-181">コマンドレットは、これらのユーザーのユーザーは、Windows PowerShell 変数としてパラメーターに引数を渡すことができますので、入力パラメーターとして配列を受け入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-181">For these users, a cmdlet should accept an array as parameter input so that a user can pass the arguments into the parameter as a Windows PowerShell variable.</span></span> <span data-ttu-id="dccb1-182">たとえば、 [Get-process](/powershell/module/Microsoft.PowerShell.Management/Get-Process)コマンドレットは、取得するプロセスの名前を識別する文字列の配列を使用します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-182">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet uses an array for the strings that identify the names of the processes to retrieve.</span></span>

#### <a name="support-the-passthru-parameter"></a><span data-ttu-id="dccb1-183">PassThru パラメーターをサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-183">Support the PassThru Parameter</span></span>

<span data-ttu-id="dccb1-184">既定では、多くのコマンドレットを変更する、システムなど、 [Stop-process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process)コマンドレットがオブジェクトの"sinks"として機能し、結果は返されません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-184">By default, many cmdlets that modify the system, such as the [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, act as "sinks" for objects and do not return a result.</span></span> <span data-ttu-id="dccb1-185">これらのコマンドレットを実装する必要があります、`PassThru`させるオブジェクトを取得するコマンドレットのパラメーター。</span><span class="sxs-lookup"><span data-stu-id="dccb1-185">These cmdlet should implement the `PassThru` parameter to force the cmdlet to return an object.</span></span> <span data-ttu-id="dccb1-186">ときに、`PassThru`パラメーターを指定すると、コマンドレットの呼び出しを使用してオブジェクトを返します、 [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject)メソッド。</span><span class="sxs-lookup"><span data-stu-id="dccb1-186">When the `PassThru` parameter is specified, the cmdlet returns an object by using a call to the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="dccb1-187">たとえば、次のコマンドは、Calc プロセスが停止し、パイプラインに結果のプロセスを渡します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-187">For example, the following command stops the Calc process and passes the resultant process to the pipeline.</span></span>

```powershell
Stop-Process calc -passthru
```

<span data-ttu-id="dccb1-188">ほとんどの場合、追加、セット、および新規のコマンドレットをサポートする必要があります、`PassThru`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="dccb1-188">In most cases, Add, Set, and New cmdlets should support a `PassThru` parameter.</span></span>

#### <a name="support-parameter-sets"></a><span data-ttu-id="dccb1-189">パラメーター セットをサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-189">Support Parameter Sets</span></span>

<span data-ttu-id="dccb1-190">コマンドレットは、1 つの目的を実現するものです。</span><span class="sxs-lookup"><span data-stu-id="dccb1-190">A cmdlet is intended to accomplish a single purpose.</span></span> <span data-ttu-id="dccb1-191">ただし、操作または操作の対象を記述するは、複数の方法は頻繁に。</span><span class="sxs-lookup"><span data-stu-id="dccb1-191">However, there is frequently more than one way to describe the operation or the operation target.</span></span> <span data-ttu-id="dccb1-192">たとえばの名前、識別子またはプロセス オブジェクト、プロセスが特定されます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-192">For example, a process might be identified by its name, by its identifier, or by a process object.</span></span> <span data-ttu-id="dccb1-193">コマンドレットは、ターゲットの適切な表現は、すべてをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-193">The cmdlet should support all the reasonable representations of its targets.</span></span> <span data-ttu-id="dccb1-194">通常、コマンドレットは、(パラメーターのセットと呼ばれます) で同時に動作するパラメーターのセットを指定することによってこの要件を満たします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-194">Normally, the cmdlet satisfies this requirement by specifying sets of parameters (referred to as parameter sets) that operate together.</span></span> <span data-ttu-id="dccb1-195">1 つのパラメーターは、パラメーター セットの任意の数に属することができます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-195">A single parameter can belong to any number of parameter sets.</span></span> <span data-ttu-id="dccb1-196">パラメーター セットの詳細については、[コマンドレット パラメーター設定](./cmdlet-parameter-sets.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-196">For more information about parameter sets, see [Cmdlet Parameter Sets](./cmdlet-parameter-sets.md).</span></span>

<span data-ttu-id="dccb1-197">パラメーター セットを指定する場合は、ValueFromPipeline セットの 1 つだけのパラメーターを設定します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-197">When you specify parameter sets, set only one parameter in the set to ValueFromPipeline.</span></span> <span data-ttu-id="dccb1-198">宣言する方法について、**パラメーター**属性は、「 [ParameterAttribute 宣言](./parameter-attribute-declaration.md)します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-198">For more information about how to declare the **Parameter** attribute, see [ParameterAttribute Declaration](./parameter-attribute-declaration.md).</span></span>

<span data-ttu-id="dccb1-199">既定のパラメーター セットが定義されているパラメーターのセットを使用している場合、**コマンドレット**属性。</span><span class="sxs-lookup"><span data-stu-id="dccb1-199">When parameter sets are used, the default parameter set is defined by the **Cmdlet** attribute.</span></span> <span data-ttu-id="dccb1-200">既定のパラメーター セットは、対話型の Windows PowerShell セッションで使用される最も可能性の高いパラメーターを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-200">The default parameter set should include the parameters most likely to be used in an interactive Windows PowerShell session.</span></span> <span data-ttu-id="dccb1-201">宣言する方法について、**コマンドレット**属性は、「 [CmdletAttribute 宣言](./cmdlet-attribute-declaration.md)します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-201">For more information about how to declare the **Cmdlet** attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="provide-feedback-to-the-user-sd04"></a><span data-ttu-id="dccb1-202">(SD04) のユーザーにフィードバックを提供します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-202">Provide Feedback to the User (SD04)</span></span>

<span data-ttu-id="dccb1-203">このセクションのガイドラインを使用して、ユーザーにフィードバックを提供します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-203">Use the guidelines in this section to provide feedback to the user.</span></span> <span data-ttu-id="dccb1-204">このフィードバックによりより管理の決定を行うユーザーをシステムで発生している内容に注意してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-204">This feedback allows the user to be aware of what is occurring in the system and to make better administrative decisions.</span></span>

<span data-ttu-id="dccb1-205">Windows PowerShell ランタイムにより、ユーザーへの各呼び出しからの出力を処理する方法を指定する、`Write`ユーザー設定変数を設定することによって。</span><span class="sxs-lookup"><span data-stu-id="dccb1-205">The Windows PowerShell runtime allows a user to specify how to handle output from each call to the `Write` method by setting a preference variable.</span></span> <span data-ttu-id="dccb1-206">ユーザーは、情報と、システムがさらにアクションを実行する前に、ユーザーを照会する必要があるかどうかを決定する変数を表示するかどうかを決定する変数を含む、いくつかのユーザー設定変数を設定できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-206">The user can set several preference variables, including a variable that determines whether the system should display information and a variable that determines whether the system should query the user before taking further action.</span></span>

#### <a name="support-the-writewarning-writeverbose-and-writedebug-methods"></a><span data-ttu-id="dccb1-207">WriteWarning、WriteVerbose、WriteDebug メソッドをサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-207">Support the WriteWarning, WriteVerbose, and WriteDebug Methods</span></span>

<span data-ttu-id="dccb1-208">コマンドレットを呼び出す必要があります、 [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning)メソッドが、意図しない結果があります。 操作を実行しようとしています。</span><span class="sxs-lookup"><span data-stu-id="dccb1-208">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method when the cmdlet is about to perform an operation that might have an unintended result.</span></span> <span data-ttu-id="dccb1-209">たとえば、コマンドレットは、コマンドレットが読み取り専用ファイルを上書きする場合は、このメソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-209">For example, a cmdlet should call this method if the cmdlet is about to overwrite a read-only file.</span></span>

<span data-ttu-id="dccb1-210">コマンドレットを呼び出す必要があります、 [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose)メソッド、ユーザーは、コマンドレットの実行内容についていくつかの詳細を必要とする場合。</span><span class="sxs-lookup"><span data-stu-id="dccb1-210">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method when the user requires some detail about what the cmdlet is doing.</span></span> <span data-ttu-id="dccb1-211">たとえば、コマンドレットは、コマンドレットの作成者と、コマンドレットの実行内容の詳細が必要となるシナリオがあることを考えている場合、この情報を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-211">For example, a cmdlet should call this information if the cmdlet author feels that there are scenarios that might require more information about what the cmdlet is doing.</span></span>

<span data-ttu-id="dccb1-212">コマンドレットを呼び出す必要があります、 [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug)メソッドと、developer、または製品のサポート エンジニアがコマンドレットの操作が破損している内容を理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-212">The cmdlet should call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method when a developer or product support engineer must understand what has corrupted the cmdlet operation.</span></span> <span data-ttu-id="dccb1-213">必要でないコマンドレットを呼び出す、 [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug)メソッドを呼び出すのと同じコードで、 [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose)メソッド`Debug`パラメーター情報の両方のセットを表示します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-213">It is not necessary for the cmdlet to call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method in the same code that calls the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method because the `Debug` parameter presents both sets of information.</span></span>

#### <a name="support-writeprogress-for-operations-that-take-a-long-time"></a><span data-ttu-id="dccb1-214">WriteProgress を長い時間がかかる操作のサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-214">Support WriteProgress for Operations that take a Long Time</span></span>

<span data-ttu-id="dccb1-215">コマンドレットの操作を受け取ると完了に長時間をバック グラウンドで実行できませんに定期的な呼び出しを使用したレポートの進行状況をサポートする必要があります、 [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress)メソッド。</span><span class="sxs-lookup"><span data-stu-id="dccb1-215">Cmdlet operations that take a long time to complete and that cannot run in the background should support progress reporting through periodic calls to the [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

#### <a name="use-the-host-interfaces"></a><span data-ttu-id="dccb1-216">ホスト インターフェイスを使用して、</span><span class="sxs-lookup"><span data-stu-id="dccb1-216">Use the Host Interfaces</span></span>

<span data-ttu-id="dccb1-217">場合によっては、コマンドレットをする必要がありますと直接通信の代わりにユーザーを使用して、さまざまな書き込みまたはメソッドでサポートされている必要があります、 [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)クラス。</span><span class="sxs-lookup"><span data-stu-id="dccb1-217">Occasionally, a cmdlet must communicate directly with the user instead of by using the various Write or Should methods supported by the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="dccb1-218">この場合、コマンドレットがから派生する必要があります、 [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)クラスを使用して、 [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="dccb1-218">In this case, the cmdlet should derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class and use the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="dccb1-219">このプロパティは、通信の種類、PromptForChoice、プロンプト、および WriteLine/ReadLine 型などのさまざまなレベルをサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-219">This property supports different levels of communication type, including the PromptForChoice, Prompt, and WriteLine/ReadLine types.</span></span> <span data-ttu-id="dccb1-220">一番の特定のレベルもあり、個々 のキーを読み書きするバッファーを処理する方法。</span><span class="sxs-lookup"><span data-stu-id="dccb1-220">At the most specific level, it also provides ways to read and write individual keys and to deal with buffers.</span></span>

<span data-ttu-id="dccb1-221">コマンドレットは具体的にはグラフィカル ユーザー インターフェイス (GUI) を生成するように設計、しない限りを使用して、ホストを回避する必要がありますされませんが、 [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="dccb1-221">Unless a cmdlet is specifically designed to generate a graphical user interface (GUI), it should not bypass the host by using the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="dccb1-222">GUI を生成するように設計されたコマンドレットの例は、 [Out-gridview](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView)コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="dccb1-222">An example of a cmdlet that is designed to generate a GUI is the [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="dccb1-223">コマンドレットを使用する必要があります、 [System.Console](/dotnet/api/System.Console) API。</span><span class="sxs-lookup"><span data-stu-id="dccb1-223">Cmdlets should not use the [System.Console](/dotnet/api/System.Console) API.</span></span>

### <a name="create-a-cmdlet-help-file-sd05"></a><span data-ttu-id="dccb1-224">コマンドレットのヘルプ ファイル (SD05) の作成します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-224">Create a Cmdlet Help File (SD05)</span></span>

<span data-ttu-id="dccb1-225">各コマンドレット アセンブリのコマンドレットに関する情報を含む Help.xml ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-225">For each cmdlet assembly, create a Help.xml file that contains information about the cmdlet.</span></span> <span data-ttu-id="dccb1-226">この情報には、コマンドレット、コマンドレットのパラメーターの説明については、コマンドレットの使用、その他の例の説明が含まれています。</span><span class="sxs-lookup"><span data-stu-id="dccb1-226">This information includes a description of the cmdlet, descriptions of the cmdlet's parameters, examples of the cmdlet's use, and more.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="dccb1-227">コードのガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-227">Code Guidelines</span></span>

<span data-ttu-id="dccb1-228">間、コマンドレットとその他のコマンドレットを使用して一貫性のあるユーザー エクスペリエンスを実現するためのコマンドレットをコーディングする際、次のガイドラインに従ってください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-228">The following guidelines should be followed when coding cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="dccb1-229">自分の状況に適用されるコードのガイドラインを検索するときに必ずのようなガイドラインについては、デザイン ガイドラインを確認してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-229">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="coding-parameters-sc01"></a><span data-ttu-id="dccb1-230">パラメーター (SC01)</span><span class="sxs-lookup"><span data-stu-id="dccb1-230">Coding Parameters (SC01)</span></span>

<span data-ttu-id="dccb1-231">コマンドレット クラスのパブリック プロパティを宣言することで、パラメーターを定義、**パラメーター**属性。</span><span class="sxs-lookup"><span data-stu-id="dccb1-231">Define a parameter by declaring a public property of the cmdlet class that is decorated with the **Parameter** attribute.</span></span> <span data-ttu-id="dccb1-232">パラメーターは、コマンドレットの派生の .NET Framework クラスの静的メンバーではありません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-232">Parameters do not have to be static members of the derived .NET Framework class for the cmdlet.</span></span> <span data-ttu-id="dccb1-233">宣言する方法について、**パラメーター**属性は、「[パラメーター属性宣言](./parameter-attribute-declaration.md)します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-233">For more information about how to declare the **Parameter** attribute, see [Parameter Attribute Declaration](./parameter-attribute-declaration.md).</span></span>

#### <a name="support-windows-powershell-paths"></a><span data-ttu-id="dccb1-234">Windows PowerShell パスをサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-234">Support Windows PowerShell Paths</span></span>

<span data-ttu-id="dccb1-235">Windows PowerShell パスは、名前空間へのアクセスを正規化するための機構です。</span><span class="sxs-lookup"><span data-stu-id="dccb1-235">The Windows PowerShell path is the mechanism for normalizing access to namespaces.</span></span> <span data-ttu-id="dccb1-236">コマンドレットでパラメーターに、Windows PowerShell パスを割り当てた場合、ユーザーは、"drive"、特定のパスへのショートカットとして機能するカスタムを定義できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-236">When you assign a Windows PowerShell path to a parameter in the cmdlet, the user can define a custom "drive" that acts as a shortcut to a specific path.</span></span> <span data-ttu-id="dccb1-237">ユーザーがこのようなドライブを指定した場合、レジストリ内のデータなどの格納されたデータが一貫した方法で使用できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-237">When a user designates such a drive, stored data, such as data in the Registry, can be used in a consistent way.</span></span>

<span data-ttu-id="dccb1-238">型のパラメーターを定義する必要があります、コマンドレットは、ファイルまたはデータ ソースを指定するユーザーを許可している場合[System.String](/dotnet/api/System.String)します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-238">If your cmdlet allows the user to specify a file or a data source, it should define a parameter of type [System.String](/dotnet/api/System.String).</span></span> <span data-ttu-id="dccb1-239">1 つ以上のドライブがサポートされている場合、型が配列でなければなりません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-239">If more than one drive is supported, the type should be an array.</span></span> <span data-ttu-id="dccb1-240">パラメーターの名前にする必要があります`Path`、エイリアスを持つ`PSPath`します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-240">The name of the parameter should be `Path`, with an alias of `PSPath`.</span></span> <span data-ttu-id="dccb1-241">さらに、`Path`パラメーターは、ワイルドカード文字をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-241">Additionally, the `Path` parameter should support wildcard characters.</span></span> <span data-ttu-id="dccb1-242">場合のワイルドカード文字は必要ありませんのサポート、定義、`LiteralPath`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="dccb1-242">If support for wildcard characters is not required, define a `LiteralPath` parameter.</span></span>

<span data-ttu-id="dccb1-243">コマンドレットは、読み取りまたは書き込みをデータにファイルがある場合は、コマンドレットは、Windows PowerShell パスの入力を受け入れる必要があります、コマンドレットを使用する必要があります、 [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) Windows を変換するプロパティPowerShell パスにファイル システムが認識するパス。</span><span class="sxs-lookup"><span data-stu-id="dccb1-243">If the data that the cmdlet reads or writes has to be a file, the cmdlet should accept Windows PowerShell path input, and the cmdlet should use the [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) property to translate the Windows PowerShell paths into paths that the file system recognizes.</span></span> <span data-ttu-id="dccb1-244">特定のメカニズムには、次のメソッドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-244">The specific mechanisms include the following methods:</span></span>

- [<span data-ttu-id="dccb1-245">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="dccb1-245">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="dccb1-246">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="dccb1-246">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath)

- [<span data-ttu-id="dccb1-247">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="dccb1-247">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="dccb1-248">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="dccb1-248">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath)

<span data-ttu-id="dccb1-249">データを読み取りまたは書き込みが、コマンドレットは一連のファイルをコマンドレットではなく文字列プロバイダー コンテンツ情報を使用する必要があります (`Content`メンバー) 読み取りし、書き込みにします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-249">If the data that the cmdlet reads or writes is only a set of strings instead of a file, the cmdlet should use the provider content information (`Content` member) to read and write.</span></span> <span data-ttu-id="dccb1-250">この情報を得た、 [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="dccb1-250">This information is obtained from the [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) property.</span></span> <span data-ttu-id="dccb1-251">これらのメカニズムは、データの書き込みと読み取りに参加する他のデータ ストアを許可します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-251">These mechanisms allow other data stores to participate in the reading and writing of data.</span></span>

#### <a name="support-wildcard-characters"></a><span data-ttu-id="dccb1-252">ワイルドカード文字をサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-252">Support Wildcard Characters</span></span>

<span data-ttu-id="dccb1-253">コマンドレットでは、可能であればワイルドカード文字をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-253">A cmdlet should support wildcard characters if possible.</span></span> <span data-ttu-id="dccb1-254">ワイルドカード文字のサポートは、(特にパラメーターは、オブジェクトのセットから 1 つのオブジェクトを識別する文字列を受け取ります) 場合、コマンドレットの多くの場所で発生します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-254">Support for wildcard characters occurs in many places in a cmdlet (especially when a parameter takes a string to identify one object from a set of objects).</span></span> <span data-ttu-id="dccb1-255">サンプルではたとえば、**停止 Proc**からコマンドレット、 [StopProc チュートリアル](./stopproc-tutorial.md)定義、`Name`プロセス名を表す文字列を処理するパラメーター。</span><span class="sxs-lookup"><span data-stu-id="dccb1-255">For example, the sample **Stop-Proc** cmdlet from the [StopProc Tutorial](./stopproc-tutorial.md) defines a `Name` parameter to handle strings that represent process names.</span></span> <span data-ttu-id="dccb1-256">このパラメーターは、ワイルドカード文字をサポートするため、ユーザーが停止するプロセスを簡単に指定できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-256">This parameter supports wildcard characters so that the user can easily specify the processes to stop.</span></span>

<span data-ttu-id="dccb1-257">ワイルドカードのサポートの文字は使用可能なコマンドレットの操作には、通常は配列が生成されます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-257">When support for wildcard characters is available, a cmdlet operation usually produces an array.</span></span> <span data-ttu-id="dccb1-258">場合によっては、ユーザーは一度に 1 つの項目のみを使用する場合がありますので、配列をサポートするために意味は行いません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-258">Occasionally, it does not make sense to support an array because the user might use only a single item at a time.</span></span> <span data-ttu-id="dccb1-259">たとえば、 [Set-location](/powershell/module/Microsoft.PowerShell.Management/Set-Location)コマンドレットは、ユーザーが 1 つの場所のみを設定するために、配列をサポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-259">For example, the [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet does not need to support an array because the user is setting only a single location.</span></span> <span data-ttu-id="dccb1-260">このインスタンスでは、コマンドレットには、ワイルドカード文字を引き続きサポートされますが解像度を強制的に 1 つの場所にします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-260">In this instance, the cmdlet still supports wildcard characters, but it forces resolution to a single location.</span></span>

<span data-ttu-id="dccb1-261">ワイルドカード文字のパターンの詳細については、[コマンドレットのパラメーターにワイルドカード文字をサポートしている](./supporting-wildcard-characters-in-cmdlet-parameters.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dccb1-261">For more information about wildcard-character patterns, see [Supporting Wildcard Characters in Cmdlet Parameters](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span></span>

#### <a name="defining-objects"></a><span data-ttu-id="dccb1-262">オブジェクトを定義します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-262">Defining Objects</span></span>

<span data-ttu-id="dccb1-263">このセクションには、コマンドレットと、既存のオブジェクトを拡張するためのオブジェクトを定義するためのガイドラインが含まれています。</span><span class="sxs-lookup"><span data-stu-id="dccb1-263">This section contains guidelines for defining objects for cmdlets and for extending existing objects.</span></span>

##### <a name="define-standard-members"></a><span data-ttu-id="dccb1-264">標準のメンバーを定義します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-264">Define Standard Members</span></span>

<span data-ttu-id="dccb1-265">カスタムの Types.ps1xml ファイル (Windows PowerShell の Types.ps1xml ファイルのテンプレートとして使用) でオブジェクトの種類を拡張する標準のメンバーを定義します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-265">Define standard members to extend an object type in a custom Types.ps1xml file (use the Windows PowerShell Types.ps1xml file as a template).</span></span> <span data-ttu-id="dccb1-266">標準のメンバーは、PSStandardMembers という名前のノードによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-266">Standard members are defined by a node with the name PSStandardMembers.</span></span> <span data-ttu-id="dccb1-267">これらの定義は、他のコマンドレットと一貫した方法で、オブジェクトを使用する Windows PowerShell ランタイムを許可します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-267">These definitions allow other cmdlets and the Windows PowerShell runtime to work with your object in a consistent way.</span></span>

##### <a name="define-objectmembers-to-be-used-as-parameters"></a><span data-ttu-id="dccb1-268">パラメーターとして使用する ObjectMembers を定義します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-268">Define ObjectMembers to Be Used as Parameters</span></span>

<span data-ttu-id="dccb1-269">コマンドレットのオブジェクトを設計する場合は、そのメンバーがそれを使用するコマンドレットのパラメーターに直接マップするを確認します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-269">If you are designing an object for a cmdlet, ensure that its members map directly to the parameters of the cmdlets that will use it.</span></span> <span data-ttu-id="dccb1-270">このマッピングにより、パイプラインに簡単に送信して、別に 1 つのコマンドレットから渡されるオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="dccb1-270">This mapping allows the object to be easily sent to the pipeline and to be passed from one cmdlet to another.</span></span>

<span data-ttu-id="dccb1-271">コマンドレットによって返される既存の .NET Framework オブジェクトに、スクリプトの開発者やユーザーに必要ないくつかの重要なまたは便利なメンバーと頻繁がありません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-271">Preexisting .NET Framework objects that are returned by cmdlets are frequently missing some important or convenient members that are needed by the script developer or user.</span></span> <span data-ttu-id="dccb1-272">これらの欠落しているメンバーを表示して、オブジェクトをパイプラインに正しく渡すことができるように、適切なメンバー名を作成するために特に重要ですできます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-272">These missing members can be particularly important for display and for creating the correct member names so that the object can be correctly passed to the pipeline.</span></span> <span data-ttu-id="dccb1-273">これらの必要なメンバーを文書化するカスタムの Types.ps1xml ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-273">Create a custom Types.ps1xml file to document these required members.</span></span> <span data-ttu-id="dccb1-274">このファイルを作成するときに、次の名前付け規則お勧めします。 *< Your_Product_Name >* します。Types.ps1xml します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-274">When you create this file, we recommend the following naming convention: *<Your_Product_Name>*.Types.ps1xml.</span></span>

<span data-ttu-id="dccb1-275">たとえば、追加する、`Mode`スクリプト プロパティを[System.IO.FileInfo](/dotnet/api/System.IO.FileInfo)ファイルの属性をより明確に表示する型。</span><span class="sxs-lookup"><span data-stu-id="dccb1-275">For example, you could add a `Mode` script property to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) type to display the attributes of a file more clearly.</span></span> <span data-ttu-id="dccb1-276">さらに、追加でした、`Count`エイリアス プロパティを[System.Array](/dotnet/api/System.Array)一貫性のあるが、プロパティ名の使用を許可する型 (の代わりに`Length`)。</span><span class="sxs-lookup"><span data-stu-id="dccb1-276">Additionally, you could add a `Count` alias property to the [System.Array](/dotnet/api/System.Array) type to allow the consistent use of that property name (instead of `Length`).</span></span>

##### <a name="implement-the-icomparable-interface"></a><span data-ttu-id="dccb1-277">IComparable インターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-277">Implement the IComparable Interface</span></span>

<span data-ttu-id="dccb1-278">実装を[System.IComparable](/dotnet/api/System.IComparable)出力オブジェクトのすべてのインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="dccb1-278">Implement a [System.IComparable](/dotnet/api/System.IComparable) interface on all output objects.</span></span> <span data-ttu-id="dccb1-279">これにより、出力オブジェクトを簡単にさまざまな並べ替えと分析のコマンドレットにパイプ処理できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-279">This allows the output objects to be easily piped to various sorting and analysis cmdlets.</span></span>

##### <a name="update-display-information"></a><span data-ttu-id="dccb1-280">表示情報を更新します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-280">Update Display Information</span></span>

<span data-ttu-id="dccb1-281">オブジェクトの表示が期待どおりの結果を提供していない場合は、カスタムを作成 *\<YourProductName >* します。そのオブジェクトの Format.ps1xml ファイルです。</span><span class="sxs-lookup"><span data-stu-id="dccb1-281">If the display for an object does not provide the expected results, create a custom *\<YourProductName>*.Format.ps1xml file for that object.</span></span>

### <a name="support-well-defined-pipeline-input-sc02"></a><span data-ttu-id="dccb1-282">適切に定義されたパイプラインの入力 (SC02) のサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-282">Support Well Defined Pipeline Input (SC02)</span></span>

#### <a name="implement-for-the-middle-of-a-pipeline"></a><span data-ttu-id="dccb1-283">パイプラインの中間の実装</span><span class="sxs-lookup"><span data-stu-id="dccb1-283">Implement for the Middle of a Pipeline</span></span>

<span data-ttu-id="dccb1-284">パイプラインの中央から呼び出されますと仮定すると、コマンドレットを実装する (つまり、他のコマンドレットは、入力を生成またはその出力を使用)。</span><span class="sxs-lookup"><span data-stu-id="dccb1-284">Implement a cmdlet assuming that it will be called from the middle of a pipeline (that is, other cmdlets will produce its input or consume its output).</span></span> <span data-ttu-id="dccb1-285">たとえばと思うかもしれませんが、`Get-Process`コマンドレットは、データが生成されるため、パイプラインの最初のコマンドレットとしてのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-285">For example, you might assume that the `Get-Process` cmdlet, because it generates data, is used only as the first cmdlet in a pipeline.</span></span> <span data-ttu-id="dccb1-286">ただし、このコマンドレットは、パイプラインの中間に設計されている、ためこのコマンドレットを使用できます上記のコマンドレットまたはデータを取得するプロセスを指定するには、次のようにパイプラインします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-286">However, because this cmdlet is designed for the middle of a pipeline, this cmdlet allows previous cmdlets or data in the pipeline to specify the processes to retrieve.</span></span>

#### <a name="support-input-from-the-pipeline"></a><span data-ttu-id="dccb1-287">パイプラインからの入力をサポート</span><span class="sxs-lookup"><span data-stu-id="dccb1-287">Support Input from the Pipeline</span></span>

<span data-ttu-id="dccb1-288">各パラメーターでは、コマンドレットのセット、パイプラインから入力をサポートしている少なくとも 1 つのパラメーターが含まれます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-288">In each parameter set for a cmdlet, include at least one parameter that supports input from the pipeline.</span></span> <span data-ttu-id="dccb1-289">パイプラインの入力のサポートは、データまたは結果をコマンドレットに直接渡すと、適切なパラメーター セットに送信するためのオブジェクトを取得できます。</span><span class="sxs-lookup"><span data-stu-id="dccb1-289">Support for pipeline input allows the user to retrieve data or objects, to send them to the correct parameter set, and to pass the results directly to a cmdlet.</span></span>

<span data-ttu-id="dccb1-290">場合、パラメーターはパイプラインから入力を受け入れる、**パラメーター**属性が含まれています、 `ValueFromPipeline` 、キーワード、`ValueFromPipelineByPropertyName`キーワード属性、または両方のキーワードで宣言します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-290">A parameter accepts input from the pipeline if the **Parameter** attribute includes the `ValueFromPipeline` keyword, the `ValueFromPipelineByPropertyName` keyword attribute, or both keywords in its  declaration.</span></span> <span data-ttu-id="dccb1-291">サポートを設定、パラメーターでパラメーターがないかどうか、`ValueFromPipeline`または`ValueFromPipelineByPropertyName`パイプラインの入力は無視されるため、キーワード、コマンドレットを別のコマンドレットの後に配置明確ことはできません。</span><span class="sxs-lookup"><span data-stu-id="dccb1-291">If none of the parameters in a parameter set support the `ValueFromPipeline` or `ValueFromPipelineByPropertyName` keywords, the cmdlet cannot meaningfully be placed after another cmdlet because it will ignore any pipeline input.</span></span>

#### <a name="support-the-processrecord-method"></a><span data-ttu-id="dccb1-292">ProcessRecord メソッドをサポートします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-292">Support the ProcessRecord Method</span></span>

<span data-ttu-id="dccb1-293">コマンドレットを実装する必要があります、先頭のコマンドレットは、パイプライン内のすべてのレコードを受け入れるように、 [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)メソッド。</span><span class="sxs-lookup"><span data-stu-id="dccb1-293">To accept all the records from the preceding cmdlet in the pipeline, your cmdlet must implement the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method.</span></span> <span data-ttu-id="dccb1-294">Windows PowerShell メソッドを呼び出しますこの複数回、1 回、コマンドレットに送信されるすべてのレコード。</span><span class="sxs-lookup"><span data-stu-id="dccb1-294">Windows PowerShell calls this method multiple times, once for every record that is sent to your cmdlet.</span></span>

### <a name="write-single-records-to-the-pipeline-sc03"></a><span data-ttu-id="dccb1-295">パイプライン (SC03) に 1 つのレコードを書き込む</span><span class="sxs-lookup"><span data-stu-id="dccb1-295">Write Single Records to the Pipeline (SC03)</span></span>

<span data-ttu-id="dccb1-296">コマンドレットがオブジェクトを書き込む必要があります、コマンドレットには、オブジェクトが返される、ときに生成されるとすぐにします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-296">When a cmdlet returns objects, the cmdlet should write the objects immediately as they are generated.</span></span> <span data-ttu-id="dccb1-297">結合した配列にバッファーに格納するためにそのコマンドレットに保持しないようにします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-297">The cmdlet should not hold them in order to buffer them into a combined array.</span></span> <span data-ttu-id="dccb1-298">オブジェクトを入力として受け取るコマンドレットは、処理、表示、または処理および遅延なしの出力オブジェクトを表示することになります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-298">The cmdlets that receive the objects as input will then be able to process, display, or process and display the output objects without delay.</span></span> <span data-ttu-id="dccb1-299">出力を生成するコマンドレットはオブジェクト 1 つずつ呼び出す必要があります、 [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject)メソッド。</span><span class="sxs-lookup"><span data-stu-id="dccb1-299">A cmdlet that generates output objects one at a time should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="dccb1-300">(たとえば、基になる API では、出力オブジェクトの配列を返します) ために、バッチ処理で出力オブジェクトを生成するコマンドレットを呼び出す必要があります、 [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) 2 番目のパラメーターを持つメソッドの設定`true`します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-300">A cmdlet that generates output objects in batches (for example, because an underlying API returns an array of output objects) should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) Method with its second parameter set to `true`.</span></span>

### <a name="make-cmdlets-case-insensitive-and-case-preserving-sc04"></a><span data-ttu-id="dccb1-301">コマンドレットを大文字と小文字が区別 (SC04)</span><span class="sxs-lookup"><span data-stu-id="dccb1-301">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>

<span data-ttu-id="dccb1-302">既定では、Windows PowerShell 自体は大文字にします。</span><span class="sxs-lookup"><span data-stu-id="dccb1-302">By default, Windows PowerShell itself is case-insensitive.</span></span> <span data-ttu-id="dccb1-303">ただし、多くの既存のシステムで処理しているため Windows PowerShell は容易にするための操作と互換性の大文字と小文字を保持します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-303">However, because it deals with many preexisting systems, Windows PowerShell does preserve case for ease of operation and compatibility.</span></span> <span data-ttu-id="dccb1-304">つまり、文字は、大文字で指定した場合は、Windows PowerShell では、大文字。</span><span class="sxs-lookup"><span data-stu-id="dccb1-304">In other words, if a character is supplied in uppercase letters, Windows PowerShell keeps it in uppercase letters.</span></span> <span data-ttu-id="dccb1-305">うまく動作するためのシステムでは、コマンドレットはこの規則に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-305">For systems to work well, a cmdlet needs to follow this convention.</span></span> <span data-ttu-id="dccb1-306">可能であれば、大文字小文字を区別でが動作する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dccb1-306">If possible, it should operate in a case-insensitive way.</span></span> <span data-ttu-id="dccb1-307">コマンドレットまたはコマンドの後半に、パイプラインで発生するは、元の大文字を保存し、する必要があります。 ただし、します。</span><span class="sxs-lookup"><span data-stu-id="dccb1-307">It should, however, preserve the original case for cmdlets that occur later in a command or in the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="dccb1-308">参照</span><span class="sxs-lookup"><span data-stu-id="dccb1-308">See Also</span></span>

[<span data-ttu-id="dccb1-309">必要な開発のガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-309">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="dccb1-310">アドバイザリ開発のガイドライン</span><span class="sxs-lookup"><span data-stu-id="dccb1-310">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="dccb1-311">Windows PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="dccb1-311">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
