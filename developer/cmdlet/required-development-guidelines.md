---
title: 開発のガイドラインに必要な |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: 3f6bcd2e4ef4d9c404b3a5deeaa9f25d3fa42ec1
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/16/2019
ms.locfileid: "58056517"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="624b5-102">必要な開発ガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-102">Required Development Guidelines</span></span>

<span data-ttu-id="624b5-103">次のガイドラインは、コマンドレットを記述するときに従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="624b5-104">コマンドレットとコマンドレット コードの記述に関するガイドラインを設計するためのガイドラインに区切られます。</span><span class="sxs-lookup"><span data-stu-id="624b5-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="624b5-105">次のガイドラインに従わない場合、コマンドレットは失敗する可能性し、コマンドレットを使用するときに、ユーザーがエクスペリエンスの低下を必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="624b5-106">このトピックの内容</span><span class="sxs-lookup"><span data-stu-id="624b5-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="624b5-107">デザイン ガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-107">Design Guidelines</span></span>

- [<span data-ttu-id="624b5-108">承認された動詞 (RD01) のみを使用</span><span class="sxs-lookup"><span data-stu-id="624b5-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="624b5-109">コマンドレット名:使用できない文字 (RD02)</span><span class="sxs-lookup"><span data-stu-id="624b5-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="624b5-110">使用できないパラメーター名 (RD03)</span><span class="sxs-lookup"><span data-stu-id="624b5-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="624b5-111">確認要求 (RD04) をサポートします。</span><span class="sxs-lookup"><span data-stu-id="624b5-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="624b5-112">Force パラメーターを対話型セッション (RD05) のサポートします。</span><span class="sxs-lookup"><span data-stu-id="624b5-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="624b5-113">ドキュメント出力オブジェクト (RD06)</span><span class="sxs-lookup"><span data-stu-id="624b5-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="624b5-114">コードのガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-114">Code Guidelines</span></span>

- [<span data-ttu-id="624b5-115">コマンドレットまたは PSCmdlet クラス (RC01) から派生します。</span><span class="sxs-lookup"><span data-stu-id="624b5-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="624b5-116">コマンドレット属性 (RC02) を指定します。</span><span class="sxs-lookup"><span data-stu-id="624b5-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="624b5-117">処理方法 (RC03) の入力をオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="624b5-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="624b5-118">OutputType 属性 (RC04) を指定します。</span><span class="sxs-lookup"><span data-stu-id="624b5-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="624b5-119">出力オブジェクト (RC05) へのハンドルを保持していません。</span><span class="sxs-lookup"><span data-stu-id="624b5-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="624b5-120">エラーを確実に処理 (RC06)</span><span class="sxs-lookup"><span data-stu-id="624b5-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="624b5-121">Windows PowerShell モジュールを使用して、コマンドレット (RC07) をデプロイするには</span><span class="sxs-lookup"><span data-stu-id="624b5-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="624b5-122">デザイン ガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-122">Design Guidelines</span></span>

<span data-ttu-id="624b5-123">次のガイドラインは、コマンドレットとその他のコマンドレットを使用しての間で一貫性のあるユーザー エクスペリエンスを実現するためのコマンドレットを設計するときに従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="624b5-124">自分の状況に適用されるデザインのガイドラインを検索するときに必ずのようなガイドラインについては、コードのガイドラインを確認してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="624b5-125">承認された動詞 (RD01) のみを使用</span><span class="sxs-lookup"><span data-stu-id="624b5-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="624b5-126">Windows PowerShell によって提供される動詞の認識されたセットからコマンドレット属性で指定された動詞があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="624b5-127">禁止されている類義語の 1 つできません。</span><span class="sxs-lookup"><span data-stu-id="624b5-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="624b5-128">次のコマンドレットの動詞を指定する列挙型によって定義されている定数の文字列を使用します。</span><span class="sxs-lookup"><span data-stu-id="624b5-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="624b5-129">System.Management.Automation.VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="624b5-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="624b5-130">System.Management.Automation.VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="624b5-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="624b5-131">System.Management.Automation.VerbsData</span><span class="sxs-lookup"><span data-stu-id="624b5-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="624b5-132">System.Management.Automation.VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="624b5-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="624b5-133">System.Management.Automation.VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="624b5-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="624b5-134">System.Management.Automation.VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="624b5-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="624b5-135">System.Management.Automation.VerbsOther</span><span class="sxs-lookup"><span data-stu-id="624b5-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="624b5-136">承認された動詞名の詳細については、[コマンドレット動詞](./approved-verbs-for-windows-powershell-commands.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="624b5-137">ユーザーには、検出し、必要なコマンドレット名のセットが必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="624b5-138">ユーザーが迅速に評価のコマンドレットの処理と、システムの機能を簡単に検出できるように、適切な動詞を使用します。</span><span class="sxs-lookup"><span data-stu-id="624b5-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="624b5-139">名前が"start"で始まるシステムなど、次のコマンド ライン コマンドがすべてのコマンドの一覧を取得します。`get-command start-*`します。</span><span class="sxs-lookup"><span data-stu-id="624b5-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="624b5-140">他のコマンドレットから、コマンドレットを区別するために、コマンドレットの名詞を使用します。</span><span class="sxs-lookup"><span data-stu-id="624b5-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="624b5-141">名詞は、操作を実行するリソースを示します。</span><span class="sxs-lookup"><span data-stu-id="624b5-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="624b5-142">操作自体は、動詞によって表されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="624b5-143">コマンドレット名:使用できない文字 (RD02)</span><span class="sxs-lookup"><span data-stu-id="624b5-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="624b5-144">コマンドレットの名前、ときに使用しないでください、次の特殊文字のいずれか。</span><span class="sxs-lookup"><span data-stu-id="624b5-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="624b5-145">文字</span><span class="sxs-lookup"><span data-stu-id="624b5-145">Character</span></span>|<span data-ttu-id="624b5-146">名前</span><span class="sxs-lookup"><span data-stu-id="624b5-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="624b5-147">シャープ記号</span><span class="sxs-lookup"><span data-stu-id="624b5-147">number sign</span></span>|
|<span data-ttu-id="624b5-148">、</span><span class="sxs-lookup"><span data-stu-id="624b5-148">,</span></span>|<span data-ttu-id="624b5-149">コンマ</span><span class="sxs-lookup"><span data-stu-id="624b5-149">comma</span></span>|
|<span data-ttu-id="624b5-150">()</span><span class="sxs-lookup"><span data-stu-id="624b5-150">()</span></span>|<span data-ttu-id="624b5-151">かっこ</span><span class="sxs-lookup"><span data-stu-id="624b5-151">parentheses</span></span>|
|{}|<span data-ttu-id="624b5-152">中かっこ</span><span class="sxs-lookup"><span data-stu-id="624b5-152">braces</span></span>|
|<span data-ttu-id="624b5-153">[]</span><span class="sxs-lookup"><span data-stu-id="624b5-153">[]</span></span>|<span data-ttu-id="624b5-154">角かっこ</span><span class="sxs-lookup"><span data-stu-id="624b5-154">brackets</span></span>|
|&|<span data-ttu-id="624b5-155">アンパサンド</span><span class="sxs-lookup"><span data-stu-id="624b5-155">ampersand</span></span>|
|-|<span data-ttu-id="624b5-156">ハイフン**に注意してください。** 名詞、動詞を分離するハイフンを使用できますが、文字列、動詞または名詞内は使用できません。</span><span class="sxs-lookup"><span data-stu-id="624b5-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="624b5-157">スラッシュ マーク</span><span class="sxs-lookup"><span data-stu-id="624b5-157">slash mark</span></span>|
|<span data-ttu-id="624b5-158">\|円記号</span><span class="sxs-lookup"><span data-stu-id="624b5-158">\|backslash</span></span>|
|$|<span data-ttu-id="624b5-159">ドル記号</span><span class="sxs-lookup"><span data-stu-id="624b5-159">dollar sign</span></span>|
|^|<span data-ttu-id="624b5-160">キャレット</span><span class="sxs-lookup"><span data-stu-id="624b5-160">caret</span></span>|
|<span data-ttu-id="624b5-161">;</span><span class="sxs-lookup"><span data-stu-id="624b5-161">;</span></span>|<span data-ttu-id="624b5-162">セミコロン</span><span class="sxs-lookup"><span data-stu-id="624b5-162">semicolon</span></span>|
|<span data-ttu-id="624b5-163">:</span><span class="sxs-lookup"><span data-stu-id="624b5-163">:</span></span>|<span data-ttu-id="624b5-164">コロン</span><span class="sxs-lookup"><span data-stu-id="624b5-164">colon</span></span>|
|<span data-ttu-id="624b5-165">"</span><span class="sxs-lookup"><span data-stu-id="624b5-165">"</span></span>|<span data-ttu-id="624b5-166">二重引用符</span><span class="sxs-lookup"><span data-stu-id="624b5-166">double quotation mark</span></span>|
|<span data-ttu-id="624b5-167">'</span><span class="sxs-lookup"><span data-stu-id="624b5-167">'</span></span>|<span data-ttu-id="624b5-168">単一引用符</span><span class="sxs-lookup"><span data-stu-id="624b5-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="624b5-169">山かっこ</span><span class="sxs-lookup"><span data-stu-id="624b5-169">angle brackets</span></span>|
|<span data-ttu-id="624b5-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="624b5-170">&#124;</span></span>|<span data-ttu-id="624b5-171">垂直バー</span><span class="sxs-lookup"><span data-stu-id="624b5-171">vertical bar</span></span>|
|<span data-ttu-id="624b5-172">?</span><span class="sxs-lookup"><span data-stu-id="624b5-172">?</span></span>|<span data-ttu-id="624b5-173">疑問符 (?)</span><span class="sxs-lookup"><span data-stu-id="624b5-173">question mark</span></span>|
|@|<span data-ttu-id="624b5-174">アット マーク</span><span class="sxs-lookup"><span data-stu-id="624b5-174">at sign</span></span>|
|<span data-ttu-id="624b5-175">' | バック ティック (アクサン グラーブ)</span><span class="sxs-lookup"><span data-stu-id="624b5-175">\`|back tick (grave accent)</span></span>|
|*|<span data-ttu-id="624b5-176">アスタリスク</span><span class="sxs-lookup"><span data-stu-id="624b5-176">asterisk</span></span>|
|%|<span data-ttu-id="624b5-177">パーセント記号</span><span class="sxs-lookup"><span data-stu-id="624b5-177">percent sign</span></span>|
|+|<span data-ttu-id="624b5-178">プラス記号</span><span class="sxs-lookup"><span data-stu-id="624b5-178">plus sign</span></span>|
|=|<span data-ttu-id="624b5-179">等号</span><span class="sxs-lookup"><span data-stu-id="624b5-179">equals sign</span></span>|
|~|<span data-ttu-id="624b5-180">チルダ</span><span class="sxs-lookup"><span data-stu-id="624b5-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="624b5-181">使用できないパラメーター名 (RD03)</span><span class="sxs-lookup"><span data-stu-id="624b5-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="624b5-182">Windows PowerShell には、すべてのコマンドレットのパラメーターとは特定の状況で追加された追加のパラメーターの共通セットが提供されています。</span><span class="sxs-lookup"><span data-stu-id="624b5-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="624b5-183">独自のコマンドレットを設計するときに、次の名前を使用することはできません。確認、Debug、ErrorAction、ErrorVariable、OutVariable、OutBuffer、WarningAction、WarningVariable、WhatIf、UseTransaction と詳細な。</span><span class="sxs-lookup"><span data-stu-id="624b5-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="624b5-184">これらのパラメーターの詳細については、[パラメーターの共通名](./common-parameter-names.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="624b5-185">確認要求 (RD04) をサポートします。</span><span class="sxs-lookup"><span data-stu-id="624b5-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="624b5-186">システムを変更する操作を実行するコマンドレットを呼び出す必要がある、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) 、確認を要求し、特殊なケースで呼び出すメソッドを[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)メソッド。</span><span class="sxs-lookup"><span data-stu-id="624b5-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="624b5-187">(、 [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)メソッドは、後でのみ呼び出す必要があります、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)メソッドが呼び出されます)。</span><span class="sxs-lookup"><span data-stu-id="624b5-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="624b5-188">これらを呼び出すコマンドレットが設定して、確認要求をサポートしていることを指定する必要があります、`SupportsShouldProcess`コマンドレット属性のキーワード。</span><span class="sxs-lookup"><span data-stu-id="624b5-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="624b5-189">この属性を設定する方法についての詳細については、[コマンドレット属性宣言](./cmdlet-attribute-declaration.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="624b5-190">コマンドレット クラスのコマンドレットの属性は、コマンドレットの呼び出しをサポートしていることを示す場合、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)への呼び出しにメソッドをおよびコマンドレットが失敗した、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)メソッドでは、ユーザーが予期せず、システムを変更する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="624b5-191">使用して、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)システム変更のメソッド。</span><span class="sxs-lookup"><span data-stu-id="624b5-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="624b5-192">ユーザー設定と`WhatIf`パラメーター コントロール、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)メソッド。</span><span class="sxs-lookup"><span data-stu-id="624b5-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="624b5-193">これに対し、 [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)呼び出しは、危険性のある変更の追加チェックを実行します。</span><span class="sxs-lookup"><span data-stu-id="624b5-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="624b5-194">このメソッドは、任意のユーザー設定によって制御されていない、または`WhatIf`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="624b5-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="624b5-195">コマンドレットを呼び出す場合、 [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)が、メソッド、`Force`これら 2 つのメソッドへの呼び出しを省略して、操作を続行するパラメーター。</span><span class="sxs-lookup"><span data-stu-id="624b5-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="624b5-196">これは、機能は、非対話型のスクリプトとホストで使用するコマンドレットができるので重要です。</span><span class="sxs-lookup"><span data-stu-id="624b5-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="624b5-197">コマンドレットは、これらの呼び出しをサポート、ユーザーがかどうか、アクションを実行する必要があります実際に確認できます。</span><span class="sxs-lookup"><span data-stu-id="624b5-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="624b5-198">たとえば、 [Stop-process](/powershell/module/microsoft.powershell.management/stop-process)コマンドレットの呼び出し、 [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)メソッドの一連のシステムでは、Winlogon などの重要なプロセスを停止する前に、プロセス。</span><span class="sxs-lookup"><span data-stu-id="624b5-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="624b5-199">これらのメソッドのサポートに関する詳細については、[確認を要求する](./requesting-confirmation-from-cmdlets.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="624b5-200">Force パラメーターを対話型セッション (RD05) のサポートします。</span><span class="sxs-lookup"><span data-stu-id="624b5-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="624b5-201">コマンドレットを対話的に使用する場合常に強制するパラメーターを指定のプロンプトや入力の行の読み取りなど、対話型のアクションを上書きする)。</span><span class="sxs-lookup"><span data-stu-id="624b5-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="624b5-202">これは、機能は、非対話型のスクリプトとホストで使用するコマンドレットができるので重要です。</span><span class="sxs-lookup"><span data-stu-id="624b5-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="624b5-203">次のメソッドは、対話型のホストによって実装できます。</span><span class="sxs-lookup"><span data-stu-id="624b5-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="624b5-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span><span class="sxs-lookup"><span data-stu-id="624b5-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="624b5-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="624b5-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="624b5-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="624b5-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="624b5-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span><span class="sxs-lookup"><span data-stu-id="624b5-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="624b5-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span><span class="sxs-lookup"><span data-stu-id="624b5-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="624b5-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span><span class="sxs-lookup"><span data-stu-id="624b5-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="624b5-210">ドキュメント出力オブジェクト (RD06)</span><span class="sxs-lookup"><span data-stu-id="624b5-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="624b5-211">Windows PowerShell では、パイプラインに書き込まれるオブジェクトを使用します。</span><span class="sxs-lookup"><span data-stu-id="624b5-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="624b5-212">ユーザーの各コマンドレットによって返されるオブジェクトを利用するためには、返されるオブジェクトを文書化する必要があり、、返されるオブジェクトのメンバーの使用を文書化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="624b5-213">コードのガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-213">Code Guidelines</span></span>

<span data-ttu-id="624b5-214">コマンドレットのコードを記述する場合は、次のガイドラインを従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="624b5-215">自分の状況に適用されるコードのガイドラインを検索するときに必ずのようなガイドラインについては、デザイン ガイドラインを確認してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="624b5-216">コマンドレットまたは PSCmdlet クラス (RC01) から派生します。</span><span class="sxs-lookup"><span data-stu-id="624b5-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="624b5-217">コマンドレットは、いずれかから派生する必要があります、 [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)または[System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基本クラス。</span><span class="sxs-lookup"><span data-stu-id="624b5-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="624b5-218">派生したコマンドレット、 [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)クラスは、Windows PowerShell ランタイムに依存しません。</span><span class="sxs-lookup"><span data-stu-id="624b5-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="624b5-219">これらは、任意の Microsoft .NET Framework 言語から直接呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="624b5-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="624b5-220">派生したコマンドレット、 [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)クラスは、Windows PowerShell ランタイムに依存します。</span><span class="sxs-lookup"><span data-stu-id="624b5-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="624b5-221">そのため、実行空間内で実行されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="624b5-222">実装するすべてのコマンドレット クラスは、パブリック クラスである必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="624b5-223">これらのコマンドレット クラスの詳細については、[コマンドレットの概要](./cmdlet-overview.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="624b5-224">コマンドレット属性 (RC02) を指定します。</span><span class="sxs-lookup"><span data-stu-id="624b5-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="624b5-225">Windows PowerShell で認識されるコマンドレットのコマンドレットの属性を持つ、.NET Framework クラスを装飾する必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="624b5-226">この属性は、次のコマンドレットの機能を指定します。</span><span class="sxs-lookup"><span data-stu-id="624b5-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="624b5-227">コマンドレットを識別する動詞-名詞形式のペア。</span><span class="sxs-lookup"><span data-stu-id="624b5-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="624b5-228">複数のパラメーター セットが指定されたときに使用される既定のパラメーター セット。</span><span class="sxs-lookup"><span data-stu-id="624b5-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="624b5-229">既定のパラメーター セットは、Windows PowerShell がどのパラメーターのセットを使用するかを判断するのに十分な情報を持っていない場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="624b5-230">コマンドレットがへの呼び出しをサポートしているかを示す、 [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)メソッド。</span><span class="sxs-lookup"><span data-stu-id="624b5-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="624b5-231">このメソッドでは、コマンドレットは、システムに変更を加える前に、ユーザーに確認メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="624b5-232">確認要求が行われる方法の詳細については、[確認を要求する](./requesting-confirmation-from-cmdlets.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="624b5-233">確認メッセージに関連付けられているアクションの影響のレベル (または重大度) を示します。</span><span class="sxs-lookup"><span data-stu-id="624b5-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="624b5-234">ほとんどの場合、メディアの既定値を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="624b5-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="624b5-235">影響のレベルがユーザーに表示される確認要求に与える影響の詳細については、[確認を要求する](./requesting-confirmation-from-cmdlets.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="624b5-236">コマンドレットの属性を宣言する方法の詳細については、[CmdletAttribute 宣言](./cmdlet-attribute-declaration.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="624b5-237">処理方法 (RC03) の入力をオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="624b5-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="624b5-238">Windows PowerShell 環境に参加するコマンドレットのオーバーライドする必要あります、次の少なくとも 1 つ*入力処理メソッド*します。</span><span class="sxs-lookup"><span data-stu-id="624b5-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="624b5-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)メソッドは、1 回と前処理機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="624b5-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)メソッドは、複数回と、レコードの機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="624b5-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)メソッドは 1 つの時間と処理後の機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="624b5-242">OutputType 属性 (RC04) を指定します。</span><span class="sxs-lookup"><span data-stu-id="624b5-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="624b5-243">(Windows PowerShell 2.0 で導入) の OutputType 属性には、コマンドレットをパイプラインに返す .NET Framework 型を指定します。</span><span class="sxs-lookup"><span data-stu-id="624b5-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="624b5-244">コマンドレットの出力の種類を指定することでは、コマンドレットによって返される、やすく他のコマンドレットでオブジェクトをようにします。</span><span class="sxs-lookup"><span data-stu-id="624b5-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="624b5-245">この属性を使用して、コマンドレット クラスを修飾することの詳細については、[OutputType 属性宣言](./outputtype-attribute-declaration.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="624b5-246">出力オブジェクト (RC05) へのハンドルを保持していません。</span><span class="sxs-lookup"><span data-stu-id="624b5-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="624b5-247">コマンドレットに渡されるオブジェクトへのすべてのハンドルを保持する必要があります、 [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject)メソッド。</span><span class="sxs-lookup"><span data-stu-id="624b5-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="624b5-248">これらのオブジェクトがパイプラインでは、次のコマンドレットに渡されるまたはスクリプトで使用されます。</span><span class="sxs-lookup"><span data-stu-id="624b5-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="624b5-249">オブジェクトへのハンドルを保持する場合、2 つのエンティティは、各オブジェクトは、エラーが発生を所有します。</span><span class="sxs-lookup"><span data-stu-id="624b5-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="624b5-250">エラーを確実に処理 (RC06)</span><span class="sxs-lookup"><span data-stu-id="624b5-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="624b5-251">管理環境は本質的に検出し、重要な変更を管理しているシステムになります。</span><span class="sxs-lookup"><span data-stu-id="624b5-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="624b5-252">そのため、コマンドレットがエラーを正しく処理することが重要です。</span><span class="sxs-lookup"><span data-stu-id="624b5-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="624b5-253">エラー レコードの詳細については、[Windows PowerShell のエラー報告](./error-reporting-concepts.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="624b5-254">エラーは、コマンドレットが、複数のレコードを処理する続行できない、ときに、終了エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="624b5-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="624b5-255">コマンドレットを呼び出す必要があります、 [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)メソッドを参照する、 [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="624b5-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="624b5-256">コマンドレットによって、例外がキャッチされない場合、Windows PowerShell ランタイム自体は以下の情報を含む終了エラーをスローします。</span><span class="sxs-lookup"><span data-stu-id="624b5-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="624b5-257">コマンドレット (たとえば、a レコードの別のプロセスによって生成される)、パイプラインから読み込まれているレコードを呼び出す必要があります次の操作を停止しない未終了エラーを[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)メソッドを参照する、 [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="624b5-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="624b5-258">終了しないエラーの例は、特定のプロセスが停止に失敗した場合に発生するエラーです。</span><span class="sxs-lookup"><span data-stu-id="624b5-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="624b5-259">呼び出す、 [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)メソッドが一貫して要求されたアクションを実行して、失敗した特定のアクションの情報を保持するユーザーを使用します。</span><span class="sxs-lookup"><span data-stu-id="624b5-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="624b5-260">コマンドレットが処理されない各レコードできるだけ独立しています。</span><span class="sxs-lookup"><span data-stu-id="624b5-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="624b5-261">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)によって参照されるオブジェクト、 [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)と[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)メソッドには、基本的に、例外が必要です。</span><span class="sxs-lookup"><span data-stu-id="624b5-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="624b5-262">使用して例外を判断する場合は、.NET Framework デザイン ガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="624b5-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="624b5-263">エラーは、既存の例外と同じである意味場合、は、その例外を使用して、またはその例外から派生します。</span><span class="sxs-lookup"><span data-stu-id="624b5-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="624b5-264">それ以外の場合、新しい例外またはから直接例外階層を派生、 [System.Exception](/dotnet/api/System.Exception)型。</span><span class="sxs-lookup"><span data-stu-id="624b5-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="624b5-265">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)オブジェクトでは、ユーザーのエラーをグループ化するエラー カテゴリも必要です。</span><span class="sxs-lookup"><span data-stu-id="624b5-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="624b5-266">値を設定して、カテゴリに基づいてエラーを表示できます、 `$ErrorView` CategoryView にシェル変数。</span><span class="sxs-lookup"><span data-stu-id="624b5-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="624b5-267">可能なカテゴリが定義されている、 [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory)列挙体。</span><span class="sxs-lookup"><span data-stu-id="624b5-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="624b5-268">コマンドレットは、新しいスレッドを作成し、そのスレッドで実行されているコードがハンドルされない例外をスローした場合、Windows PowerShell は、エラーはキャッチできないと、プロセスが終了します。</span><span class="sxs-lookup"><span data-stu-id="624b5-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="624b5-269">オブジェクトには、未処理の例外が発生した、デストラクターでコードが含まれて、Windows PowerShell は、エラーはキャッチできないと、プロセスが終了します。</span><span class="sxs-lookup"><span data-stu-id="624b5-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="624b5-270">これは、オブジェクトが未処理の例外が発生する Dispose メソッドを呼び出す場合にも発生します。</span><span class="sxs-lookup"><span data-stu-id="624b5-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="624b5-271">Windows PowerShell モジュールを使用して、コマンドレット (RC07) をデプロイするには</span><span class="sxs-lookup"><span data-stu-id="624b5-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="624b5-272">Windows PowerShell モジュールをパッケージ化し、コマンドレットのデプロイを作成します。</span><span class="sxs-lookup"><span data-stu-id="624b5-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="624b5-273">モジュールのサポートは、Windows PowerShell 2.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="624b5-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="624b5-274">(これは非常に便利なコマンドレットをテストする場合)、バイナリ モジュール ファイルとして直接、コマンドレット クラスが含まれているアセンブリを使用することができますか、コマンドレットのアセンブリを参照するモジュール マニフェストを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="624b5-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="624b5-275">(追加することできますも既存のスナップイン アセンブリ モジュールを使用する場合。)モジュールの詳細については、[Windows PowerShell モジュールの記述](../module/writing-a-windows-powershell-module.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="624b5-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="624b5-276">参照</span><span class="sxs-lookup"><span data-stu-id="624b5-276">See Also</span></span>

[<span data-ttu-id="624b5-277">強くお勧めします開発のガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="624b5-278">アドバイザリ開発のガイドライン</span><span class="sxs-lookup"><span data-stu-id="624b5-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="624b5-279">Windows PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="624b5-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
