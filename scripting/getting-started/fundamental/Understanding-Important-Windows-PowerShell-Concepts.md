---
ms.date: 2017-06-05
keywords: "PowerShell, コマンドレット"
title: "Windows PowerShell の重要な概念を理解する"
ms.assetid: 3e601e38-4520-4578-a48d-b6779f1d35ee
ms.openlocfilehash: 1ffcfefcc7ffc7c98ba4d1e3ccc9a59cd9b0baac
ms.sourcegitcommit: 598b7835046577841aea2211d613bb8513271a8b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/08/2017
---
# <a name="understanding-important-windows-powershell-concepts"></a><span data-ttu-id="9bb8e-103">Windows PowerShell の重要な概念を理解する</span><span class="sxs-lookup"><span data-stu-id="9bb8e-103">Understanding Important Windows PowerShell Concepts</span></span>
<span data-ttu-id="9bb8e-104">Windows PowerShell の設計には、多数の異なる環境の概念が取り入れられています。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-104">The Windows PowerShell design integrates concepts from many different environments.</span></span> <span data-ttu-id="9bb8e-105">特定のシェルやプログラミング環境を使ったことのあるユーザーであれば、そのいくつかについては既に使い慣れているかもしれません。しかし、これらすべてに精通しているユーザーはごく一部に限られると思われます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-105">Several of them are familiar to people with experience in specific shells or programming environments, but very few people will know about all of them.</span></span> <span data-ttu-id="9bb8e-106">これらのいくつかの概念について理解することは、シェルの概要を把握するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-106">Looking at some of these concepts provides a useful overview of the shell.</span></span>

### <a name="commands-are-not-text-based"></a><span data-ttu-id="9bb8e-107">コマンドがテキストベースではない</span><span class="sxs-lookup"><span data-stu-id="9bb8e-107">Commands Are Not Text-Based</span></span>
<span data-ttu-id="9bb8e-108">従来のコマンドライン インターフェイス コマンドとは異なり、Windows PowerShell コマンドレットは、オブジェクトを処理するように設計されています。オブジェクトは、単に画面上に表示される文字列ではなく、構造化された情報です。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-108">Unlike traditional command-line interface commands, Windows PowerShell cmdlets are designed to deal with objects - structured information that is more than just a string of characters appearing on the screen.</span></span> <span data-ttu-id="9bb8e-109">コマンドの実行結果は常に補足的な情報を伴って出力され、この情報は必要に応じて使用できます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-109">Command output always carries along extra information that you can use if you need it.</span></span> <span data-ttu-id="9bb8e-110">この点については、このドキュメントで詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-110">We will discuss this topic in depth in this document.</span></span>

<span data-ttu-id="9bb8e-111">以前にテキスト処理ツールを使ってコマンドライン データを処理したことがあるなら、Windows PowerShell でこのツール使うと動作が異なることがわかります。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-111">If you have used text-processing tools to process command-line data in the past, you will find that they behave differently if you try to use them in Windows PowerShell.</span></span> <span data-ttu-id="9bb8e-112">ほとんどの場合、テキスト処理ツールを使用して特定の情報を抽出する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-112">In most cases, you do not need text-processing tools to extract specific information.</span></span> <span data-ttu-id="9bb8e-113">標準の Windows PowerShell オブジェクト操作コマンドを使って、データの一部に直接アクセスできます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-113">You can access portions of the data directly by using standard Windows PowerShell object manipulation commands.</span></span>

### <a name="the-command-family-is-extensible"></a><span data-ttu-id="9bb8e-114">拡張可能なコマンド ファミリ</span><span class="sxs-lookup"><span data-stu-id="9bb8e-114">The Command Family Is Extensible</span></span>
<span data-ttu-id="9bb8e-115">Cmd.exe などのインターフェイスには、組み込みのコマンド セットを直接拡張する手段が存在しません。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-115">Interfaces such as Cmd.exe do not provide a way for you to directly extend the built-in command set.</span></span> <span data-ttu-id="9bb8e-116">外部のコマンドライン ツールを作成して Cmd.exe で実行することはできますが、外部のツールには、ヘルプを統合することができないなど、サービス上の制約があります。また、Cmd.exe では、それらが正しいコマンドであるかどうかを自動的に判別することはできません。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-116">You can create external command-line tools that run in Cmd.exe, but these external tools do not have services, such as Help integration, and Cmd.exe does not automatically know that they are valid commands.</span></span>

<span data-ttu-id="9bb8e-117">Windows PowerShell のネイティブのバイナリ コマンドは*コマンドレット*と呼ばれ、ユーザーが自由に拡張できます。コマンドレットを独自に作成し、スナップインを使用して Windows PowerShell に追加できます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-117">The native binary commands in Windows PowerShell, known as *cmdlets* (pronounced command-lets), can be augmented by cmdlets that you create and that you add to Windows PowerShell by using snap-ins.</span></span> <span data-ttu-id="9bb8e-118">Windows PowerShell *スナップイン*は、他のインターフェイスのバイナリ ツールと同じようにコンパイルされています。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-118">Windows PowerShell *snap-ins* are compiled, just like binary tools in any other interface.</span></span> <span data-ttu-id="9bb8e-119">これらを使用することにより、新しいコマンドレットだけでなく、Windows PowerShell プロバイダーをシェルに追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-119">You can use them to add Windows PowerShell providers to the shell, as well as new cmdlets.</span></span>

<span data-ttu-id="9bb8e-120">Windows PowerShell の内部コマンドが*コマンドレット*と呼ばれているのは、こうした特殊な性質によるものです。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-120">Because of the special nature of the Windows PowerShell internal commands, we will refer to them as *cmdlets*.</span></span>

> [!NOTE]
> <span data-ttu-id="9bb8e-121">Windows PowerShell では、コマンドレット以外のコマンドも実行できます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-121">Windows PowerShell can run commands other than cmdlets.</span></span> <span data-ttu-id="9bb8e-122">この点については、『Windows PowerShell ユーザー ガイド』で詳しく取り上げていませんが、コマンドの種類として、そのようなカテゴリもあるということは覚えておいてください。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-122">We will not be discussing them in detail in the Windows PowerShell User's Guide, but they are useful to know about as categories of command types.</span></span> <span data-ttu-id="9bb8e-123">Windows PowerShell は、UNIX のシェル スクリプトや Cmd.exe のバッチ ファイルに似たスクリプト (ファイル名の拡張子は .ps1) をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-123">Windows PowerShell supports scripts that are analogous to UNIX shell scripts and Cmd.exe batch files, but have a .ps1 file name extension.</span></span> <span data-ttu-id="9bb8e-124">また、Windows PowerShell では、インターフェイスまたはスクリプトから直接使用することのできる内部関数を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-124">Windows PowerShell also allows you to create internal functions that can be used directly in the interface or in scripts.</span></span>

### <a name="windows-powershell-handles-console-input-and-display"></a><span data-ttu-id="9bb8e-125">Windows PowerShell によってコンソールの入力と表示が処理される</span><span class="sxs-lookup"><span data-stu-id="9bb8e-125">Windows PowerShell Handles Console Input and Display</span></span>
<span data-ttu-id="9bb8e-126">コマンドを入力すると、常に、コマンドラインの入力が Windows PowerShell によって直接処理されます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-126">When you type a command, Windows PowerShell always processes the command-line input directly.</span></span> <span data-ttu-id="9bb8e-127">また、出力は、ユーザーに対して表示する形式へと自動的に書式化されます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-127">Windows PowerShell also formats the output that you see on the screen.</span></span> <span data-ttu-id="9bb8e-128">各コマンドレットで必要となる作業が軽減され、どのコマンドレットの場合も常に同じ方法で使用できるようになるため、このことは重要です。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-128">This is significant because it reduces the work required of each cmdlet and ensures that you can always do things the same way regardless of which cmdlet you are using.</span></span> <span data-ttu-id="9bb8e-129">このことがツール開発者とユーザーの両方にもたらす利点の一例として、コマンドライン ヘルプが挙げられます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-129">One example of how this simplifies life for both tool developers and users is command-line Help.</span></span>

<span data-ttu-id="9bb8e-130">従来のコマンドライン ツールでは、ヘルプの要求と表示に独自の体系が採用されていました。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-130">Traditional command-line tools have their own schemes for requesting and displaying Help.</span></span> <span data-ttu-id="9bb8e-131">あるコマンドライン ツールは **/?** を使って</span><span class="sxs-lookup"><span data-stu-id="9bb8e-131">Some command-line tools use **/?**</span></span> <span data-ttu-id="9bb8e-132">ヘルプを表示し、他のコマンドライン ツールは **-?**、**/H**、**//** などを使っていました。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-132">to trigger the Help display; others use **-?**, **/H**, or even **//**.</span></span> <span data-ttu-id="9bb8e-133">ヘルプがコンソール画面に表示される代わりに、GUI のウィンドウに表示されるものもあります。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-133">Some will display Help in a GUI window, rather than in the console display.</span></span> <span data-ttu-id="9bb8e-134">アプリケーション更新ツールなど、複雑なツールになると、内部のファイルを展開してからヘルプを表示するものもあります。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-134">Some complex tools, such as application updaters, unpack internal files before displaying their Help.</span></span> <span data-ttu-id="9bb8e-135">間違ったパラメーターを使用すると、入力内容が無視され、タスクが自動的に実行される可能性もあります。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-135">If you use the wrong parameter, the tool might ignore what you typed and begin performing a task automatically.</span></span>

<span data-ttu-id="9bb8e-136">Windows PowerShell でコマンドを入力すると、入力したすべての情報に対し、解析と前処理が自動的に実行されます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-136">When you enter a command in Windows PowerShell, everything you enter is automatically parsed and pre-processed by Windows PowerShell.</span></span> <span data-ttu-id="9bb8e-137">**-?** を使用する場合</span><span class="sxs-lookup"><span data-stu-id="9bb8e-137">If you use the **-?**</span></span> <span data-ttu-id="9bb8e-138">パラメーターを Windows PowerShell コマンドレットで使用する場合は、常に "このコマンドのヘルプを表示する" という意味になります。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-138">parameter with a Windows PowerShell cmdlet, it always means "show me Help for this command".</span></span> <span data-ttu-id="9bb8e-139">コマンドレットの開発者は、ヘルプ テキストを用意するだけでよく、コマンドを解析するための処理を自ら実装する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-139">Cmdlet developers do not have to parse the command; they only need to provide the Help text.</span></span>

<span data-ttu-id="9bb8e-140">理解すべき大切な点は、Windows PowerShell のヘルプ機能は、従来のコマンドライン ツールを Windows PowerShell で実行する場合にも利用できるという点です。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-140">It is important to understand that the Help features of Windows PowerShell are available even when you run traditional command-line tools in Windows PowerShell.</span></span> <span data-ttu-id="9bb8e-141">Windows PowerShell は、パラメーターを処理し、結果を外部ツールに渡します。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-141">Windows PowerShell processes the parameters and passes the results to the external tools.</span></span>

> [!NOTE]
> <span data-ttu-id="9bb8e-142">Windows PowerShell でグラフィック アプリケーションを実行した場合は、そのアプリケーションのウィンドウが開きます。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-142">If you run an graphic application in Windows PowerShell, the window for the application opens.</span></span> <span data-ttu-id="9bb8e-143">Windows PowerShell が介在するのは、ユーザーによって指定されたコマンドライン入力を処理するときと、コンソール ウィンドウに返されたアプリケーション出力を処理するときだけです。アプリケーション内部の動作には影響しません。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-143">Windows PowerShell intervenes only when processing the command-line input you supply or the application output returned to the console window; it does not affect how the application works internally.</span></span>

### <a name="windows-powershell-uses-some-c-syntax"></a><span data-ttu-id="9bb8e-144">Windows PowerShell では C# の構文が一部使用される</span><span class="sxs-lookup"><span data-stu-id="9bb8e-144">Windows PowerShell Uses Some C# Syntax</span></span>
<span data-ttu-id="9bb8e-145">Windows PowerShell は .NET Framework をベースとしているため、Windows PowerShell の構文とキーワードは C# プログラミング言語に非常に似ています。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-145">Windows PowerShell has syntax features and keywords that are very similar to those used in the C# programming language, because Windows PowerShell is based on the .NET Framework.</span></span> <span data-ttu-id="9bb8e-146">C# 言語に興味がある方は、Windows PowerShell の使い方を覚えることにより、C# の習得にもつながります。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-146">Learning Windows PowerShell will make it much easier to learn C#, if you are interested in the language.</span></span>

<span data-ttu-id="9bb8e-147">C# プログラマではないユーザーにとって、この類似性は特に重要な意味を持ちません。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-147">If you are not a C# programmer, this similarity is not important.</span></span> <span data-ttu-id="9bb8e-148">しかし、C# に精通している場合は、この類似性のおかげで Windows PowerShell の使い方を覚えるのはとても簡単です。</span><span class="sxs-lookup"><span data-stu-id="9bb8e-148">However, if you are already familiar with C#, the similarities can make learning Windows PowerShell much easier.</span></span>

