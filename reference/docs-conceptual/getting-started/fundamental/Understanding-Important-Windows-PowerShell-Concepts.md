---
ms.date: 06/05/2017
keywords: PowerShell, コマンドレット
title: Windows PowerShell の重要な概念を理解する
ms.assetid: 3e601e38-4520-4578-a48d-b6779f1d35ee
ms.openlocfilehash: 07ceaa2f3e6a192c6281cb4c99aed4c3f66afc7e
ms.sourcegitcommit: cf195b090b3223fa4917206dfec7f0b603873cdf
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/09/2018
ms.locfileid: "30951088"
---
# <a name="understanding-important-windows-powershell-concepts"></a>Windows PowerShell の重要な概念を理解する
Windows PowerShell の設計には、多数の異なる環境の概念が取り入れられています。 特定のシェルやプログラミング環境を使ったことのあるユーザーであれば、そのいくつかについては既に使い慣れているかもしれません。しかし、これらすべてに精通しているユーザーはごく一部に限られると思われます。 これらのいくつかの概念について理解することは、シェルの概要を把握するのに役立ちます。

### <a name="commands-are-not-text-based"></a>コマンドがテキストベースではない
従来のコマンドライン インターフェイス コマンドとは異なり、Windows PowerShell コマンドレットは、オブジェクトを処理するように設計されています。オブジェクトは、単に画面上に表示される文字列ではなく、構造化された情報です。 コマンドの実行結果は常に補足的な情報を伴って出力され、この情報は必要に応じて使用できます。 この点については、このドキュメントで詳しく説明します。

以前にテキスト処理ツールを使ってコマンドライン データを処理したことがあるなら、Windows PowerShell でこのツール使うと動作が異なることがわかります。 ほとんどの場合、テキスト処理ツールを使用して特定の情報を抽出する必要はありません。 標準の Windows PowerShell オブジェクト操作コマンドを使って、データの一部に直接アクセスできます。

### <a name="the-command-family-is-extensible"></a>拡張可能なコマンド ファミリ
Cmd.exe などのインターフェイスには、組み込みのコマンド セットを直接拡張する手段が存在しません。 外部のコマンドライン ツールを作成して Cmd.exe で実行することはできますが、外部のツールには、ヘルプを統合することができないなど、サービス上の制約があります。また、Cmd.exe では、それらが正しいコマンドであるかどうかを自動的に判別することはできません。

Windows PowerShell のネイティブのバイナリ コマンドは*コマンドレット*と呼ばれ、ユーザーが自由に拡張できます。コマンドレットを独自に作成し、スナップインを使用して Windows PowerShell に追加できます。Windows PowerShell *スナップイン*は、他のインターフェイスのバイナリ ツールと同じようにコンパイルされています。 これらを使用することにより、新しいコマンドレットだけでなく、Windows PowerShell プロバイダーをシェルに追加することもできます。

Windows PowerShell の内部コマンドが*コマンドレット*と呼ばれているのは、こうした特殊な性質によるものです。

> [!NOTE]
> Windows PowerShell では、コマンドレット以外のコマンドも実行できます。 この点については、『Windows PowerShell ユーザー ガイド』で詳しく取り上げていませんが、コマンドの種類として、そのようなカテゴリもあるということは覚えておいてください。 Windows PowerShell は、UNIX のシェル スクリプトや Cmd.exe のバッチ ファイルに似たスクリプト (ファイル名の拡張子は .ps1) をサポートしています。 また、Windows PowerShell では、インターフェイスまたはスクリプトから直接使用することのできる内部関数を作成することもできます。

### <a name="windows-powershell-handles-console-input-and-display"></a>Windows PowerShell によってコンソールの入力と表示が処理される
コマンドを入力すると、常に、コマンドラインの入力が Windows PowerShell によって直接処理されます。 また、出力は、ユーザーに対して表示する形式へと自動的に書式化されます。 各コマンドレットで必要となる作業が軽減され、どのコマンドレットの場合も常に同じ方法で使用できるようになるため、このことは重要です。 このことがツール開発者とユーザーの両方にもたらす利点の一例として、コマンドライン ヘルプが挙げられます。

従来のコマンドライン ツールでは、ヘルプの要求と表示に独自の体系が採用されていました。 あるコマンドライン ツールは **/?** を使って ヘルプを表示し、他のコマンドライン ツールは **-?**、**/H**、**//** などを使っていました。 ヘルプがコンソール画面に表示される代わりに、GUI のウィンドウに表示されるものもあります。 アプリケーション更新ツールなど、複雑なツールになると、内部のファイルを展開してからヘルプを表示するものもあります。 間違ったパラメーターを使用すると、入力内容が無視され、タスクが自動的に実行される可能性もあります。

Windows PowerShell でコマンドを入力すると、入力したすべての情報に対し、解析と前処理が自動的に実行されます。 **-?** を使用する場合 パラメーターを Windows PowerShell コマンドレットで使用する場合は、常に "このコマンドのヘルプを表示する" という意味になります。 コマンドレットの開発者は、ヘルプ テキストを用意するだけでよく、コマンドを解析するための処理を自ら実装する必要はありません。

理解すべき大切な点は、Windows PowerShell のヘルプ機能は、従来のコマンドライン ツールを Windows PowerShell で実行する場合にも利用できるという点です。 Windows PowerShell は、パラメーターを処理し、結果を外部ツールに渡します。

> [!NOTE]
> Windows PowerShell でグラフィック アプリケーションを実行した場合は、そのアプリケーションのウィンドウが開きます。 Windows PowerShell が介在するのは、ユーザーによって指定されたコマンドライン入力を処理するときと、コンソール ウィンドウに返されたアプリケーション出力を処理するときだけです。アプリケーション内部の動作には影響しません。

### <a name="windows-powershell-uses-some-c-syntax"></a>Windows PowerShell では C# の構文が一部使用される
Windows PowerShell は .NET Framework をベースとしているため、Windows PowerShell の構文とキーワードは C# プログラミング言語に非常に似ています。 C# 言語に興味がある方は、Windows PowerShell の使い方を覚えることにより、C# の習得にもつながります。

C# プログラマではないユーザーにとって、この類似性は特に重要な意味を持ちません。 しかし、C# に精通している場合は、この類似性のおかげで Windows PowerShell の使い方を覚えるのはとても簡単です。