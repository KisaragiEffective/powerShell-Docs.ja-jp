---
ms.date: 08/23/2017
keywords: powershell,コマンドレット
title: Windows PowerShell Web Access のインストールと使用
ms.openlocfilehash: a3207c859c4b93b07d4c1b41d7df5269daa39a7d
ms.sourcegitcommit: 6545c60578f7745be015111052fd7769f8289296
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2020
ms.locfileid: "79402619"
---
# <a name="install-and-use-windows-powershell-web-access"></a><span data-ttu-id="d9d90-103">Windows PowerShell Web Access のインストールと使用</span><span class="sxs-lookup"><span data-stu-id="d9d90-103">Install and Use Windows PowerShell Web Access</span></span>

<span data-ttu-id="d9d90-104">更新: 2013 年 11 月 5 日 (編集: 2017 年 8 月 23 日)</span><span class="sxs-lookup"><span data-stu-id="d9d90-104">Updated: November 5, 2013 (Edited: August 23, 2017)</span></span>

<span data-ttu-id="d9d90-105">適用対象: Windows Server 2012 R2、Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="d9d90-105">Applies To: Windows Server 2012 R2, Windows Server 2012</span></span>

## <a name="introduction"></a><span data-ttu-id="d9d90-106">はじめに</span><span class="sxs-lookup"><span data-stu-id="d9d90-106">Introduction</span></span>

<span data-ttu-id="d9d90-107">Windows Server 2012 で初めて導入された Windows PowerShell Web Access は、Windows PowerShell ゲートウェイとして機能し、リモート コンピューターを対象とした Web ベースの Windows PowerShell コンソールを提供します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-107">Windows PowerShell Web Access, first introduced in Windows Server 2012, acts as a Windows PowerShell gateway, providing a web-based Windows PowerShell console that is targeted at a remote computer.</span></span> <span data-ttu-id="d9d90-108">これを使うと、IT 担当者は、クライアント デバイスで必要な Windows PowerShell、リモート管理ソフトウェア、またはブラウザー プラグインをインストールしなくても、Web ブラウザーの Windows PowerShell コンソールから Windows PowerShell コマンドおよびスクリプトを実行できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-108">It enables IT Pros to run Windows PowerShell commands and scripts from a Windows PowerShell console in a web browser, with no Windows PowerShell, remote management software, or browser plug-in installation necessary on the client device.</span></span> <span data-ttu-id="d9d90-109">Web ベースの Windows PowerShell コンソールを実行するのに必要なのは、適切に構成された Windows PowerShell Web Access ゲートウェイと、JavaScript をサポートし Cookie を有効にしたクライアント デバイス ブラウザーだけです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-109">All that is required to run the web-based Windows PowerShell console is a properly-configured Windows PowerShell Web Access gateway, and a client device browser that supports JavaScript and accepts cookies.</span></span>

<span data-ttu-id="d9d90-110">クライアント デバイスの例としては、ノート PC、仕事用ではないパーソナル コンピューター、貸与されたコンピューター、タブレット コンピューター、Web キオスク、Windows ベース以外のオペレーティング システムを実行しているコンピューター、および携帯電話のブラウザーなどがあります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-110">Examples of client devices include laptops, non-work personal computers, borrowed computers, tablet computers, web kiosks, computers that are not running a Windows-based operating system, and cell phone browsers.</span></span> <span data-ttu-id="d9d90-111">IT 担当者は、インターネットと Web ブラウザーにアクセスできるデバイスを使って、リモートの Windows ベース サーバーの重要な管理タスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-111">IT Pros can perform critical management tasks on remote Windows-based servers from devices that have access to an Internet connection and a web browser.</span></span>

<span data-ttu-id="d9d90-112">ゲートウェイを適切にセットアップおよび構成した後は、Web ブラウザーを使って Windows PowerShell コンソールにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-112">After successful gateway setup and configuration, users can access a Windows PowerShell console by using a web browser.</span></span> <span data-ttu-id="d9d90-113">セキュリティで保護された Windows PowerShell Web Access の Web サイトを開くと、認証成功後に Web ベースの Windows PowerShell コンソールを実行できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-113">When users open the secured Windows PowerShell Web Access website, they can run a web-based Windows PowerShell console after successful authentication.</span></span>

<span data-ttu-id="d9d90-114">Windows PowerShell Web Access のセットアップおよび構成プロセスは、次の 3 つの手順で構成されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-114">Windows PowerShell Web Access setup and configuration is a three-step process:</span></span>

1. [<span data-ttu-id="d9d90-115">Windows PowerShell Web Access をインストールする</span><span class="sxs-lookup"><span data-stu-id="d9d90-115">Install Windows PowerShell Web Access</span></span>](#install-windows-powershell-web-access-using-powershell-cmdlets)
1. [<span data-ttu-id="d9d90-116">ゲートウェイを構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-116">Configure the Gateway</span></span>](#configure-the-gateway)
1. [<span data-ttu-id="d9d90-117">制限的な承認規則を構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-117">Configure a restrictive authorization rule</span></span>](#configure-a-restrictive-authorization-rule)

<span data-ttu-id="d9d90-118">Windows PowerShell Web Access をインストールして構成する前に、このガイドをすべて読むことをお勧めします。このガイドでは、Windows PowerShell Web Access のインストール、セキュリティによる保護、およびアンインストールを行うための手順を説明しています。</span><span class="sxs-lookup"><span data-stu-id="d9d90-118">Before you install and configure Windows PowerShell Web Access, we recommend that you read this entire guide, which includes instructions about how to install, secure, and uninstall Windows PowerShell Web Access.</span></span> <span data-ttu-id="d9d90-119">「[Web ベースの Windows PowerShell コンソールの使用](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831417(v=ws.11))」トピックでは、Web ベースのコンソールにサインインする方法と、Web ベースの Windows PowerShell コンソールと **powershell.exe** コンソールの制限と相違点について説明しています。</span><span class="sxs-lookup"><span data-stu-id="d9d90-119">The [Use the Web-based Windows PowerShell Console](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831417(v=ws.11)) topic describes how users sign in to the web-based console, and covers limitations and differences between the web-based Windows PowerShell console and the **powershell.exe** console.</span></span> <span data-ttu-id="d9d90-120">Web ベースのコンソールのエンド ユーザーは「[Web ベースの Windows PowerShell コンソールの使用](use-the-web-based-windows-powershell-console.md)」をお読みください。このガイドをこれ以上読む必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-120">End users of the web-based console should read [Use the Web based Windows PowerShell Console](use-the-web-based-windows-powershell-console.md), but do not need to read the rest of this guide.</span></span>

<span data-ttu-id="d9d90-121">このトピックは IIS Web サーバーの操作に関する詳しいガイドを提供するものではありません。このトピックでは、Windows PowerShell Web Access ゲートウェイの構成に必要な手順だけを説明します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-121">This topic does not provide in-depth IIS Web Server operations guidance; only those steps required to configure the Windows PowerShell Web Access gateway are described in this topic.</span></span> <span data-ttu-id="d9d90-122">IIS での Web サイトの構成とセキュリティ保護については、「関連項目」セクションの IIS に関するドキュメント リソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-122">For more information about configuring and securing websites in IIS, see the IIS documentation resources in the See Also section.</span></span>

<span data-ttu-id="d9d90-123">次の図は、Windows PowerShell Web Access のしくみを示しています。</span><span class="sxs-lookup"><span data-stu-id="d9d90-123">The following diagram shows how Windows PowerShell Web Access works.</span></span>

![Windows PowerShell Web Access の図](media/install-and-use-windows-powershell-web-access/Windows-PowerShell-Web-Access-diagram.jpg)

## <a name="requirements-for-running-windows-powershell-web-access"></a><span data-ttu-id="d9d90-125">Windows PowerShell Web Access の実行に関する要件</span><span class="sxs-lookup"><span data-stu-id="d9d90-125">Requirements for running Windows PowerShell Web Access</span></span>

<span data-ttu-id="d9d90-126">Windows PowerShell Web Access を使用するには、ゲートウェイを実行するサーバーで Web サーバー (IIS)、.NET Framework 4.5、Windows PowerShell 3.0 または Windows PowerShell 4.0 が実行されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-126">Windows PowerShell Web Access requires Web Server (IIS), .NET Framework 4.5, and Windows PowerShell 3.0 or Windows PowerShell 4.0 to be running on the server on which you want to run the gateway.</span></span> <span data-ttu-id="d9d90-127">Windows PowerShell Web Access は、サーバー マネージャーの役割および機能の追加ウィザードを使用するか、サーバー マネージャーの Windows PowerShell のデプロイ コマンドレットを使用して、Windows Server 2012 R2 または Windows Server 2012 を実行中のサーバーにインストールできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-127">You can install Windows PowerShell Web Access on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either the Add Roles and Features Wizard in Server Manager, or Windows PowerShell deployment cmdlets for Server Manager.</span></span> <span data-ttu-id="d9d90-128">サーバー マネージャーまたはデプロイ コマンドレットを使って Windows PowerShell Web Access をインストールすると、インストール プロセスの一環として、必要な役割と機能が自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-128">When you install Windows PowerShell Web Access by using Server Manager or its deployment cmdlets, required roles and features are automatically added as part of the installation process.</span></span>

<span data-ttu-id="d9d90-129">Windows PowerShell Web Access により、リモート ユーザーは Web ブラウザーで Windows PowerShell を使って、組織内のコンピューターにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-129">Windows PowerShell Web Access allows remote users to access computers in your organization by using Windows PowerShell in a web browser.</span></span> <span data-ttu-id="d9d90-130">Windows PowerShell Web Access は便利で強力な管理ツールですが、Web ベースのアクセスを利用するとセキュリティ上のリスクが生じるため、できる限りセキュリティを確保して構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-130">Although Windows PowerShell Web Access is a convenient and powerful management tool, the web-based access poses security risks, and should be configured as securely as possible.</span></span> <span data-ttu-id="d9d90-131">Windows PowerShell Web Access ゲートウェイを構成する管理者は、利用可能なセキュリティ層を使うことをお勧めします。このセキュリティ層とは、Windows PowerShell Web Access に含まれるコマンドレット ベースの承認規則と、Web サーバー (IIS) およびサード パーティ アプリケーションで使うことができるセキュリティ層の両方です。</span><span class="sxs-lookup"><span data-stu-id="d9d90-131">We recommend that administrators who configure the Windows PowerShell Web Access gateway use available security layers, both the cmdlet-based authorization rules included with Windows PowerShell Web Access, and security layers that are available in Web Server (IIS) and third-party applications.</span></span> <span data-ttu-id="d9d90-132">このドキュメントには、テスト環境にのみ推奨される安全でない例と、セキュリティ保護された展開に推奨される例の両方が含まれています。</span><span class="sxs-lookup"><span data-stu-id="d9d90-132">This documentation includes both unsecure examples that are only recommended for test environments, as well as examples that are recommended for secure deployments.</span></span>

## <a name="browser-and-client-device-support"></a><span data-ttu-id="d9d90-133">ブラウザーとクライアント デバイスのサポート</span><span class="sxs-lookup"><span data-stu-id="d9d90-133">Browser and client device support</span></span>

<span data-ttu-id="d9d90-134">Windows PowerShell Web Access は次のインターネット ブラウザーをサポートします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-134">Windows PowerShell Web Access supports the following Internet browsers.</span></span> <span data-ttu-id="d9d90-135">モバイル ブラウザーは公式にはサポートされていませんが、それらの多くが Web ベースの Windows PowerShell コンソールを実行できるようです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-135">Although mobile browsers are not officially supported, many may be able to run the web-based Windows PowerShell console.</span></span>
<span data-ttu-id="d9d90-136">その他のブラウザーも、Cookie の許可、JavaScript の実行、および HTTPS Web サイトの実行に対応している場合は動作すると思われますが、公式にはテストされていません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-136">Other browsers that accept cookies, run JavaScript, and run HTTPS websites are expected to work, but are not officially tested.</span></span>

### <a name="supported-desktop-computer-browsers"></a><span data-ttu-id="d9d90-137">サポート対象のデスクトップ コンピューター ブラウザー</span><span class="sxs-lookup"><span data-stu-id="d9d90-137">Supported desktop computer browsers</span></span>

- <span data-ttu-id="d9d90-138">Microsoft Windows 8.0、9.0、10.0、11.0 の Windows Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="d9d90-138">Windows Internet Explorer for Microsoft Windows 8.0, 9.0, 10.0, and 11.0</span></span>
- <span data-ttu-id="d9d90-139">Mozilla Firefox 10.0.2</span><span class="sxs-lookup"><span data-stu-id="d9d90-139">Mozilla Firefox 10.0.2</span></span>
- <span data-ttu-id="d9d90-140">Google Chrome 17.0.963.56m for Windows</span><span class="sxs-lookup"><span data-stu-id="d9d90-140">Google Chrome 17.0.963.56m for Windows</span></span>
- <span data-ttu-id="d9d90-141">Apple Safari 5.1.2 for Windows</span><span class="sxs-lookup"><span data-stu-id="d9d90-141">Apple Safari 5.1.2 for Windows</span></span>
- <span data-ttu-id="d9d90-142">Apple Safari 5.1.2 for Mac OS</span><span class="sxs-lookup"><span data-stu-id="d9d90-142">Apple Safari 5.1.2 for Mac OS</span></span>

### <a name="minimally-tested-mobile-devices-or-browsers"></a><span data-ttu-id="d9d90-143">最低限のテストを実施済みのモバイル デバイスまたはブラウザー</span><span class="sxs-lookup"><span data-stu-id="d9d90-143">Minimally-tested mobile devices or browsers</span></span>

- <span data-ttu-id="d9d90-144">Windows Phone 7 および 7.5</span><span class="sxs-lookup"><span data-stu-id="d9d90-144">Windows Phone 7 and 7.5</span></span>
- <span data-ttu-id="d9d90-145">Google Android WebKit 3.1 Browser Android 2.2.1 (Kernel 2.6)</span><span class="sxs-lookup"><span data-stu-id="d9d90-145">Google Android WebKit 3.1 Browser Android 2.2.1 (Kernel 2.6)</span></span>
- <span data-ttu-id="d9d90-146">Apple Safari for iPhone operating system 5.0.1</span><span class="sxs-lookup"><span data-stu-id="d9d90-146">Apple Safari for iPhone operating system 5.0.1</span></span>
- <span data-ttu-id="d9d90-147">Apple Safari for iPad 2 operating system 5.0.1</span><span class="sxs-lookup"><span data-stu-id="d9d90-147">Apple Safari for iPad 2 operating system 5.0.1</span></span>

### <a name="browser-requirements"></a><span data-ttu-id="d9d90-148">ブラウザーの要件</span><span class="sxs-lookup"><span data-stu-id="d9d90-148">Browser requirements</span></span>

<span data-ttu-id="d9d90-149">Web ベースの Windows PowerShell コンソールを使うには、ブラウザーが次の操作を実行できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-149">To use the Windows PowerShell Web Access web-based console, browsers must do the following.</span></span>

- <span data-ttu-id="d9d90-150">Windows PowerShell Web Access ゲートウェイ Web サイトの Cookie を許可する。</span><span class="sxs-lookup"><span data-stu-id="d9d90-150">Allow cookies from the Windows PowerShell Web Access gateway website.</span></span>
- <span data-ttu-id="d9d90-151">HTTPS ページを開き、読み取る。</span><span class="sxs-lookup"><span data-stu-id="d9d90-151">Be able to open and read HTTPS pages.</span></span>
- <span data-ttu-id="d9d90-152">JavaScript を使う Web サイトを開き、実行する。</span><span class="sxs-lookup"><span data-stu-id="d9d90-152">Open and run websites that use JavaScript.</span></span>

## <a name="recommended-quick-deployment"></a><span data-ttu-id="d9d90-153">推奨されるクイック デプロイ</span><span class="sxs-lookup"><span data-stu-id="d9d90-153">Recommended quick deployment</span></span>

<span data-ttu-id="d9d90-154">Windows PowerShell Web Access ゲートウェイは、Windows PowerShell コマンドレットを使用するか、サーバー マネージャーから開く役割および機能の追加ウィザードを使用して、Windows Server 2012 R2 または Windows Server 2012 を実行中のサーバーにインストールできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-154">You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either Windows PowerShell cmdlets, or by using the Add Roles and Features Wizard that is opened from within Server Manager.</span></span> <span data-ttu-id="d9d90-155">クイック インストールと構成では、このセクションで説明する Windows PowerShell コマンドレットを使用します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-155">For quick installation and configuration, use Windows PowerShell cmdlets, as described in this section.</span></span>

1. [<span data-ttu-id="d9d90-156">Windows PowerShell Web Access をインストールする</span><span class="sxs-lookup"><span data-stu-id="d9d90-156">Install Windows PowerShell Web Access</span></span>](#install-windows-powershell-web-access-using-powershell-cmdlets)
1. [<span data-ttu-id="d9d90-157">ゲートウェイを構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-157">Configure the Gateway</span></span>](#configure-the-gateway)
1. [<span data-ttu-id="d9d90-158">制限的な承認規則を構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-158">Configure a restrictive authorization rule</span></span>](#configure-a-restrictive-authorization-rule)

### <a name="install-windows-powershell-web-access-using-powershell-cmdlets"></a><span data-ttu-id="d9d90-159">PowerShell コマンドレットを使用して Windows PowerShell Web Access をインストールする</span><span class="sxs-lookup"><span data-stu-id="d9d90-159">Install Windows PowerShell Web Access using PowerShell cmdlets</span></span>

#### <a name="to-install-windows-powershell-web-access-by-using-windows-powershell-cmdlets"></a><span data-ttu-id="d9d90-160">Windows PowerShell コマンドレットを使って Windows PowerShell Web Access をインストールするには</span><span class="sxs-lookup"><span data-stu-id="d9d90-160">To install Windows PowerShell Web Access by using Windows PowerShell cmdlets</span></span>

1. <span data-ttu-id="d9d90-161">次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-161">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="d9d90-162">Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、 **[管理者として実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-162">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
   - <span data-ttu-id="d9d90-163">Windows の**スタート**画面で、 **[Windows PowerShell]** を右クリックし、 **[管理者として実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-163">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

   > [!NOTE]
   > <span data-ttu-id="d9d90-164">Windows PowerShell 3.0 と 4.0 では、サーバー マネージャー コマンドレット モジュールに含まれるコマンドレットを実行する前に、そのモジュールを Windows PowerShell セッションにインポートする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-164">In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module.</span></span> <span data-ttu-id="d9d90-165">モジュールは、モジュールに含まれるコマンドレットを初めて実行するときに自動的にインポートされます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-165">A module is automatically imported the first time you run a cmdlet that is part of the module.</span></span>
   > <span data-ttu-id="d9d90-166">また、Windows PowerShell のコマンドレットでは、大文字と小文字は区別されません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-166">Also, Windows PowerShell cmdlets are not case-sensitive.</span></span>

1. <span data-ttu-id="d9d90-167">次のように入力して **Enter** キーを押します。*computer_name* は、Windows PowerShell Web Access をインストールするリモート コンピューターの名前です (必要な場合)。</span><span class="sxs-lookup"><span data-stu-id="d9d90-167">Type the following, and then press **Enter**, where *computer_name* represents a remote computer on which you want to install Windows PowerShell Web Access, if applicable.</span></span> <span data-ttu-id="d9d90-168">`-Restart` パラメーターによって、必要に応じて対象サーバーが自動的に再起動されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-168">The `-Restart` parameter automatically restarts destination servers if required.</span></span>

   `Install-WindowsFeature -Name WindowsPowerShellWebAccess -ComputerName <computer_name> -IncludeManagementTools -Restart`

   > [!NOTE]
   > <span data-ttu-id="d9d90-169">Windows PowerShell のコマンドレットを使って Windows PowerShell Web Access をインストールする場合、Web サーバー (IIS) の管理ツールは既定では追加されません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-169">Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default.</span></span> <span data-ttu-id="d9d90-170">Windows PowerShell Web Access ゲートウェイと同じサーバーに管理ツールをインストールする場合、`-IncludeManagementTools` パラメーターをインストール コマンドに追加します (この手順でも追加しています)。</span><span class="sxs-lookup"><span data-stu-id="d9d90-170">If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the `-IncludeManagementTools` parameter to the installation command (as provided in this step).</span></span> <span data-ttu-id="d9d90-171">Windows PowerShell Web Access の Web サイトをリモート コンピューターから管理する場合は、ゲートウェイの管理元となるコンピューターに [Remote Server Administration Tools for Windows 8.1](https://www.microsoft.com/en-us/download/details.aspx?id=39296) または [Remote Server Administration Tools for Windows 8](https://www.microsoft.com/en-us/download/details.aspx?id=28972) をインストールすることで、IIS マネージャー スナップインをインストールします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-171">If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing [Remote Server Administration Tools for Windows 8.1](https://www.microsoft.com/en-us/download/details.aspx?id=39296) or [Remote Server Administration Tools for Windows 8](https://www.microsoft.com/en-us/download/details.aspx?id=28972) on the computer from which you want to manage the gateway.</span></span>

   <span data-ttu-id="d9d90-172">オフライン VHD に役割や機能をインストールするには、`-ComputerName` パラメーターと `-VHD` パラメーターの両方を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-172">To install roles and features on an offline VHD, you must add both the `-ComputerName` parameter and the `-VHD` parameter.</span></span> <span data-ttu-id="d9d90-173">`-ComputerName` パラメーターには VHD のマウント先のサーバー名が格納され、`-VHD` パラメーターには指定したサーバー上の VHD ファイルへのパスが格納されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-173">The `-ComputerName` parameter contains the name of the server on which to mount the VHD, and the `-VHD` parameter contains the path to the VHD file on the specified server.</span></span>

   `Install-WindowsFeature -Name WindowsPowerShellWebAccess -VHD <path> -ComputerName <computer_name> -IncludeManagementTools -Restart`

1. <span data-ttu-id="d9d90-174">インストールが完了したら、対象サーバーに Windows PowerShell Web Access がインストールされたことを確認します。これには、管理者特権で開いた Windows PowerShell コンソールで、対象サーバーに対して `Get-WindowsFeature` コマンドレットを実行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-174">When installation is complete, verify that Windows PowerShell Web Access was installed on destination servers by running the `Get-WindowsFeature` cmdlet on a destination server, in a Windows PowerShell console that has been opened with elevated user rights.</span></span> <span data-ttu-id="d9d90-175">また、サーバー マネージャー コンソールに Windows PowerShell Web Access がインストールされたことも確認できます。これには、 **[すべてのサーバー]** ページで対象サーバーを選択し、選択したサーバーの **[役割と機能]** タイルを表示します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-175">You can also verify that Windows PowerShell Web Access was installed in the Server Manager console, by selecting a destination server on the **All Servers** page, and then viewing the **Roles and Features** tile for the selected server.</span></span> <span data-ttu-id="d9d90-176">Windows PowerShell Web Access の Readme ファイルも表示できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-176">You can also view the readme file for Windows PowerShell Web Access.</span></span>

1. <span data-ttu-id="d9d90-177">Windows PowerShell Web Access がインストールされると、基本的かつ必須のゲートウェイ セットアップ手順を記載した Readme ファイルの確認を求めるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-177">After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.</span></span> <span data-ttu-id="d9d90-178">これらのセットアップ手順は、次の「[ゲートウェイを構成する](#configure-the-gateway)」セクションでも説明します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-178">These setup instructions are also in the following section, [Configure the Gateway](#configure-the-gateway).</span></span> <span data-ttu-id="d9d90-179">Readme ファイルのパスは `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt` です。</span><span class="sxs-lookup"><span data-stu-id="d9d90-179">The path to the readme file is `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span></span>

### <a name="configure-the-gateway"></a><span data-ttu-id="d9d90-180">ゲートウェイを構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-180">Configure the Gateway</span></span>

<span data-ttu-id="d9d90-181">**Install-PswaWebApplication** コマンドレットを使うと Windows PowerShell Web Access を簡単に構成できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-181">The **Install-PswaWebApplication** cmdlet is a quick way to get Windows PowerShell Web Access configured.</span></span> <span data-ttu-id="d9d90-182">`UseTestCertificate` パラメーターを `Install-PswaWebApplication` コマンドレットに追加することで、テスト用の自己署名 SSL 証明書をインストールできますが、これは安全ではありません。運用環境のセキュリティ保護のため、常に証明機関 (CA) によって署名された有効な SSL 証明書を使用してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-182">Although you can add the `UseTestCertificate` parameter to the `Install-PswaWebApplication` cmdlet to install a self-signed SSL certificate for test purposes, this is not secure; for a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).</span></span> <span data-ttu-id="d9d90-183">管理者は IIS マネージャー コンソールを使ってテスト証明書を任意の署名済み証明書に置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-183">Administrators can replace the test certificate with a signed certificate of their choice by using the IIS Manager console.</span></span>

<span data-ttu-id="d9d90-184">Windows PowerShell Web Access の Web アプリケーションの構成を完了するには、`Install-PswaWebApplication` コマンドレットを実行するか、IIS マネージャーの GUI ベースの構成手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-184">You can complete Windows PowerShell Web Access web application configuration either by running the `Install-PswaWebApplication` cmdlet or by performing GUI-based configuration steps in IIS Manager.</span></span>
<span data-ttu-id="d9d90-185">既定では、コマンドレットによって **pswa** Web アプリケーション (および専用の **pswa_pool** というアプリケーション プール) が **[既定の Web サイト]** コンテナーにインストールされ、IIS マネージャーで確認できます。必要な場合、コマンドレットに指定して Web アプリケーションの既定のサイト コンテナーを変更できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-185">By default, the cmdlet installs the web application, **pswa** (and an application pool for it, **pswa_pool**), in the **Default Web Site** container, as shown in IIS Manager; if desired, you can instruct the cmdlet to change the default site container of the web application.</span></span> <span data-ttu-id="d9d90-186">IIS マネージャーは、ポート番号や Secure Sockets Layer (SSL) 証明書の変更など、Web アプリケーションで利用できる構成オプションを提供します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-186">IIS Manager offers configuration options that are available for web applications, such as changing the port number or the Secure Sockets Layer (SSL) certificate.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d9d90-187">管理者には、CA によって署名された有効な証明書を使うようゲートウェイを構成することを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-187">We strongly recommend that administrators configure the gateway to use a valid certificate that has been signed by a CA.</span></span>

#### <a name="to-configure-the-windows-powershell-web-access-gateway-with-a-test-certificate-by-using-install-pswawebapplication"></a><span data-ttu-id="d9d90-188">Install-PswaWebApplication を使って、テスト証明書を使う Windows PowerShell Web Access Web ゲートウェイを構成するには</span><span class="sxs-lookup"><span data-stu-id="d9d90-188">To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication</span></span>

1. <span data-ttu-id="d9d90-189">次のいずれかを実行して Windows PowerShell セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-189">Do one of the following to open a Windows PowerShell session.</span></span>

   - <span data-ttu-id="d9d90-190">Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-190">On the Windows desktop, right-click **Windows PowerShell** on the taskbar.</span></span>
   - <span data-ttu-id="d9d90-191">Windows の**スタート**画面で、 **[Windows PowerShell]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-191">On the Windows **Start** screen, click **Windows PowerShell**.</span></span>

2. <span data-ttu-id="d9d90-192">次のように入力して **Enter** キーを押します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-192">Type the following, and then press **Enter**.</span></span>

   `Install-PswaWebApplication -UseTestCertificate`

   > [!IMPORTANT]
   > <span data-ttu-id="d9d90-193">`UseTestCertificate` パラメーターは、プライベートなテスト環境でのみ使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-193">The `UseTestCertificate` parameter should only be used in a private test environment.</span></span> <span data-ttu-id="d9d90-194">運用環境のセキュリティ保護のため、CA によって署名された有効な証明書を使うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-194">For a secure production environment, we recommend using a valid certificate that has been signed by a CA.</span></span>

   <span data-ttu-id="d9d90-195">コマンドレットを実行すると、IIS の [既定の Web サイト] コンテナーに Windows PowerShell Web Access の Web アプリケーションがインストールされます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-195">Running the cmdlet installs the Windows PowerShell Web Access web application within the IIS Default Web Site container.</span></span> <span data-ttu-id="d9d90-196">このコマンドレットにより、既定の Web サイト (`https://<server_name>/pswa`) で Windows PowerShell Web Access を実行するために必要なインフラストラクチャが作成されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-196">The cmdlet creates the infrastructure required to run Windows PowerShell Web Access on the default website, `https://<server_name>/pswa`.</span></span> <span data-ttu-id="d9d90-197">Web アプリケーションを別の Web サイトにインストールするには、`WebSiteName` パラメーターを追加して Web サイトの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-197">To install the web application in a different website, provide the website name by adding the `WebSiteName` parameter.</span></span> <span data-ttu-id="d9d90-198">Web アプリケーションの名前 (既定値は `pswa`) を変更するには、`WebApplicationName` パラメーターを追加します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-198">To change the name of the web application (the default is `pswa`), add the `WebApplicationName` parameter.</span></span>

   <span data-ttu-id="d9d90-199">コマンドレットの実行により次の設定が構成されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-199">The following settings are configured by running the cmdlet.</span></span> <span data-ttu-id="d9d90-200">これらの設定は、必要に応じて IIS マネージャー コンソールで変更できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-200">You can change these manually in the IIS Manager console, if desired.</span></span>

   - <span data-ttu-id="d9d90-201">Path: /pswa</span><span class="sxs-lookup"><span data-stu-id="d9d90-201">Path: /pswa</span></span>
   - <span data-ttu-id="d9d90-202">ApplicationPool: pswa_pool</span><span class="sxs-lookup"><span data-stu-id="d9d90-202">ApplicationPool: pswa_pool</span></span>
   - <span data-ttu-id="d9d90-203">EnabledProtocols: http</span><span class="sxs-lookup"><span data-stu-id="d9d90-203">EnabledProtocols: http</span></span>
   - <span data-ttu-id="d9d90-204">PhysicalPath: %windir%/Web/PowerShellWebAccess/wwwroot</span><span class="sxs-lookup"><span data-stu-id="d9d90-204">PhysicalPath: %windir%/Web/PowerShellWebAccess/wwwroot</span></span>

   <span data-ttu-id="d9d90-205">**例**: `Install-PswaWebApplication -webApplicationName myWebApp -useTestCertificate`</span><span class="sxs-lookup"><span data-stu-id="d9d90-205">**Example**: `Install-PswaWebApplication -webApplicationName myWebApp -useTestCertificate`</span></span>

   <span data-ttu-id="d9d90-206">この例では、Windows PowerShell Web Access の最終的な Web サイトは `https://<server_name>/myWebApp` になります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-206">In this example, the resulting website for Windows PowerShell Web Access is `https://<server_name>/myWebApp`.</span></span>

   > [!NOTE]
   > <span data-ttu-id="d9d90-207">サインインできるのは、承認規則の追加によって Web サイトへのアクセスが許可されたユーザーだけです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-207">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="d9d90-208">詳細については、「[制限的な承認規則を構成する](#configure-a-restrictive-authorization-rule)」と「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-208">For more information, see [configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule) and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-configure-the-windows-powershell-web-access-gateway-with-a-genuine-certificate-by-using-install-pswawebapplication-and-iis-manager"></a><span data-ttu-id="d9d90-209">正規の証明書を持つ Windows PowerShell Web Access ゲートウェイを Install-PswaWebApplication と IIS Manager を使用して構成するには</span><span class="sxs-lookup"><span data-stu-id="d9d90-209">To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager</span></span>

1. <span data-ttu-id="d9d90-210">次のいずれかを実行して Windows PowerShell セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-210">Do one of the following to open a Windows PowerShell session.</span></span>

   - <span data-ttu-id="d9d90-211">Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-211">On the Windows desktop, right-click **Windows PowerShell** on the taskbar.</span></span>
   - <span data-ttu-id="d9d90-212">Windows の**スタート**画面で、 **[Windows PowerShell]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-212">On the Windows **Start** screen, click **Windows PowerShell**.</span></span>

2. <span data-ttu-id="d9d90-213">次のように入力して **Enter** キーを押します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-213">Type the following, and then press **Enter**.</span></span>

   `Install-PswaWebApplication`

   <span data-ttu-id="d9d90-214">コマンドレットの実行により次のゲートウェイ設定が構成されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-214">The following gateway settings are configured by running the cmdlet.</span></span> <span data-ttu-id="d9d90-215">これらの設定は、必要に応じて IIS マネージャー コンソールで変更できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-215">You can change these manually in the IIS Manager console, if desired.</span></span> <span data-ttu-id="d9d90-216">`WebsiteName` コマンドレットの `WebApplicationName` および `Install-PswaWebApplication` パラメーターの値を指定することも可能です。</span><span class="sxs-lookup"><span data-stu-id="d9d90-216">You can also specify values for the `WebsiteName` and `WebApplicationName` parameters of the `Install-PswaWebApplication` cmdlet.</span></span>

   - <span data-ttu-id="d9d90-217">Path: /pswa</span><span class="sxs-lookup"><span data-stu-id="d9d90-217">Path: /pswa</span></span>
   - <span data-ttu-id="d9d90-218">ApplicationPool: pswa_pool</span><span class="sxs-lookup"><span data-stu-id="d9d90-218">ApplicationPool: pswa_pool</span></span>
   - <span data-ttu-id="d9d90-219">EnabledProtocols: http</span><span class="sxs-lookup"><span data-stu-id="d9d90-219">EnabledProtocols: http</span></span>
   - <span data-ttu-id="d9d90-220">PhysicalPath: %windir%/Web/PowerShellWebAccess/wwwroot</span><span class="sxs-lookup"><span data-stu-id="d9d90-220">PhysicalPath: %windir%/Web/PowerShellWebAccess/wwwroot</span></span>

3. <span data-ttu-id="d9d90-221">次のいずれかの方法で IIS マネージャー コンソールを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-221">Open the IIS Manager console by doing one of the following.</span></span>

   - <span data-ttu-id="d9d90-222">Windows デスクトップで、Windows タスク バーの **[サーバー マネージャー]** をクリックし、サーバー マネージャーを開始します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-222">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="d9d90-223">[サーバー マネージャー] の **[ツール]** メニューで **[インターネット インフォメーション サービス (IIS) マネージャー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-223">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>
   - <span data-ttu-id="d9d90-224">Windows の**スタート**画面で、 **[サーバー マネージャー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-224">On the Windows **Start** screen, click **Server Manager**.</span></span>

4. <span data-ttu-id="d9d90-225">IIS マネージャーのツリー ウィンドウで、Windows PowerShell Web Access がインストールされているサーバーのノードを展開し、 **[サイト]** フォルダーを表示させます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-225">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="d9d90-226">**[サイト]** フォルダーを展開します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-226">Expand the **Sites** folder.</span></span>

5. <span data-ttu-id="d9d90-227">Windows PowerShell Web Access の Web アプリケーションをインストールした Web サイトを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-227">Select the website in which you have installed the Windows PowerShell Web Access web application.</span></span>
   <span data-ttu-id="d9d90-228">**[操作]** ウィンドウで、 **[バインド]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-228">In the **Actions** pane, click **Bindings**.</span></span>

6. <span data-ttu-id="d9d90-229">**[サイト バインド]** ダイアログ ボックスの **[追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-229">In the **Site Binding** dialog box, click **Add**.</span></span>

7. <span data-ttu-id="d9d90-230">**[サイト バインドの追加]** ダイアログ ボックスの **[種類]** フィールドで、 **[https]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-230">In the **Add Site Binding** dialog box, in the **Type** field, select **https**.</span></span>

8. <span data-ttu-id="d9d90-231">**"SSL 証明書"** フィールドのドロップダウン メニューから、署名済み証明書を選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-231">In the **SSL certificate** field, select your signed certificate from the drop-down menu.</span></span>
   <span data-ttu-id="d9d90-232">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-232">Click **OK**.</span></span> <span data-ttu-id="d9d90-233">証明書の取得方法の詳細については、このトピックの「[IIS マネージャーで SSL 証明書を構成するには](#to-configure-an-ssl-certificate-in-iis-manager)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-233">See [To configure an SSL certificate in IIS Manager](#to-configure-an-ssl-certificate-in-iis-manager) in this topic for more information about how to obtain a certificate.</span></span>

   <span data-ttu-id="d9d90-234">これで、Windows PowerShell Web Access の Web アプリケーションが署名済み SSL 証明書を使うよう構成されました。</span><span class="sxs-lookup"><span data-stu-id="d9d90-234">The Windows PowerShell Web Access web application is now configured to use your signed SSL certificate.</span></span>

   <span data-ttu-id="d9d90-235">ブラウザー ウィンドウで `https://<server_name>/pswa` を開くと Windows PowerShell Web Access にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-235">You can access Windows PowerShell Web Access by opening `https://<server_name>/pswa` in a browser window.</span></span>

   > [!NOTE]
   > <span data-ttu-id="d9d90-236">サインインできるのは、承認規則の追加によって Web サイトへのアクセスが許可されたユーザーだけです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-236">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="d9d90-237">詳細については、このトピックの「[制限的な承認規則を構成する](#configure-a-restrictive-authorization-rule)」と「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-237">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

### <a name="configure-a-restrictive-authorization-rule"></a><span data-ttu-id="d9d90-238">制限的な承認規則を構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-238">Configure a restrictive authorization rule</span></span>

<span data-ttu-id="d9d90-239">Windows PowerShell Web Access をインストールし、ゲートウェイを構成すると、ユーザーがブラウザーでサインイン ページを開けるようになります。ただし、Windows PowerShell Web Access 管理者によってアクセスを明示的に許可されない限りサインインできません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-239">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="d9d90-240">Windows PowerShell Web Access のアクセス制御は、次の表に示す一連の Windows PowerShell コマンドレットによって管理します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-240">Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="d9d90-241">承認規則の追加と管理に関しては、相当する GUI はありません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-241">There is no comparable GUI for adding or managing authorization rules.</span></span> <span data-ttu-id="d9d90-242">Windows PowerShell Web Access コマンドレットの詳細については、コマンドレット リファレンス トピック「[Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps)」(Windows PowerShell Web Access コマンドレット) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-242">For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps).</span></span>

<span data-ttu-id="d9d90-243">Windows PowerShell Web Access の承認規則とセキュリティの詳細については、「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-243">For more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-add-a-restrictive-authorization-rule"></a><span data-ttu-id="d9d90-244">制限的な承認規則を追加するには</span><span class="sxs-lookup"><span data-stu-id="d9d90-244">To add a restrictive authorization rule</span></span>

1. <span data-ttu-id="d9d90-245">次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-245">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="d9d90-246">Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、 **[管理者として実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-246">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
   - <span data-ttu-id="d9d90-247">Windows の**スタート**画面で、 **[Windows PowerShell]** を右クリックし、 **[管理者として実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-247">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

2. <span data-ttu-id="d9d90-248">セッション構成を使用してユーザー アクセスを制限するためのオプション手順: 規則内で使用するセッション構成が既に存在することを確認します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-248">Optional step for restricting user access by using session configurations: Verify that session configurations that you want to use in your rules already exist.</span></span> <span data-ttu-id="d9d90-249">まだ作成されていない場合は、「[about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations)」に記載されているセッション構成の作成手順を使用してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-249">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span></span>

3. <span data-ttu-id="d9d90-250">次のように入力して **Enter** キーを押します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-250">Type the following, and then press **Enter**.</span></span>

   `Add-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>`

   <span data-ttu-id="d9d90-251">この承認規則により、特定のユーザー 1 人が、通常アクセスが許可されているネットワーク上の 1 つのコンピューターにアクセスして、このユーザーが通常必要とするスクリプトとコマンドレットに制限された特定の 1 つのセッション構成にアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-251">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user's typical scripting and cmdlet needs.</span></span>

   <span data-ttu-id="d9d90-252">次の例では、`JSmith` ドメインの `Contoso` というユーザーに、コンピューター `Contoso_214` を管理し、`NewAdminsOnly` という名前のセッション構成を使用するためのアクセス権が付与されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-252">In the following example, a user named `JSmith` in the `Contoso` domain is granted access to manage the computer `Contoso_214`, and use a session configuration named `NewAdminsOnly`.</span></span>

   `Add-PswaAuthorizationRule -UserName Contoso\JSmith -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly`

4. <span data-ttu-id="d9d90-253">`Get-PswaAuthorizationRule` コマンドレットまたは `Test-PswaAuthorizationRule -UserName <domain\user> -ComputerName <computer-name>` を実行して、規則が作成されたことを検証します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-253">Verify that the rule has been created by running either the `Get-PswaAuthorizationRule` cmdlet, or `Test-PswaAuthorizationRule -UserName <domain\user> -ComputerName <computer-name>`</span></span>

   <span data-ttu-id="d9d90-254">たとえば、「 `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214` 」のように入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-254">For example, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span></span>

<span data-ttu-id="d9d90-255">承認規則が構成されたため、承認されたユーザーは Web ベースのコンソールにサインインして Windows PowerShell Web Access の使用を開始できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-255">After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.</span></span>

## <a name="custom-deployment"></a><span data-ttu-id="d9d90-256">カスタム デプロイ</span><span class="sxs-lookup"><span data-stu-id="d9d90-256">Custom deployment</span></span>

<span data-ttu-id="d9d90-257">Windows PowerShell Web Access ゲートウェイは、サーバー マネージャーの役割および機能の追加ウィザードを使用して、Windows Server 2012 R2 または Windows Server 2012 を実行中のサーバーにインストールできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-257">You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using the Add Roles and Features Wizard in Server Manager.</span></span>
<span data-ttu-id="d9d90-258">Windows PowerShell Web Access をインストールした後、IIS Manager でゲートウェイの構成をカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-258">After Windows PowerShell Web Access is installed, you can customize the configuration of the gateway in IIS Manager.</span></span>

### <a name="install-windows-powershell-web-access-using-the-add-roles-and-features-wizard"></a><span data-ttu-id="d9d90-259">役割と機能の追加ウィザードを使って Windows PowerShell Web Access をインストールする</span><span class="sxs-lookup"><span data-stu-id="d9d90-259">Install Windows PowerShell Web Access using the Add Roles and Features Wizard</span></span>

1. <span data-ttu-id="d9d90-260">サーバー マネージャーを既に開いている場合は、次の手順に進んでください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-260">If Server Manager is already open, go on to the next step.</span></span> <span data-ttu-id="d9d90-261">サーバー マネージャーをまだ開いていない場合は、次のいずれかの方法で開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-261">If Server Manager is not already open, open it by doing one of the following.</span></span>

   - <span data-ttu-id="d9d90-262">Windows デスクトップで、Windows タスク バーの **[サーバー マネージャー]** をクリックし、サーバー マネージャーを開始します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-262">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span>
   - <span data-ttu-id="d9d90-263">Windows の**スタート**画面で、 **[サーバー マネージャー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-263">On the Windows **Start** screen, click **Server Manager**.</span></span>

2. <span data-ttu-id="d9d90-264">**[管理]** メニューの **[役割と機能の追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-264">On the **Manage** menu, click **Add Roles and Features**.</span></span>

3. <span data-ttu-id="d9d90-265">**[インストールの種類の選択]** ページで、 **[役割ベースまたは機能ベースのインストール]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-265">On the **Select installation type** page, select **Role-based or feature-based installation**.</span></span>
   <span data-ttu-id="d9d90-266">**[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-266">Click **Next**.</span></span>

4. <span data-ttu-id="d9d90-267">**[対象サーバーの選択]** ページで、サーバー プールからサーバーを選択するか、オフライン VHD を選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-267">On the **Select destination server** page, select a server from the server pool, or select an offline VHD.</span></span> <span data-ttu-id="d9d90-268">対象サーバーとしてオフライン VHD を選択するには、まず VHD マウント先のサーバーを選択してから、VHD ファイルを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-268">To select an offline VHD as your destination server, first select the server on which to mount the VHD, and then select the VHD file.</span></span> <span data-ttu-id="d9d90-269">サーバーをサーバー プールに追加する方法については、サーバー マネージャーのヘルプを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-269">For information about how to add servers to your server pool, see the Server Manager Help.</span></span> <span data-ttu-id="d9d90-270">対象サーバーを選択したら、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-270">After you have selected the destination server, click **Next**.</span></span>

5. <span data-ttu-id="d9d90-271">ウィザードの **[機能の選択]** ページで **[Windows PowerShell]** を展開し、 **[Windows PowerShell Web Access]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-271">On the **Select features** page of the wizard, expand **Windows PowerShell**, and then select **Windows PowerShell Web Access**.</span></span>

6. <span data-ttu-id="d9d90-272">.NET Framework 4.5 や Web サーバー (IIS) の役割サービスなど、必要な機能の追加を求めるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-272">Note that you are prompted to add required features, such as .NET Framework 4.5, and role services of Web Server (IIS).</span></span> <span data-ttu-id="d9d90-273">必要な機能を追加して続行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-273">Add required features and continue.</span></span>

   > [!NOTE]
   > <span data-ttu-id="d9d90-274">Windows PowerShell Web Access を使って役割および機能の追加ウィザードをインストールすると、IIS マネージャー スナップインを含む Web サーバー (IIS) もインストールされます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-274">Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in.</span></span> <span data-ttu-id="d9d90-275">このスナップインとその他の IIS 管理ツールは、役割および機能の追加ウィザードを使う場合に既定でインストールされます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-275">The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard.</span></span> <span data-ttu-id="d9d90-276">後の手順で説明する Windows PowerShell コマンドレットを使って Windows PowerShell Web Access をインストールする場合、これらの管理ツールは既定では追加されません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-276">If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.</span></span>

7. <span data-ttu-id="d9d90-277">**[インストール オプションの確認]** ページで、手順 4. で選択した対象サーバーに Windows PowerShell Web Access の機能のファイルが保存されていない場合、 **[代替ソース パスの指定]** をクリックして機能ファイルのパスを入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-277">On the **Confirm installation selections** page, if the feature files for Windows PowerShell Web Access are not stored on the destination server that you selected in step 4, click **Specify an alternate source path**, and provide the path to the feature files.</span></span> <span data-ttu-id="d9d90-278">それ以外の場合、 **[インストール]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-278">Otherwise, click **Install**.</span></span>

8. <span data-ttu-id="d9d90-279">**[インストール]** をクリックすると、 **[インストールの進行状況]** ページには、インストールの進行状況、結果、メッセージ (警告、エラー、Windows PowerShell Web Access に必要なインストール後の構成手順など) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-279">After you click **Install**, the **Installation progress** page displays installation progress, results, and messages such as warnings, failures, or post-installation configuration steps that are required for Windows PowerShell Web Access.</span></span> <span data-ttu-id="d9d90-280">Windows PowerShell Web Access がインストールされると、基本的かつ必須のゲートウェイ セットアップ手順を記載した Readme ファイルの確認を求めるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-280">After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.</span></span> <span data-ttu-id="d9d90-281">これらの手順も、このドキュメントで説明しています。</span><span class="sxs-lookup"><span data-stu-id="d9d90-281">These instructions are also included in this topic.</span></span> <span data-ttu-id="d9d90-282">Readme ファイルのパスは `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt` です。</span><span class="sxs-lookup"><span data-stu-id="d9d90-282">The path to the readme file is `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span></span>

### <a name="configure-the-gateway"></a><span data-ttu-id="d9d90-283">ゲートウェイを構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-283">Configure the gateway</span></span>

<span data-ttu-id="d9d90-284">このセクションの手順は、Windows PowerShell Web Access の Web アプリケーションを Web サイトのルート ディレクトリではなくサブディレクトリにインストールするための手順です。</span><span class="sxs-lookup"><span data-stu-id="d9d90-284">Instructions in this section are for installing the Windows PowerShell Web Access web application in a subdirectory and not in the root directory of your website.</span></span> <span data-ttu-id="d9d90-285">この手順では、`Install-PswaWebApplication` コマンドレットで実行する操作に相当する内容を GUI ベースで実行しています。</span><span class="sxs-lookup"><span data-stu-id="d9d90-285">This procedure is the GUI-based equivalent of the actions performed by the `Install-PswaWebApplication` cmdlet.</span></span> <span data-ttu-id="d9d90-286">さらにこのセクションでは、IIS マネージャーを使って Windows PowerShell Web Access ゲートウェイをルート Web サイトとして構成するための手順も説明します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-286">This section also includes instructions for how to use IIS Manager to configure the Windows PowerShell Web Access gateway as a root website.</span></span>

#### <a name="to-use-iis-manager-to-configure-the-gateway-in-an-existing-website"></a><span data-ttu-id="d9d90-287">IIS マネージャーを使って既存の Web サイトにゲートウェイを構成するには</span><span class="sxs-lookup"><span data-stu-id="d9d90-287">To use IIS Manager to configure the gateway in an existing website</span></span>

1. <span data-ttu-id="d9d90-288">次のいずれかの方法で IIS マネージャー コンソールを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-288">Open the IIS Manager console by doing one of the following.</span></span>

   - <span data-ttu-id="d9d90-289">Windows デスクトップで、Windows タスク バーの **[サーバー マネージャー]** をクリックし、サーバー マネージャーを開始します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-289">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="d9d90-290">[サーバー マネージャー] の **[ツール]** メニューで **[インターネット インフォメーション サービス (IIS) マネージャー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-290">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>
   - <span data-ttu-id="d9d90-291">Windows の**スタート**画面で、**インターネット インフォメーション サービス (IIS) マネージャー**という名前の任意の一部を入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-291">On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**.</span></span> <span data-ttu-id="d9d90-292">**[アプリ]** の結果に表示されたショートカットをクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-292">Click the shortcut when it is displayed in the **Apps** results.</span></span>

2. <span data-ttu-id="d9d90-293">Windows PowerShell Web Access 用の新しいアプリケーション プールを作成します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-293">Create a new application pool for Windows PowerShell Web Access.</span></span> <span data-ttu-id="d9d90-294">IIS マネージャーのツリー ウィンドウでゲートウェイ サーバーのノードを展開して、 **[アプリケーション プール]** を選択し、 **[操作]** ウィンドウの **[アプリケーション プールの追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-294">Expand the node of the gateway server in the IIS Manager tree pane, select **Application Pools**, and click **Add Application Pool** in the **Actions** pane.</span></span>

3. <span data-ttu-id="d9d90-295">新しいアプリケーション プールを **pswa_pool** という名前で追加するか、別の名前を指定して追加します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-295">Add a new application pool with the name **pswa_pool**, or provide another name.</span></span> <span data-ttu-id="d9d90-296">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-296">Click **OK**.</span></span>

4. <span data-ttu-id="d9d90-297">IIS マネージャーのツリー ウィンドウで、Windows PowerShell Web Access がインストールされているサーバーのノードを展開し、 **[サイト]** フォルダーを表示させます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-297">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="d9d90-298">**[サイト]** フォルダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-298">Select the **Sites** folder.</span></span>

5. <span data-ttu-id="d9d90-299">Windows PowerShell Web Access の Web サイトの追加先となる Web サイト ( **[既定の Web サイト]** など) を右クリックして、 **[アプリケーションの追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-299">Right-click the website (for example, **Default Web Site**) to which you would like to add the Windows PowerShell Web Access website, and then click **Add Application**.</span></span>

6. <span data-ttu-id="d9d90-300">**"エイリアス"** フィールドに「pswa」と入力するか、別のエイリアスを入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-300">In the **Alias** field, type pswa, or provide another alias.</span></span> <span data-ttu-id="d9d90-301">このエイリアスが仮想ディレクトリ名となります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-301">The alias becomes the virtual directory name.</span></span> <span data-ttu-id="d9d90-302">たとえば、**という URL の**pswa`https://<server-name>/pswa` は、この手順で指定されたものです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-302">For example, **pswa** in the following URL represents the alias specified in this step: `https://<server-name>/pswa`.</span></span>

7. <span data-ttu-id="d9d90-303">**"アプリケーション プール"** フィールドで、手順 3. で作成したアプリケーション プールを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-303">In the **Application pool** field, select the application pool that you created in step 3.</span></span>

8. <span data-ttu-id="d9d90-304">**"物理パス"** フィールドで、アプリケーションの場所を参照します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-304">In the **Physical path** field, browse for the location of the application.</span></span> <span data-ttu-id="d9d90-305">既定の場所 (`$env:windir/Web/PowerShellWebAccess/wwwroot`) を使うことができます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-305">You can use the default location, `$env:windir/Web/PowerShellWebAccess/wwwroot`.</span></span> <span data-ttu-id="d9d90-306">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-306">Click **OK**.</span></span>

9. <span data-ttu-id="d9d90-307">このトピックの「 [IIS マネージャーで SSL 証明書を構成するには](#to-configure-an-ssl-certificate-in-iis-manager) 」の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="d9d90-307">Follow the steps in the procedure [To configure an SSL certificate in IIS Manager](#to-configure-an-ssl-certificate-in-iis-manager) in this topic.</span></span>

10. <span data-ttu-id="d9d90-308">セキュリティ手順 (省略可能):</span><span class="sxs-lookup"><span data-stu-id="d9d90-308">Optional security step:</span></span>

    <span data-ttu-id="d9d90-309">ツリー ウィンドウで Web サイトが選択された状態で、コンテンツ ウィンドウの **[SSL 設定]** をダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-309">With the website selected in the tree pane, double-click **SSL Settings** in the content pane.</span></span>
    <span data-ttu-id="d9d90-310">**[SSL が必要]** を選択して、 **[操作]** ウィンドウで **[適用]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-310">Select **Require SSL**, and then in the **Actions** pane, click **Apply**.</span></span> <span data-ttu-id="d9d90-311">必要に応じて、 **[SSL 設定]** ウィンドウを使って、Windows PowerShell Web Access の Web サイトに接続するユーザーに対してクライアント証明書の所有を要求できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-311">Optionally, in the **SSL Settings** pane, you can require that users connecting to the Windows PowerShell Web Access website have client certificates.</span></span> <span data-ttu-id="d9d90-312">クライアント証明書により、クライアント デバイスのユーザーの ID を検証できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-312">Client certificates help to verify the identity of a client device user.</span></span> <span data-ttu-id="d9d90-313">クライアント証明書の要求によって Windows PowerShell Web Access のセキュリティを強化する方法の詳細については、このトピックの「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-313">For more information about how requiring client certificates can increase the security of Windows PowerShell Web Access, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md) in this guide.</span></span>

11. <span data-ttu-id="d9d90-314">クライアント デバイスでブラウザー セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-314">Open a browser session on a client device.</span></span> <span data-ttu-id="d9d90-315">サポートされるブラウザーとデバイスの詳細については、このトピックの「[ブラウザーとクライアント デバイスのサポート](#browser-and-client-device-support)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-315">For more information about supported browsers and devices, see [Browser and client device support](#browser-and-client-device-support) in this topic.</span></span>

12. <span data-ttu-id="d9d90-316">新しい Windows PowerShell Web Access Web サイト **https://\<*gateway-server-name*\>/pswa** を開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-316">Open the new Windows PowerShell Web Access website, **https://\<*gateway-server-name*\>/pswa**.</span></span>

    <span data-ttu-id="d9d90-317">ブラウザーには Windows PowerShell Web Access コンソールのサインイン ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-317">The browser should display the Windows PowerShell Web Access console sign-in page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d9d90-318">サインインできるのは、承認規則の追加によって Web サイトへのアクセスが許可されたユーザーだけです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-318">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="d9d90-319">詳細については、このトピックの「[制限的な承認規則を構成する](#configure-a-restrictive-authorization-rule)」と「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-319">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

13. <span data-ttu-id="d9d90-320">管理者特権で開かれた ([管理者として実行]) Windows PowerShell セッションで、次のスクリプトを実行します。*application_pool_name* は、手順 3. で作成したアプリケーション プールの名前です。これによって承認ファイルへのアクセス権がアプリケーション プールに付与されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-320">In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which *application_pool_name* represents the name of the application pool that you created in step 3, to give the application pool access rights to the authorization file.</span></span>

    ```powershell
    $applicationPoolName = "<application_pool_name>"
    $authorizationFile = "C:\windows\web\powershellwebaccess\data\AuthorizationRules.xml"
    c:\windows\system32\icacls.exe $authorizationFile /grant ('"' + "IIS AppPool\$applicationPoolName" + '":R') > $null
    ```

    <span data-ttu-id="d9d90-321">承認ファイルに対する既存のアクセス権を表示するには、次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-321">To view existing access rights on the authorization file, run the following command:</span></span>

    ```powershell
    c:\windows\system32\icacls.exe $authorizationFile
    ```

#### <a name="to-use-iis-manager-to-configure-the-gateway-as-a-root-website-with-a-test-certificate"></a><span data-ttu-id="d9d90-322">IIS マネージャーを使用してテスト証明書を持つゲートウェイをルート Web サイトとして構成するには</span><span class="sxs-lookup"><span data-stu-id="d9d90-322">To use IIS Manager to configure the gateway as a root website with a test certificate</span></span>

1. <span data-ttu-id="d9d90-323">次のいずれかの方法で IIS マネージャー コンソールを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-323">Open the IIS Manager console by doing one of the following.</span></span>

   - <span data-ttu-id="d9d90-324">Windows デスクトップで、Windows タスク バーの **[サーバー マネージャー]** をクリックし、サーバー マネージャーを開始します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-324">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="d9d90-325">[サーバー マネージャー] の **[ツール]** メニューで **[インターネット インフォメーション サービス (IIS) マネージャー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-325">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>
   - <span data-ttu-id="d9d90-326">Windows の**スタート**画面で、**インターネット インフォメーション サービス (IIS) マネージャー**という名前の任意の一部を入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-326">On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**.</span></span> <span data-ttu-id="d9d90-327">**[アプリ]** の結果に表示されたショートカットをクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-327">Click the shortcut when it is displayed in the **Apps** results.</span></span>

1. <span data-ttu-id="d9d90-328">IIS マネージャーのツリー ウィンドウで、Windows PowerShell Web Access がインストールされているサーバーのノードを展開し、 **[サイト]** フォルダーを表示させます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-328">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="d9d90-329">**[サイト]** フォルダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-329">Select the **Sites** folder.</span></span>

1. <span data-ttu-id="d9d90-330">**[操作]** ウィンドウで **[Web サイトの追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-330">In the **Actions** pane, click **Add Website**.</span></span>

1. <span data-ttu-id="d9d90-331">Web サイトの名前 (**Windows PowerShell Web Access** など) を入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-331">Type a name for the website, such as **Windows PowerShell Web Access**.</span></span>

1. <span data-ttu-id="d9d90-332">新しい Web サイト用のアプリケーション プールが自動で作成されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-332">An application pool is automatically created for the new website.</span></span> <span data-ttu-id="d9d90-333">別のアプリケーション プールを使うには、 **[選択]** をクリックして、新しい Web サイトに関連付けるアプリケーション プールを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-333">To use a different application pool, click **Select** to select an application pool to associate with the new website.</span></span> <span data-ttu-id="d9d90-334">**[アプリケーション プールの選択]** ダイアログ ボックスで別のアプリケーション プールを選択し、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-334">Select the alternate application pool in the **Select Application Pool** dialog box, and then click **OK**.</span></span>

1. <span data-ttu-id="d9d90-335">**[物理パス]** テキスト ボックスで、%windir%/Web/PowerShellWebAccess/wwwroot に移動します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-335">In the **Physical path** text box, navigate to %windir%/Web/PowerShellWebAccess/wwwroot.</span></span>

1. <span data-ttu-id="d9d90-336">**[バインド]** 領域の **[種類]** フィールドで、 **[https]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-336">In the **Type** field of the **Binding** area, select **https**.</span></span>

1. <span data-ttu-id="d9d90-337">別のサイトまたはアプリケーションがまだ使っていないポート番号を Web サイトに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-337">Assign a port number to the website that is not already in use by another site or application.</span></span>
   <span data-ttu-id="d9d90-338">未使用のポートを調べるには、コマンド プロンプト ウィンドウで **netstat** コマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-338">To locate open ports, you can run the **netstat** command in a Command Prompt window.</span></span> <span data-ttu-id="d9d90-339">既定のポート番号は 443 です。</span><span class="sxs-lookup"><span data-stu-id="d9d90-339">The default port number is 443.</span></span>

   <span data-ttu-id="d9d90-340">別の Web サイトが既に 443 を使っている場合、またはポート番号を変更するセキュリティ上の理由がある場合は、既定のポートを変更します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-340">Change the default port if another website is already using 443, or if you have other security reasons for changing the port number.</span></span> <span data-ttu-id="d9d90-341">選択したポートを、ゲートウェイ サーバー上で実行されている別の Web サイトが使っている場合は、 **[Web サイトの追加]** ダイアログ ボックスで **[OK]** をクリックすると警告が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-341">If another website that is running on your gateway server is using your selected port, a warning is displayed when you click **OK** in the **Add Website** dialog box.</span></span> <span data-ttu-id="d9d90-342">Windows PowerShell Web Access を実行するには未使用のポートを使う必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-342">You must use an unused port to run Windows PowerShell Web Access.</span></span>

1. <span data-ttu-id="d9d90-343">組織の必要に応じて、組織またはユーザーにわかるホスト名を指定します ( **`www.contoso.com`** など)。</span><span class="sxs-lookup"><span data-stu-id="d9d90-343">Optionally, if needed for your organization, specify a host name that makes sense to your organization and users, such as **`www.contoso.com`**.</span></span> <span data-ttu-id="d9d90-344">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-344">Click **OK**.</span></span>

1. <span data-ttu-id="d9d90-345">運用環境のセキュリティ保護を強化するため、CA によって署名された有効な証明書を提供することを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-345">For a more secure production environment, we strongly recommend providing a valid certificate that has been signed by a CA.</span></span> <span data-ttu-id="d9d90-346">ユーザーは HTTPS Web サイトを経由しないと Windows PowerShell Web Access に接続できないため、SSL 証明書は必ず提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-346">You must provide an SSL certificate, because users can only connect to Windows PowerShell Web Access through an HTTPS website.</span></span> <span data-ttu-id="d9d90-347">証明書の取得方法の詳細については、このトピックの「[IIS マネージャーで SSL 証明書を構成するには](#to-configure-an-ssl-certificate-in-iis-manager)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-347">See [To configure an SSL certificate in IIS Manager](#to-configure-an-ssl-certificate-in-iis-manager) in this topic for more information about how to obtain a certificate.</span></span>

1. <span data-ttu-id="d9d90-348">**[OK]** をクリックして **[Web サイトの追加]** ダイアログ ボックスを閉じます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-348">Click **OK** to close the **Add Website** dialog box.</span></span>

1. <span data-ttu-id="d9d90-349">管理者特権で開かれた ([管理者として実行]) Windows PowerShell セッションで、次のスクリプトを実行します。_application_pool_name_ は、手順 4. で作成したアプリケーション プールの名前です。これによって承認ファイルへのアクセス権がアプリケーション プールに付与されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-349">In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which _application_pool_name_ represents the name of the application pool that you created in step 4, to give the application pool access rights to the authorization file.</span></span>

   ```powershell
   $applicationPoolName = "<application_pool_name>"
   $authorizationFile = "C:\windows\web\powershellwebaccess\data\AuthorizationRules.xml"
   c:\windows\system32\icacls.exe $authorizationFile /grant ('"' + "IIS AppPool\$applicationPoolName" + '":R') > $null
   ```

   <span data-ttu-id="d9d90-350">承認ファイルに対する既存のアクセス権を表示するには、次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-350">To view existing access rights on the authorization file, run the following command:</span></span>

   ```powershell
   c:\windows\system32\icacls.exe $authorizationFile
   ```

1. <span data-ttu-id="d9d90-351">IIS マネージャーのツリー ウィンドウで新しい Web サイトが選択された状態で、 **[操作]** ウィンドウの **[開始]** をクリックすると、Web サイトが開設されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-351">With the new website selected in the IIS Manager tree pane, click **Start** in the **Actions** pane to start the website.</span></span>

1. <span data-ttu-id="d9d90-352">クライアント デバイスでブラウザー セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-352">Open a browser session on a client device.</span></span> <span data-ttu-id="d9d90-353">サポートされるブラウザーとデバイスの詳細については、このドキュメントの「[ブラウザーとクライアント デバイスのサポート](#browser-and-client-device-support)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-353">For more information about supported browsers and devices, see [Browser and client device support](#browser-and-client-device-support) in this document.</span></span>

1. <span data-ttu-id="d9d90-354">新しい Windows PowerShell Web Access の Web サイトを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-354">Open the new Windows PowerShell Web Access website.</span></span>

   <span data-ttu-id="d9d90-355">ルート Web サイトは Windows PowerShell Web Access フォルダーを参照しているため、`https://<gateway_server_name>` を開くと、ブラウザーには Windows PowerShell Web Access のサインイン ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-355">Because the root website points to the Windows PowerShell Web Access folder, the browser should display the Windows PowerShell Web Access sign-in page when you open `https://<gateway_server_name>`.</span></span> <span data-ttu-id="d9d90-356">URL に **/pswa** を追加する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-356">You should not need to add **/pswa** to the URL.</span></span>

   > [!NOTE]
   > <span data-ttu-id="d9d90-357">サインインできるのは、承認規則の追加によって Web サイトへのアクセスが許可されたユーザーだけです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-357">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="d9d90-358">詳細については、このトピックの「[制限的な承認規則を構成する](#configure-a-restrictive-authorization-rule)」と「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-358">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

### <a name="configuring-a-restrictive-authorization-rule"></a><span data-ttu-id="d9d90-359">制限的な承認規則の構成</span><span class="sxs-lookup"><span data-stu-id="d9d90-359">Configuring a restrictive authorization rule</span></span>

<span data-ttu-id="d9d90-360">Windows PowerShell Web Access をインストールし、ゲートウェイを構成すると、ユーザーがブラウザーでサインイン ページを開けるようになります。ただし、Windows PowerShell Web Access 管理者によってアクセスを明示的に許可されない限りサインインできません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-360">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="d9d90-361">Windows PowerShell Web Access のアクセス制御は、次の表に示す一連の Windows PowerShell コマンドレットによって管理します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-361">Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="d9d90-362">承認規則の追加と管理に関しては、相当する GUI はありません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-362">There is no comparable GUI for adding or managing authorization rules.</span></span> <span data-ttu-id="d9d90-363">Windows PowerShell Web Access コマンドレットの詳細については、コマンドレット リファレンス トピック「[Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps)」(Windows PowerShell Web Access コマンドレット) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-363">For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps).</span></span>

<span data-ttu-id="d9d90-364">Windows PowerShell Web Access の承認規則とセキュリティの詳細については、「[Windows PowerShell Web Access の承認規則とセキュリティ機能](authorization-rules-and-security-features-of-windows-powershell-web-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-364">For more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="adding-a-restrictive-authorization-rule"></a><span data-ttu-id="d9d90-365">制限的な承認規則の追加</span><span class="sxs-lookup"><span data-stu-id="d9d90-365">Adding a restrictive authorization rule</span></span>

1. <span data-ttu-id="d9d90-366">次のいずれかを実行して、管理者特権を使って Windows PowerShell セッションを開きます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-366">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="d9d90-367">Windows デスクトップで、タスク バーの **[Windows PowerShell]** を右クリックし、 **[管理者として実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-367">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
   - <span data-ttu-id="d9d90-368">Windows の**スタート**画面で、 **[Windows PowerShell]** を右クリックし、 **[管理者として実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-368">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

1. <span data-ttu-id="d9d90-369">セッションの構成を使用してユーザー アクセスを制限するための手順 (省略可能):</span><span class="sxs-lookup"><span data-stu-id="d9d90-369">Optional step for restricting user access by using session configurations:</span></span>

   <span data-ttu-id="d9d90-370">既に存在する規則の中で使用するセッションの構成を確認します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-370">Verify that session configurations that you want to use in your rules already exist.</span></span> <span data-ttu-id="d9d90-371">まだ作成されていない場合は、「[about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations)」に記載されているセッション構成の作成手順を使用してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-371">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span></span>

1. <span data-ttu-id="d9d90-372">次のように入力して **Enter** キーを押します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-372">Type the following, and then press **Enter**.</span></span>

   `Add-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>`

   <span data-ttu-id="d9d90-373">この承認規則により、特定のユーザーが、通常アクセスが許可されているネットワーク上の 1 台のコンピューターにアクセスして、このユーザー&trade;が通常必要とするスクリプトとコマンドレットに制限された特定のセッション構成にアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-373">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user'&trade;s typical scripting and cmdlet needs.</span></span>

   <span data-ttu-id="d9d90-374">次の例では、`JSmith` ドメインの `Contoso` というユーザーに、コンピューター `Contoso_214` を管理し、`NewAdminsOnly` という名前のセッション構成を使用するためのアクセス権が付与されます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-374">In the following example, a user named `JSmith` in the `Contoso` domain is granted access to manage the computer `Contoso_214`, and use a session configuration named `NewAdminsOnly`.</span></span>

   `Add-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly`

1. <span data-ttu-id="d9d90-375">`Get-PswaAuthorizationRule` コマンドレットまたは `Test-PswaAuthorizationRule -UserName '<domain\user>' -ComputerName <computer-name>` を実行して、規則が作成されたことを検証します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-375">Verify that the rule has been created by running either the `Get-PswaAuthorizationRule` cmdlet, or `Test-PswaAuthorizationRule -UserName '<domain\user>' -ComputerName <computer-name>`.</span></span>

   <span data-ttu-id="d9d90-376">たとえば、「 `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214` 」のように入力します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-376">For example, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span></span>

   <span data-ttu-id="d9d90-377">承認規則が構成されたため、承認されたユーザーは Web ベースのコンソールにサインインして Windows PowerShell Web Access の使用を開始できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-377">After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.</span></span>

## <a name="configure-a-genuine-certificate"></a><span data-ttu-id="d9d90-378">正規の証明書を構成する</span><span class="sxs-lookup"><span data-stu-id="d9d90-378">Configure a genuine certificate</span></span>

<span data-ttu-id="d9d90-379">運用環境のセキュリティ保護のため、証明機関 (CA) によって署名されている有効な SSL 証明書を常に使用してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-379">For a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).</span></span> <span data-ttu-id="d9d90-380">このセクションの手順では、有効な SSL 証明書を CA から取得して適用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-380">The procedure in this section describes how to obtain and apply a valid SSL certificate from a CA.</span></span>

### <a name="to-configure-an-ssl-certificate-in-iis-manager"></a><span data-ttu-id="d9d90-381">IIS マネージャーで SSL 証明書を構成するには</span><span class="sxs-lookup"><span data-stu-id="d9d90-381">To configure an SSL certificate in IIS Manager</span></span>

1. <span data-ttu-id="d9d90-382">IIS マネージャーのツリー ウィンドウで、Windows PowerShell Web Access がインストールされているサーバーを選択します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-382">In the IIS Manager tree pane, select the server on which Windows PowerShell Web Access is installed.</span></span>

1. <span data-ttu-id="d9d90-383">コンテンツ ウィンドウで **[サーバー証明書]** をダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-383">In the content pane, double click **Server Certificates**.</span></span>

1. <span data-ttu-id="d9d90-384">**[操作]** ウィンドウで、次のいずれかを実行します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-384">In the **Actions** pane, do one of the following.</span></span> <span data-ttu-id="d9d90-385">IIS でサーバー証明書を構成する方法の詳細については、「[IIS 7 でサーバー証明書を構成する](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732230(v=ws.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-385">For more information about configuring server certificates in IIS, see [Configuring Server Certificates in IIS 7](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732230(v=ws.10)).</span></span>

   - <span data-ttu-id="d9d90-386">**[インポート]** をクリックして、ネットワーク内の場所にある既存の有効な証明書をインポートします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-386">Click **Import** to import an existing, valid certificate from a location on your network.</span></span>
   - <span data-ttu-id="d9d90-387">**[証明書の要求の作成]** をクリックして、[VeriSign](https://www.verisign.com/)、[Thawte](https://www.thawte.com/)、[GeoTrust](https://www.geotrust.com/) などの CA に証明書を要求します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-387">Click **Create Certificate Request** to request a certificate from a CA such as [VeriSign](https://www.verisign.com/), [Thawte](https://www.thawte.com/), or [GeoTrust](https://www.geotrust.com/).</span></span> <span data-ttu-id="d9d90-388">証明書の共通名が要求のホスト ヘッダーと一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-388">The certificate's common name must match the host header in the request.</span></span>

     <span data-ttu-id="d9d90-389">たとえば、クライアントのブラウザーが `http://www.contoso.com/` を要求する場合、共通名も `http://www.contoso.com/` でなければなりません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-389">For example, if the client browser requests `http://www.contoso.com/`, then the common name must also be `http://www.contoso.com/`.</span></span> <span data-ttu-id="d9d90-390">これは、証明書を使う Windows PowerShell Web Access ゲートウェイを提供する場合に最も安全かつ推奨されるオプションです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-390">This is the most secure and recommended option for providing the Windows PowerShell Web Access gateway with a certificate.</span></span>

   - <span data-ttu-id="d9d90-391">**[自己署名証明書を作成する]** をクリックして証明書を作成します。この証明書はすぐに使うことができ、必要な場合は後でCAが署名できます。</span><span class="sxs-lookup"><span data-stu-id="d9d90-391">Click **Create a Self-Signed Certificate** to create a certificate that you can use immediately, and have signed later by a CA if desired.</span></span> <span data-ttu-id="d9d90-392">自己署名証明書にわかりやすい名前を指定します (**Windows PowerShell Web Access** など)。</span><span class="sxs-lookup"><span data-stu-id="d9d90-392">Specify a friendly name for the self-signed certificate, such as **Windows PowerShell Web Access**.</span></span> <span data-ttu-id="d9d90-393">これは、安全と見なされない、プライベートなテスト環境にのみ推奨されるオプションです。</span><span class="sxs-lookup"><span data-stu-id="d9d90-393">This option is not considered secure, and is recommended only for a private test environment.</span></span>

1. <span data-ttu-id="d9d90-394">証明書を作成または取得した後、IIS マネージャーのツリー ウィンドウで、証明書を適用する Web サイト ( **[既定の Web サイト]** など) を選択して、 **[操作]** ウィンドウの **[バインド]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-394">After creating or obtaining a certificate, select the website to which the certificate is applied (for example, **Default Web Site**) in the IIS Manager tree pane, and then click **Bindings** in the **Actions** pane.</span></span>

1. <span data-ttu-id="d9d90-395">**[サイト バインドの追加]** ダイアログ ボックスで、サイトの **[https]** バインドを追加します (表示されていない場合)。</span><span class="sxs-lookup"><span data-stu-id="d9d90-395">In the **Add Site Binding** dialog box, add an **https** binding for the site, if one is not already displayed.</span></span> <span data-ttu-id="d9d90-396">自己署名証明書を使っていない場合、手順 3. のホスト名を指定します。</span><span class="sxs-lookup"><span data-stu-id="d9d90-396">If you are not using a self-signed certificate, specify the host name from step 3 of this procedure.</span></span> <span data-ttu-id="d9d90-397">自己署名証明書を使っている場合、この手順は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="d9d90-397">If you are using a self-signed certificate, this step is not required.</span></span>

1. <span data-ttu-id="d9d90-398">手順 3. で取得または作成した証明書を選択して、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d9d90-398">Select the certificate that you obtained or created in step 3 of this procedure, and then click **OK**.</span></span>

## <a name="using-the-web-based-windows-powershell-console"></a><span data-ttu-id="d9d90-399">Web ベースの Windows PowerShell コンソールの使用</span><span class="sxs-lookup"><span data-stu-id="d9d90-399">Using the web-based Windows PowerShell console</span></span>

<span data-ttu-id="d9d90-400">このトピックの説明に従って Windows PowerShell Web Access のインストールとゲートウェイ構成が完了したら、Web ベースの Windows PowerShell コンソールを使えるようになります。</span><span class="sxs-lookup"><span data-stu-id="d9d90-400">After Windows PowerShell Web Access is installed and the gateway configuration is finished as described in this topic, the Windows PowerShell web-based console is ready to use.</span></span> <span data-ttu-id="d9d90-401">Web ベース コンソールの概要については、「[Web ベースの Windows PowerShell コンソールの使用](use-the-web-based-windows-powershell-console.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d9d90-401">For more information about getting started in the web-based console, see [Use the Web-based Windows PowerShell Console](use-the-web-based-windows-powershell-console.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="d9d90-402">参照</span><span class="sxs-lookup"><span data-stu-id="d9d90-402">See Also</span></span>

<span data-ttu-id="d9d90-403">[インターネット インフォメーション サービス (IIS) 7.0 のドキュメント](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753433(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="d9d90-403">[Internet Information Services (IIS) 7.0 Documentation](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753433(v=ws.10))</span></span>

<span data-ttu-id="d9d90-404">[IIS マネージャー 7.0 ヘルプ](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732664(v=ws.11))</span><span class="sxs-lookup"><span data-stu-id="d9d90-404">[IIS Manager 7.0 Help](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732664(v=ws.11))</span></span>

<span data-ttu-id="d9d90-405">[Web サーバーのセキュリティを構成する (IIS 7)](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731278(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="d9d90-405">[Configure Web Server Security (IIS 7)](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731278(v=ws.10))</span></span>

<span data-ttu-id="d9d90-406">[IPsec の展開リソース](/previous-versions/windows/it-pro/windows-server-2003/cc776369(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="d9d90-406">[IPsec Deployment Resources](/previous-versions/windows/it-pro/windows-server-2003/cc776369(v=ws.10))</span></span>
