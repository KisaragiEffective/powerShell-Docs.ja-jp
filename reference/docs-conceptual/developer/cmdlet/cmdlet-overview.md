---
title: コマンドレットの概要 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- cmdlets [PowerShell SDK]
- cmdlets [PowerShell SDK], described
ms.assetid: 0aa32589-4447-4ead-a5dd-a3be99113140
caps.latest.revision: 21
ms.openlocfilehash: 14200aed2fb94c37c8b8af29650f602945e7ac1c
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2019
ms.locfileid: "72365891"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="0cf6d-102">コマンドレットの概要</span><span class="sxs-lookup"><span data-stu-id="0cf6d-102">Cmdlet Overview</span></span>

<span data-ttu-id="0cf6d-103">コマンドレットは、Windows PowerShell 環境で使用される簡易コマンドです。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-103">A cmdlet is a lightweight command that is used in the Windows PowerShell environment.</span></span> <span data-ttu-id="0cf6d-104">Windows PowerShell ランタイムは、コマンドラインで指定されたオートメーションスクリプトのコンテキスト内でこれらのコマンドレットを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-104">The Windows PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="0cf6d-105">Windows PowerShell ランタイムでは、Windows PowerShell Api を使用してプログラムで呼び出すこともできます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-105">The Windows PowerShell runtime also invokes them programmatically through Windows PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="0cf6d-106">コマンドレット</span><span class="sxs-lookup"><span data-stu-id="0cf6d-106">Cmdlets</span></span>

<span data-ttu-id="0cf6d-107">コマンドレットは、アクションを実行し、通常、パイプラインの次のコマンドに Microsoft .NET Framework オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-107">Cmdlets perform an action and typically return a Microsoft .NET Framework object to the next command in the pipeline.</span></span> <span data-ttu-id="0cf6d-108">コマンドレットを記述するには、2つの特殊なコマンドレット基本クラスのうちの1つから派生したコマンドレットクラスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-108">To write a cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="0cf6d-109">派生クラスには次のものが必要です。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-109">The derived class must:</span></span>

- <span data-ttu-id="0cf6d-110">派生クラスをコマンドレットとして識別する属性を宣言します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-110">Declare an attribute that identifies the derived class as a cmdlet.</span></span>

- <span data-ttu-id="0cf6d-111">コマンドレットのパラメーターとしてパブリックプロパティを識別する属性で装飾されたパブリックプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-111">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>

- <span data-ttu-id="0cf6d-112">1つ以上の入力処理メソッドをオーバーライドしてレコードを処理します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-112">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="0cf6d-113">クラスを含むアセンブリは、Initialsessionstate [Import-Module](/powershell/module/microsoft.powershell.core/import-module)コマンドレットを使用して直接読み込むことができます。また、アセンブリを読み込むホストアプリケーションを作成するには、 [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API を使用します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-113">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="0cf6d-114">どちらの方法でも、プログラムおよびコマンドラインからコマンドレットの機能にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-114">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="0cf6d-115">コマンドレットの使用条件</span><span class="sxs-lookup"><span data-stu-id="0cf6d-115">Cmdlet Terms</span></span>

<span data-ttu-id="0cf6d-116">Windows PowerShell コマンドレットのドキュメントでは、次の用語が頻繁に使用されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-116">The following terms are used frequently in the Windows PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="0cf6d-117">コマンドレット属性</span><span class="sxs-lookup"><span data-stu-id="0cf6d-117">Cmdlet attribute</span></span>

<span data-ttu-id="0cf6d-118">コマンドレットとしてコマンドレットクラスを宣言するために使用される .NET Framework 属性。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-118">A .NET Framework attribute that is used to declare a cmdlet class as a cmdlet.</span></span>
<span data-ttu-id="0cf6d-119">PowerShell では、省略可能な他のいくつかの属性が使用されますが、コマンドレットの属性は必須です。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-119">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span>
<span data-ttu-id="0cf6d-120">この属性の詳細については、「[コマンドレット属性の宣言](cmdlet-attribute-declaration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-120">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="0cf6d-121">コマンドレットのパラメーター</span><span class="sxs-lookup"><span data-stu-id="0cf6d-121">Cmdlet parameter</span></span>

<span data-ttu-id="0cf6d-122">ユーザーが使用できるパラメーター、またはコマンドレットを実行しているアプリケーションに対して使用可能なパラメーターを定義するパブリックプロパティ。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-122">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span>
<span data-ttu-id="0cf6d-123">コマンドレットには、必須の、名前付き、位置指定、および*スイッチ*のパラメーターを指定できます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-123">Cmdlets can have required, named, positional, and *switch* parameters.</span></span>
<span data-ttu-id="0cf6d-124">スイッチパラメーターを使用すると、呼び出しでパラメーターが指定されている場合にのみ評価されるパラメーターを定義できます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-124">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span>
<span data-ttu-id="0cf6d-125">さまざまな種類のパラメーターの詳細については、「[コマンドレットパラメーター](cmdlet-parameters.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-125">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="0cf6d-126">パラメーターセット</span><span class="sxs-lookup"><span data-stu-id="0cf6d-126">Parameter set</span></span>

<span data-ttu-id="0cf6d-127">特定のアクションを実行するために同じコマンドで使用できるパラメーターのグループ。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-127">A group of parameters that can be used in the same command to perform a specific action.</span></span>
<span data-ttu-id="0cf6d-128">コマンドレットには複数のパラメーターセットを含めることができますが、各パラメーターセットには一意のパラメーターが少なくとも1つ必要です。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-128">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span>
<span data-ttu-id="0cf6d-129">適切なコマンドレットの設計では、unique パラメーターも必須パラメーターであることを強く示唆しています。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-129">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="0cf6d-130">パラメーターセットの詳細については、「[コマンドレットパラメーターセット](cmdlet-parameter-sets.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-130">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="0cf6d-131">動的パラメーター</span><span class="sxs-lookup"><span data-stu-id="0cf6d-131">Dynamic parameter</span></span>

<span data-ttu-id="0cf6d-132">実行時にコマンドレットに追加されるパラメーター。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-132">A parameter that is added to the cmdlet at runtime.</span></span>
<span data-ttu-id="0cf6d-133">通常、動的パラメーターは、別のパラメーターが特定の値に設定されている場合に、コマンドレットに追加されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-133">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span>
<span data-ttu-id="0cf6d-134">動的パラメーターの詳細については、「[コマンドレット動的パラメーター](cmdlet-dynamic-parameters.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-134">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-method"></a><span data-ttu-id="0cf6d-135">入力処理方法</span><span class="sxs-lookup"><span data-stu-id="0cf6d-135">Input processing method</span></span>

<span data-ttu-id="0cf6d-136">コマンドが入力として受信するレコードを処理するのに使用できるメソッド。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-136">A method that a cmdlet can use to process the records it receives as input.</span></span>
<span data-ttu-id="0cf6d-137">入力処理メソッドには、 [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) .................................................[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)........................................... コマンドレット[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing)。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-137">The input processing methods include the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method, and the [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) method.</span></span> <span data-ttu-id="0cf6d-138">コマンドレットを実装する場合は、少なくと[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)も1つの system................................................. コマンドレットシステムの....... コマンドレット。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-138">When you implement a cmdlet, you must override at least one of the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord), and [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) methods.</span></span>
<span data-ttu-id="0cf6d-139">通常、この[メソッドは](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)、コマンドレットが処理するすべてのレコードに対して呼び出されるため、オーバーライドされるメソッドです。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-139">Typically, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method is the method that you override because it is called for every record that the cmdlet processes.</span></span>
<span data-ttu-id="0cf6d-140">これに対して、レコードの事前処理または後処理を実行するために、1回は呼び出されますが、[このメソッドと](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)は、[このメソッドと](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)共に呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-140">In contrast, the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method and the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method are called one time to perform pre-processing or post-processing of the records.</span></span>
<span data-ttu-id="0cf6d-141">これらのメソッドの詳細については、「[入力処理方法](cmdlet-input-processing-methods.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-141">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="0cf6d-142">機能を処理する</span><span class="sxs-lookup"><span data-stu-id="0cf6d-142">ShouldProcess feature</span></span>

<span data-ttu-id="0cf6d-143">PowerShell では、コマンドレットがシステムに変更を加える前に、ユーザーにフィードバックを求めるコマンドレットを作成できます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-143">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span>
<span data-ttu-id="0cf6d-144">この機能を使用するには、コマンドレットでコマンドレットの属性を宣言するときに、コマンドレットで指定する機能がサポートされていることを宣言する必要があり[ます。また](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)、コマンドレット[は、入力](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)処理メソッド内からメソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-144">To use this feature, the cmdlet must declare that it supports the ShouldProcess feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span>
<span data-ttu-id="0cf6d-145">入力プロセス機能をサポートする方法の詳細については、「[確認の要求](requesting-confirmation-from-cmdlets.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-145">For more information about how to support the ShouldProcess functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="0cf6d-146">トランザクション</span><span class="sxs-lookup"><span data-stu-id="0cf6d-146">Transaction</span></span>

<span data-ttu-id="0cf6d-147">1つのタスクとして扱われるコマンドの論理グループ。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-147">A logical group of commands that are treated as a single task.</span></span>
<span data-ttu-id="0cf6d-148">グループ内のいずれかのコマンドが失敗し、ユーザーがトランザクション内で実行されたアクションを受け入れるか拒否するかを選択できる場合、タスクは自動的に失敗します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-148">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span>
<span data-ttu-id="0cf6d-149">コマンドレットは、トランザクションに参加するには、コマンドレットの属性が宣言されているときにトランザクションをサポートするように宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-149">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span>
<span data-ttu-id="0cf6d-150">トランザクションのサポートは、Windows PowerShell 2.0 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-150">Support for transactions was introduced in Windows PowerShell 2.0.</span></span>
<span data-ttu-id="0cf6d-151">トランザクションの詳細については、「[トランザクションをサポートする方法](how-to-support-transactions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-151">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="0cf6d-152">コマンドレットの違い</span><span class="sxs-lookup"><span data-stu-id="0cf6d-152">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="0cf6d-153">コマンドレットは、次の方法で他のコマンドシェル環境のコマンドとは異なります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-153">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="0cf6d-154">コマンドレットは .NET Framework クラスのインスタンスです。これらはスタンドアロンの実行可能ファイルではありません。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-154">Cmdlets are instances of .NET Framework classes; they are not stand-alone executables.</span></span>

- <span data-ttu-id="0cf6d-155">コマンドレットは、数十のコード行から作成できます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-155">Cmdlets can be created from as few as a dozen lines of code.</span></span>

- <span data-ttu-id="0cf6d-156">コマンドレットは、通常、独自の解析、エラー表示、または出力書式設定を行いません。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-156">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="0cf6d-157">解析、エラー表示、および出力の書式設定は、Windows PowerShell ランタイムによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-157">Parsing, error presentation, and output formatting are handled by the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="0cf6d-158">コマンドレットは、テキストのストリームからではなく、パイプラインからの入力オブジェクトを処理します。また、コマンドレットは通常、オブジェクトをパイプラインに出力として配信します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-158">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>

- <span data-ttu-id="0cf6d-159">コマンドレットは、一度に1つのオブジェクトを処理するため、レコード指向です。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-159">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="0cf6d-160">コマンドレットの基本クラス</span><span class="sxs-lookup"><span data-stu-id="0cf6d-160">Cmdlet Base Classes</span></span>

<span data-ttu-id="0cf6d-161">Windows PowerShell は、次の2つの基本クラスから派生したコマンドレットをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-161">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="0cf6d-162">ほとんどのコマンドレットは、[システム](/dotnet/api/System.Management.Automation.Cmdlet)の .NET Framework 基底クラスから派生したクラスに基づいています。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-162">Most cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span> <span data-ttu-id="0cf6d-163">このクラスから派生させることにより、コマンドレットは、Windows PowerShell ランタイムの最小限の依存関係を使用できます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-163">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="0cf6d-164">これには2つの利点があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-164">This has two benefits.</span></span> <span data-ttu-id="0cf6d-165">1つ目の利点は、コマンドレットオブジェクトが小さく、Windows PowerShell ランタイムの変更によって影響を受ける可能性が低いことです。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-165">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the Windows PowerShell runtime.</span></span> <span data-ttu-id="0cf6d-166">2つ目の利点は、必要に応じて、コマンドレットオブジェクトのインスタンスを直接作成してから、Windows PowerShell ランタイムを使用して呼び出すのではなく、直接呼び出すことができることです。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-166">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="0cf6d-167">より複雑なコマンドレットは、 [PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基底クラスから派生した .NET Framework クラスに基づいています。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-167">The more-complex cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="0cf6d-168">このクラスから派生させることで、Windows PowerShell ランタイムにはるかに多くのアクセスを提供できます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-168">Deriving from this class gives you much more access to the Windows PowerShell runtime.</span></span> <span data-ttu-id="0cf6d-169">このアクセスにより、コマンドレットは、スクリプトを呼び出したり、プロバイダーにアクセスしたり、現在のセッション状態にアクセスしたりすることができます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-169">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span> <span data-ttu-id="0cf6d-170">(現在のセッション状態にアクセスするには、セッション変数とユーザー設定を取得して設定します)。ただし、このクラスから派生すると、コマンドレットオブジェクトのサイズが大きくなります。また、コマンドレットが現在のバージョンの Windows PowerShell ランタイムと密接に結合されていることを意味します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-170">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the Windows PowerShell runtime.</span></span>

<span data-ttu-id="0cf6d-171">一般に、Windows PowerShell ランタイムへの拡張アクセスが必要な場合を除き、[このクラスから](/dotnet/api/System.Management.Automation.Cmdlet)派生させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-171">In general, unless you need the extended access to the Windows PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="0cf6d-172">ただし、Windows PowerShell ランタイムには、コマンドレットを実行するための広範なログ記録機能があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-172">However, the Windows PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="0cf6d-173">監査モデルがこのログに依存している場合は、 [PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)クラスから派生することによって、別のコマンドレット内からコマンドレットを実行できないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-173">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="input-processing-methods"></a><span data-ttu-id="0cf6d-174">入力処理メソッド</span><span class="sxs-lookup"><span data-stu-id="0cf6d-174">Input Processing Methods</span></span>

<span data-ttu-id="0cf6d-175">System.string[クラスは](/dotnet/api/System.Management.Automation.Cmdlet)、レコードを処理するために使用される次の仮想メソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-175">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="0cf6d-176">派生したすべてのコマンドレットクラスは、最初の3つのメソッドをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-176">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="0cf6d-177">[次の](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)ように実行します。コマンドレットに対して、オプションの1回限りの事前処理機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="0cf6d-178">..............[コマンドレット](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord):コマンドレットのレコードごとの処理機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="0cf6d-179">コマンドレットの入力によっては、すべての回数 (またはまったくではない) の呼び出しが必要になる場合があり[ます。](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)</span><span class="sxs-lookup"><span data-stu-id="0cf6d-179">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>

- <span data-ttu-id="0cf6d-180">[次の](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)ようにします。コマンドレットに対して、オプションの1回限りの後処理機能を提供するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="0cf6d-181">............. [StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing):ユーザーがコマンドレットを非同期に停止したとき (たとえば、CTRL + C キーを押して)、処理を停止するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example,  by pressing CTRL+C).</span></span>

<span data-ttu-id="0cf6d-182">これらのメソッドの詳細については、「[コマンドレットの入力処理方法](./cmdlet-input-processing-methods.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-182">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="0cf6d-183">コマンドレットの属性</span><span class="sxs-lookup"><span data-stu-id="0cf6d-183">Cmdlet Attributes</span></span>

<span data-ttu-id="0cf6d-184">Windows PowerShell では、コマンドレットを管理したり、Windows PowerShell によって提供される一般的な機能を指定したり、コマンドレットで必要になる可能性のある、いくつかの .NET Framework 属性を定義しています。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-184">Windows PowerShell defines several .NET Framework attributes that are used to manage cmdlets and to specify common functionality that is provided by Windows PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="0cf6d-185">たとえば、属性を使用して、クラスをコマンドレットとして指定したり、コマンドレットのパラメーターを指定したり、コマンドレットの開発者がコマンドレットコードにその機能を実装する必要がないように入力の検証を要求したりします。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-185">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="0cf6d-186">属性の詳細については、「 [Windows PowerShell の属性](./cmdlet-attributes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-186">For more information about attributes, see [Windows PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="0cf6d-187">コマンドレット名</span><span class="sxs-lookup"><span data-stu-id="0cf6d-187">Cmdlet Names</span></span>

<span data-ttu-id="0cf6d-188">Windows PowerShell では、動詞と名詞の名前の組み合わせを使用して、コマンドレットに名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-188">Windows PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="0cf6d-189">たとえば、Windows PowerShell に含まれている `Get-Command` コマンドレットは、コマンドシェルに登録されているすべてのコマンドレットを取得するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-189">For example, the `Get-Command` cmdlet included in Windows PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="0cf6d-190">動詞はコマンドレットが実行するアクションを識別し、名詞は、コマンドレットがアクションを実行するリソースを識別します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-190">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="0cf6d-191">これらの名前は、.NET Framework クラスがコマンドレットとして宣言されている場合に指定します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-191">These names are specified when the .NET Framework class is declared as a cmdlet.</span></span> <span data-ttu-id="0cf6d-192">.NET Framework クラスをコマンドレットとして宣言する方法の詳細については、「[コマンドレットの属性宣言](./cmdlet-class-declaration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-192">For more information about how to declare a .NET Framework class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="0cf6d-193">コマンドレットコードの記述</span><span class="sxs-lookup"><span data-stu-id="0cf6d-193">Writing Cmdlet Code</span></span>

<span data-ttu-id="0cf6d-194">このドキュメントでは、コマンドレットコードの記述方法を確認する2つの方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-194">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="0cf6d-195">コードをよく説明する必要がない場合は、[コマンドレットコードの例](./examples-of-cmdlet-code.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-195">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="0cf6d-196">コードの詳細については、「 [Getproc チュートリアル](./getproc-tutorial.md)」、「 [stopproc チュートリアル](./stopproc-tutorial.md)」、または「 [selectstr チュートリアル](./selectstr-tutorial.md)」のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-196">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md),  [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="0cf6d-197">コマンドレットの記述に関するガイドラインの詳細については、「[コマンドレットの開発ガイドライン](./cmdlet-development-guidelines.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0cf6d-197">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="0cf6d-198">参照</span><span class="sxs-lookup"><span data-stu-id="0cf6d-198">See Also</span></span>

[<span data-ttu-id="0cf6d-199">Windows PowerShell コマンドレットの概念</span><span class="sxs-lookup"><span data-stu-id="0cf6d-199">Windows PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="0cf6d-200">Windows PowerShell コマンドレットの記述</span><span class="sxs-lookup"><span data-stu-id="0cf6d-200">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="0cf6d-201">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="0cf6d-201">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
